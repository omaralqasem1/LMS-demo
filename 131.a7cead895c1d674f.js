"use strict";(self.webpackChunkLMS_demo=self.webpackChunkLMS_demo||[]).push([[131],{6217:(Bt,Ne,C)=>{C.d(Ne,{nm:()=>Bn});var f=C(4976);C(4650),C(259);var we=C(5861),J=C(6881),oe=C(4859),Oe=C(2090),Se=C(1877);const Xe=new Map,B={activated:!1,tokenObservers:[]},Qe={initialized:!1,enabled:!1};function be(k){return Xe.get(k)||Object.assign({},B)}function dt(){return Qe}class Fe{constructor(S,M,K,Y,Ae){if(this.operation=S,this.retryPolicy=M,this.getWaitDuration=K,this.lowerBound=Y,this.upperBound=Ae,this.pending=null,this.nextErrorWaitInterval=Y,Y>Ae)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(S){var M=this;return(0,we.Z)(function*(){M.stop();try{M.pending=new Oe.BH,yield function Je(k){return new Promise(S=>{setTimeout(S,k)})}(M.getNextRun(S)),M.pending.resolve(),yield M.pending.promise,M.pending=new Oe.BH,yield M.operation(),M.pending.resolve(),yield M.pending.promise,M.process(!0).catch(()=>{})}catch(K){M.retryPolicy(K)?M.process(!1).catch(()=>{}):M.stop()}})()}getNextRun(S){if(S)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const M=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),M}}}const Ie=new Oe.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Ke(k){if(!be(k).activated)throw Ie.create("use-before-activation",{appName:k.name})}function It(k,S){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,we.Z)(function*({url:k,body:S},M){const K={"Content-Type":"application/json"},Y=M.getImmediate({optional:!0});if(Y){const xt=yield Y.getHeartbeatsHeader();xt&&(K["X-Firebase-Client"]=xt)}const Ae={method:"POST",body:JSON.stringify(S),headers:K};let He,je;try{He=yield fetch(k,Ae)}catch(xt){throw Ie.create("fetch-network-error",{originalErrorMessage:xt?.message})}if(200!==He.status)throw Ie.create("fetch-status-error",{httpStatus:He.status});try{je=yield He.json()}catch(xt){throw Ie.create("fetch-parse-error",{originalErrorMessage:xt?.message})}const nt=je.ttl.match(/^([\d.]+)(s)$/);if(!nt||!nt[2]||isNaN(Number(nt[1])))throw Ie.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${je.ttl}`});const gr=1e3*Number(nt[1]),rr=Date.now();return{token:je.token,expireTimeMillis:rr+gr,issuedAtTimeMillis:rr}})).apply(this,arguments)}function Gt(k,S){const{projectId:M,appId:K,apiKey:Y}=k.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${M}/apps/${K}:exchangeDebugToken?key=${Y}`,body:{debug_token:S}}}const ht="firebase-app-check-store";let Et=null;function pt(){return Et||(Et=new Promise((k,S)=>{try{const M=indexedDB.open("firebase-app-check-database",1);M.onsuccess=K=>{k(K.target.result)},M.onerror=K=>{var Y;S(Ie.create("storage-open",{originalErrorMessage:null===(Y=K.target.error)||void 0===Y?void 0:Y.message}))},M.onupgradeneeded=K=>{0===K.oldVersion&&K.target.result.createObjectStore(ht,{keyPath:"compositeKey"})}}catch(M){S(Ie.create("storage-open",{originalErrorMessage:M?.message}))}}),Et)}function En(){return(En=(0,we.Z)(function*(k,S){const K=(yield pt()).transaction(ht,"readwrite"),Ae=K.objectStore(ht).put({compositeKey:k,value:S});return new Promise((He,je)=>{Ae.onsuccess=nt=>{He()},K.onerror=nt=>{var gr;je(Ie.create("storage-set",{originalErrorMessage:null===(gr=nt.target.error)||void 0===gr?void 0:gr.message}))}})})).apply(this,arguments)}const tn=new Se.Yd("@firebase/app-check");function rn(k,S){return(0,Oe.hl)()?function Fn(k,S){return function Ot(k,S){return En.apply(this,arguments)}(function bn(k){return`${k.options.appId}-${k.name}`}(k),S)}(k,S).catch(M=>{tn.warn(`Failed to write token to IndexedDB. Error: ${M}`)}):Promise.resolve()}function mn(){return dt().enabled}function G(){return x.apply(this,arguments)}function x(){return(x=(0,we.Z)(function*(){const k=dt();if(k.enabled&&k.token)return k.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const T={error:"UNKNOWN_ERROR"};function p(k){return Oe.US.encodeString(JSON.stringify(k),!1)}function g(k){return y.apply(this,arguments)}function y(){return(y=(0,we.Z)(function*(k,S=!1){const M=k.app;Ke(M);const K=be(M);let Ae,Y=K.token;if(Y&&!Zt(Y)&&(K.token=void 0,Y=void 0),!Y){const nt=yield K.cachedTokenPromise;nt&&(Zt(nt)?Y=nt:yield rn(M,void 0))}if(!S&&Y&&Zt(Y))return{token:Y.token};let je,He=!1;if(mn()){K.exchangeTokenPromise||(K.exchangeTokenPromise=It(Gt(M,yield G()),k.heartbeatServiceProvider).finally(()=>{K.exchangeTokenPromise=void 0}),He=!0);const nt=yield K.exchangeTokenPromise;return yield rn(M,nt),K.token=nt,{token:nt.token}}try{K.exchangeTokenPromise||(K.exchangeTokenPromise=K.provider.getToken().finally(()=>{K.exchangeTokenPromise=void 0}),He=!0),Y=yield be(M).exchangeTokenPromise}catch(nt){"appCheck/throttled"===nt.code?tn.warn(nt.message):tn.error(nt),Ae=nt}return Y?Ae?je=Zt(Y)?{token:Y.token,internalError:Ae}:Qt(Ae):(je={token:Y.token},K.token=Y,yield rn(M,Y)):je=Qt(Ae),He&&Rt(M,je),je})).apply(this,arguments)}function ce(k,S){const M=be(k),K=M.tokenObservers.filter(Y=>Y.next!==S);0===K.length&&M.tokenRefresher&&M.tokenRefresher.isRunning()&&M.tokenRefresher.stop(),M.tokenObservers=K}function Ue(k){const{app:S}=k,M=be(S);let K=M.tokenRefresher;K||(K=function cn(k){const{app:S}=k;return new Fe((0,we.Z)(function*(){let K;if(K=be(S).token?yield g(k,!0):yield g(k),K.error)throw K.error;if(K.internalError)throw K.internalError}),()=>!0,()=>{const M=be(S);if(M.token){let K=M.token.issuedAtTimeMillis+.5*(M.token.expireTimeMillis-M.token.issuedAtTimeMillis)+3e5;return K=Math.min(K,M.token.expireTimeMillis-3e5),Math.max(0,K-Date.now())}return 0},3e4,96e4)}(k),M.tokenRefresher=K),!K.isRunning()&&M.isTokenAutoRefreshEnabled&&K.start()}function Rt(k,S){const M=be(k).tokenObservers;for(const K of M)try{"EXTERNAL"===K.type&&null!=S.error?K.error(S.error):K.next(S)}catch{}}function Zt(k){return k.expireTimeMillis-Date.now()>0}function Qt(k){return{token:p(T),error:k}}class nr{constructor(S,M){this.app=S,this.heartbeatServiceProvider=M}_delete(){const{tokenObservers:S}=be(this.app);for(const M of S)ce(this.app,M.next);return Promise.resolve()}}const ct="app-check-internal";!function kr(){(0,J._registerComponent)(new oe.wA("app-check",k=>function gn(k,S){return new nr(k,S)}(k.getProvider("app").getImmediate(),k.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((k,S,M)=>{k.getProvider(ct).initialize()})),(0,J._registerComponent)(new oe.wA(ct,k=>function Hn(k){return{getToken:S=>g(k,S),addTokenListener:S=>function W(k,S,M,K){const{app:Y}=k,Ae=be(Y);if(Ae.tokenObservers=[...Ae.tokenObservers,{next:M,error:K,type:S}],Ae.token&&Zt(Ae.token)){const je=Ae.token;Promise.resolve().then(()=>{M({token:je.token}),Ue(k)}).catch(()=>{})}Ae.cachedTokenPromise.then(()=>Ue(k))}(k,"INTERNAL",S),removeTokenListener:S=>ce(k.app,S)}}(k.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,J.registerVersion)("@firebase/app-check","0.7.0")}();class Bn{constructor(){return(0,f.vb)("app-check")}}typeof window<"u"&&window},1205:(Bt,Ne,C)=>{C.d(Ne,{zQ:()=>gt,rT:()=>Qe,f7:()=>at,L6:()=>Xe,_Q:()=>B,lh:()=>be,Qv:()=>Se,nw:()=>dt});var f=C(4650),j=C(7579),P=C(9646),me=C(9751),re=C(8996),_e=C(6451),ye=C(5363),U=C(3900),ie=C(4004),V=C(6063);class ae extends j.x{constructor(Re=1/0,Pe=1/0,xe=V.l){super(),this._bufferSize=Re,this._windowTime=Pe,this._timestampProvider=xe,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Pe===1/0,this._bufferSize=Math.max(1,Re),this._windowTime=Math.max(1,Pe)}next(Re){const{isStopped:Pe,_buffer:xe,_infiniteTimeWindow:Fe,_timestampProvider:Je,_windowTime:Te}=this;Pe||(xe.push(Re),!Fe&&xe.push(Je.now()+Te)),this._trimBuffer(),super.next(Re)}_subscribe(Re){this._throwIfClosed(),this._trimBuffer();const Pe=this._innerSubscribe(Re),{_infiniteTimeWindow:xe,_buffer:Fe}=this,Je=Fe.slice();for(let Te=0;Te<Je.length&&!Re.closed;Te+=xe?1:2)Re.next(Je[Te]);return this._checkFinalizedStatuses(Re),Pe}_trimBuffer(){const{_bufferSize:Re,_timestampProvider:Pe,_buffer:xe,_infiniteTimeWindow:Fe}=this,Je=(Fe?1:2)*Re;if(Re<1/0&&Je<xe.length&&xe.splice(0,xe.length-Je),!Fe){const Te=Pe.now();let Ie=0;for(let Ge=1;Ge<xe.length&&xe[Ge]<=Te;Ge+=2)Ie=Ge;Ie&&xe.splice(0,Ie+1)}}}var Z=C(3099);function H(ze,Re,Pe){let xe,Fe=!1;return ze&&"object"==typeof ze?({bufferSize:xe=1/0,windowTime:Re=1/0,refCount:Fe=!1,scheduler:Pe}=ze):xe=ze??1/0,(0,Z.B)({connector:()=>new ae(xe,Re,Pe),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Fe})}var le=C(590),te=C(576);function ue(ze,Re){return(0,te.m)(Re)?(0,U.w)(()=>ze,Re):(0,U.w)(()=>ze)}var De=C(9468),it=C(9300),F=C(4976),Ze=C(2011),we=C(6895),J=C(6217);C(9260);const Se=new f.OlP("angularfire2.auth.use-emulator"),Xe=new f.OlP("angularfire2.auth.settings"),B=new f.OlP("angularfire2.auth.tenant-id"),Qe=new f.OlP("angularfire2.auth.langugage-code"),be=new f.OlP("angularfire2.auth.use-device-language"),at=new f.OlP("angularfire.auth.persistence"),dt=(ze,Re,Pe,xe,Fe,Je,Te,Ie)=>(0,Ze.cc)(`${ze.name}.auth`,"AngularFireAuth",ze.name,()=>{const Ge=Re.runOutsideAngular(()=>ze.auth());if(Pe&&Ge.useEmulator(...Pe),xe&&(Ge.tenantId=xe),Ge.languageCode=Fe,Je&&Ge.useDeviceLanguage(),Te)for(const[Ke,Mt]of Object.entries(Te))Ge.settings[Ke]=Mt;return Ie&&Ge.setPersistence(Ie),Ge},[Pe,xe,Fe,Je,Te,Ie]);let gt=(()=>{class ze{constructor(Pe,xe,Fe,Je,Te,Ie,Ge,Ke,Mt,et,It,Nt){const un=new j.x,st=(0,P.of)(void 0).pipe((0,ye.Q)(Te.outsideAngular),(0,U.w)(()=>Je.runOutsideAngular(()=>Promise.resolve().then(C.bind(C,2644)))),(0,ie.U)(()=>(0,Ze.on)(Pe,Je,xe)),(0,ie.U)(Gt=>dt(Gt,Je,Ie,Ke,Mt,et,Ge,It)),H({bufferSize:1,refCount:!1}));if((0,we.PM)(Fe))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,P.of)(null);else{st.pipe((0,le.P)()).subscribe();const en=st.pipe((0,U.w)(qe=>qe.getRedirectResult().then(Et=>Et,()=>null)),F.iC,H({bufferSize:1,refCount:!1})),$t=st.pipe((0,U.w)(qe=>new me.y(Et=>({unsubscribe:Je.runOutsideAngular(()=>qe.onAuthStateChanged(pt=>Et.next(pt),pt=>Et.error(pt),()=>Et.complete()))})))),ht=st.pipe((0,U.w)(qe=>new me.y(Et=>({unsubscribe:Je.runOutsideAngular(()=>qe.onIdTokenChanged(pt=>Et.next(pt),pt=>Et.error(pt),()=>Et.complete()))}))));this.authState=en.pipe(ue($t),(0,De.R)(Te.outsideAngular),(0,ye.Q)(Te.insideAngular)),this.user=en.pipe(ue(ht),(0,De.R)(Te.outsideAngular),(0,ye.Q)(Te.insideAngular)),this.idToken=this.user.pipe((0,U.w)(qe=>qe?(0,re.D)(qe.getIdToken()):(0,P.of)(null))),this.idTokenResult=this.user.pipe((0,U.w)(qe=>qe?(0,re.D)(qe.getIdTokenResult()):(0,P.of)(null))),this.credential=(0,_e.T)(en,un,this.authState.pipe((0,it.h)(qe=>!qe))).pipe((0,ie.U)(qe=>qe?.user?qe:null),(0,De.R)(Te.outsideAngular),(0,ye.Q)(Te.insideAngular))}return(0,Ze.pX)(this,st,Je,{spy:{apply:(Gt,en,$t)=>{(Gt.startsWith("signIn")||Gt.startsWith("createUser"))&&$t.then(ht=>un.next(ht))}}})}}return ze.\u0275fac=function(Pe){return new(Pe||ze)(f.LFG(Ze.Dh),f.LFG(Ze.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(F.HU),f.LFG(Se,8),f.LFG(Xe,8),f.LFG(B,8),f.LFG(Qe,8),f.LFG(be,8),f.LFG(at,8),f.LFG(J.nm,8))},ze.\u0275prov=f.Yz7({token:ze,factory:ze.\u0275fac,providedIn:"any"}),ze})()},7977:(Bt,Ne,C)=>{C.d(Ne,{ST:()=>x});var f=C(4650),j=C(4986),P=C(9751),me=C(8996),re=C(9646),_e=C(4976),ye=C(8675),U=C(4482),ie=C(5403);function V(){return(0,U.e)((T,p)=>{let g,y=!1;T.subscribe((0,ie.x)(p,E=>{const D=g;g=E,y&&p.next([D,E]),y=!0}))})}var ae=C(4004),Z=C(5026),H=C(1884),le=C(9300),te=C(2011),ue=C(6895),it=(C(2644),C(3942)),F=C(2810),Ze=C(2090),we=C(4859);function Oe(T,p){if(void 0===p)return{merge:!1};if(void 0!==p.mergeFields&&void 0!==p.merge)throw new F.WA("invalid-argument",`Invalid options passed to function ${T}(): You cannot specify both "merge" and "mergeFields".`);return p}function Se(){if(typeof Uint8Array>"u")throw new F.WA("unimplemented","Uint8Arrays are not available in this environment.")}function Xe(){if(!(0,F.Me)())throw new F.WA("unimplemented","Blobs are unavailable in Firestore in this environment.")}class B{constructor(p){this._delegate=p}static fromBase64String(p){return Xe(),new B(F.Jj.fromBase64String(p))}static fromUint8Array(p){return Se(),new B(F.Jj.fromUint8Array(p))}toBase64(){return Xe(),this._delegate.toBase64()}toUint8Array(){return Se(),this._delegate.toUint8Array()}isEqual(p){return this._delegate.isEqual(p._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Qe(T){return function be(T,p){if("object"!=typeof T||null===T)return!1;const g=T;for(const y of p)if(y in g&&"function"==typeof g[y])return!0;return!1}(T,["next","error","complete"])}class at{enableIndexedDbPersistence(p,g){return(0,F.ST)(p._delegate,{forceOwnership:g})}enableMultiTabIndexedDbPersistence(p){return(0,F.fH)(p._delegate)}clearIndexedDbPersistence(p){return(0,F.Fc)(p._delegate)}}class dt{constructor(p,g,y){this._delegate=g,this._persistenceProvider=y,this.INTERNAL={delete:()=>this.terminate()},p instanceof F.l7||(this._appCompat=p)}get _databaseId(){return this._delegate._databaseId}settings(p){const g=this._delegate._getSettings();!p.merge&&g.host!==p.host&&(0,F.yq)("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),p.merge&&delete(p=Object.assign(Object.assign({},g),p)).merge,this._delegate._setSettings(p)}useEmulator(p,g,y={}){(0,F.at)(this._delegate,p,g,y)}enableNetwork(){return(0,F.Ix)(this._delegate)}disableNetwork(){return(0,F.TF)(this._delegate)}enablePersistence(p){let g=!1,y=!1;return p&&(g=!!p.synchronizeTabs,y=!!p.experimentalForceOwningTab,(0,F.Wi)("synchronizeTabs",g,"experimentalForceOwningTab",y)),g?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,y)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return(0,F.Mx)(this._delegate)}onSnapshotsInSync(p){return(0,F.sc)(this._delegate,p)}get app(){if(!this._appCompat)throw new F.WA("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(p){try{return new It(this,(0,F.hJ)(this._delegate,p))}catch(g){throw Fe(g,"collection()","Firestore.collection()")}}doc(p){try{return new xe(this,(0,F.JU)(this._delegate,p))}catch(g){throw Fe(g,"doc()","Firestore.doc()")}}collectionGroup(p){try{return new Ke(this,(0,F.B$)(this._delegate,p))}catch(g){throw Fe(g,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(p){return(0,F.i3)(this._delegate,g=>p(new ze(this,g)))}batch(){return(0,F.qY)(this._delegate),new Re(new F.PU(this._delegate,p=>(0,F.GL)(this._delegate,p)))}loadBundle(p){return(0,F.Pb)(this._delegate,p)}namedQuery(p){return(0,F.L$)(this._delegate,p).then(g=>g?new Ke(this,g):null)}}class gt extends F.u7{constructor(p){super(),this.firestore=p}convertBytes(p){return new B(new F.Jj(p))}convertReference(p){const g=this.convertDocumentKey(p,this.firestore._databaseId);return xe.forKey(g,this.firestore,null)}}class ze{constructor(p,g){this._firestore=p,this._delegate=g,this._userDataWriter=new gt(p)}get(p){const g=Nt(p);return this._delegate.get(g).then(y=>new Ie(this._firestore,new F.xU(this._firestore._delegate,this._userDataWriter,y._key,y._document,y.metadata,g.converter)))}set(p,g,y){const E=Nt(p);return y?(Oe("Transaction.set",y),this._delegate.set(E,g,y)):this._delegate.set(E,g),this}update(p,g,y,...E){const D=Nt(p);return 2===arguments.length?this._delegate.update(D,g):this._delegate.update(D,g,y,...E),this}delete(p){const g=Nt(p);return this._delegate.delete(g),this}}class Re{constructor(p){this._delegate=p}set(p,g,y){const E=Nt(p);return y?(Oe("WriteBatch.set",y),this._delegate.set(E,g,y)):this._delegate.set(E,g),this}update(p,g,y,...E){const D=Nt(p);return 2===arguments.length?this._delegate.update(D,g):this._delegate.update(D,g,y,...E),this}delete(p){const g=Nt(p);return this._delegate.delete(g),this}commit(){return this._delegate.commit()}}class Pe{constructor(p,g,y){this._firestore=p,this._userDataWriter=g,this._delegate=y}fromFirestore(p,g){const y=new F.$q(this._firestore._delegate,this._userDataWriter,p._key,p._document,p.metadata,null);return this._delegate.fromFirestore(new Ge(this._firestore,y),g??{})}toFirestore(p,g){return g?this._delegate.toFirestore(p,g):this._delegate.toFirestore(p)}static getInstance(p,g){const y=Pe.INSTANCES;let E=y.get(p);E||(E=new WeakMap,y.set(p,E));let D=E.get(g);return D||(D=new Pe(p,new gt(p),g),E.set(g,D)),D}}Pe.INSTANCES=new WeakMap;class xe{constructor(p,g){this.firestore=p,this._delegate=g,this._userDataWriter=new gt(p)}static forPath(p,g,y){if(p.length%2!=0)throw new F.WA("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${p.canonicalString()} has ${p.length}`);return new xe(g,new F.my(g._delegate,y,new F.Ky(p)))}static forKey(p,g,y){return new xe(g,new F.my(g._delegate,y,p))}get id(){return this._delegate.id}get parent(){return new It(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(p){try{return new It(this.firestore,(0,F.hJ)(this._delegate,p))}catch(g){throw Fe(g,"collection()","DocumentReference.collection()")}}isEqual(p){return(p=(0,Ze.m9)(p))instanceof F.my&&(0,F.Eo)(this._delegate,p)}set(p,g){g=Oe("DocumentReference.set",g);try{return g?(0,F.pl)(this._delegate,p,g):(0,F.pl)(this._delegate,p)}catch(y){throw Fe(y,"setDoc()","DocumentReference.set()")}}update(p,g,...y){try{return 1===arguments.length?(0,F.r7)(this._delegate,p):(0,F.r7)(this._delegate,p,g,...y)}catch(E){throw Fe(E,"updateDoc()","DocumentReference.update()")}}delete(){return(0,F.oe)(this._delegate)}onSnapshot(...p){const g=Je(p),y=Te(p,E=>new Ie(this.firestore,new F.xU(this.firestore._delegate,this._userDataWriter,E._key,E._document,E.metadata,this._delegate.converter)));return(0,F.cf)(this._delegate,g,y)}get(p){let g;return g="cache"===p?.source?(0,F.kl)(this._delegate):"server"===p?.source?(0,F.Xk)(this._delegate):(0,F.QT)(this._delegate),g.then(y=>new Ie(this.firestore,new F.xU(this.firestore._delegate,this._userDataWriter,y._key,y._document,y.metadata,this._delegate.converter)))}withConverter(p){return new xe(this.firestore,this._delegate.withConverter(p?Pe.getInstance(this.firestore,p):null))}}function Fe(T,p,g){return T.message=T.message.replace(p,g),T}function Je(T){for(const p of T)if("object"==typeof p&&!Qe(p))return p;return{}}function Te(T,p){var g,y;let E;return E=Qe(T[0])?T[0]:Qe(T[1])?T[1]:"function"==typeof T[0]?{next:T[0],error:T[1],complete:T[2]}:{next:T[1],error:T[2],complete:T[3]},{next:D=>{E.next&&E.next(p(D))},error:null===(g=E.error)||void 0===g?void 0:g.bind(E),complete:null===(y=E.complete)||void 0===y?void 0:y.bind(E)}}class Ie{constructor(p,g){this._firestore=p,this._delegate=g}get ref(){return new xe(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(p){return this._delegate.data(p)}get(p,g){return this._delegate.get(p,g)}isEqual(p){return(0,F.qK)(this._delegate,p._delegate)}}class Ge extends Ie{data(p){const g=this._delegate.data(p);return(0,F.K9)(void 0!==g,"Document in a QueryDocumentSnapshot should exist"),g}}class Ke{constructor(p,g){this.firestore=p,this._delegate=g,this._userDataWriter=new gt(p)}where(p,g,y){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.ar)(p,g,y)))}catch(E){throw Fe(E,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(p,g){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.Xo)(p,g)))}catch(y){throw Fe(y,/(orderBy|where)\(\)/,"Query.$1()")}}limit(p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.b9)(p)))}catch(g){throw Fe(g,"limit()","Query.limit()")}}limitToLast(p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.vh)(p)))}catch(g){throw Fe(g,"limitToLast()","Query.limitToLast()")}}startAt(...p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.e0)(...p)))}catch(g){throw Fe(g,"startAt()","Query.startAt()")}}startAfter(...p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.TQ)(...p)))}catch(g){throw Fe(g,"startAfter()","Query.startAfter()")}}endBefore(...p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.Lx)(...p)))}catch(g){throw Fe(g,"endBefore()","Query.endBefore()")}}endAt(...p){try{return new Ke(this.firestore,(0,F.IO)(this._delegate,(0,F.Wu)(...p)))}catch(g){throw Fe(g,"endAt()","Query.endAt()")}}isEqual(p){return(0,F.iE)(this._delegate,p._delegate)}get(p){let g;return g="cache"===p?.source?(0,F.UQ)(this._delegate):"server"===p?.source?(0,F.zN)(this._delegate):(0,F.PL)(this._delegate),g.then(y=>new et(this.firestore,new F.W(this.firestore._delegate,this._userDataWriter,this._delegate,y._snapshot)))}onSnapshot(...p){const g=Je(p),y=Te(p,E=>new et(this.firestore,new F.W(this.firestore._delegate,this._userDataWriter,this._delegate,E._snapshot)));return(0,F.cf)(this._delegate,g,y)}withConverter(p){return new Ke(this.firestore,this._delegate.withConverter(p?Pe.getInstance(this.firestore,p):null))}}class Mt{constructor(p,g){this._firestore=p,this._delegate=g}get type(){return this._delegate.type}get doc(){return new Ge(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class et{constructor(p,g){this._firestore=p,this._delegate=g}get query(){return new Ke(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(p=>new Ge(this._firestore,p))}docChanges(p){return this._delegate.docChanges(p).map(g=>new Mt(this._firestore,g))}forEach(p,g){this._delegate.forEach(y=>{p.call(g,new Ge(this._firestore,y))})}isEqual(p){return(0,F.qK)(this._delegate,p._delegate)}}class It extends Ke{constructor(p,g){super(p,g),this.firestore=p,this._delegate=g}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const p=this._delegate.parent;return p?new xe(this.firestore,p):null}doc(p){try{return new xe(this.firestore,void 0===p?(0,F.JU)(this._delegate):(0,F.JU)(this._delegate,p))}catch(g){throw Fe(g,"doc()","CollectionReference.doc()")}}add(p){return(0,F.ET)(this._delegate,p).then(g=>new xe(this.firestore,g))}isEqual(p){return(0,F.Eo)(this._delegate,p._delegate)}withConverter(p){return new It(this.firestore,this._delegate.withConverter(p?Pe.getInstance(this.firestore,p):null))}}function Nt(T){return(0,F.Cf)(T,F.my)}class un{constructor(...p){this._delegate=new F.Lz(...p)}static documentId(){return new un(F.Xb.keyField().canonicalString())}isEqual(p){return(p=(0,Ze.m9)(p))instanceof F.Lz&&this._delegate._internalPath.isEqual(p._internalPath)}}class st{constructor(p){this._delegate=p}static serverTimestamp(){const p=(0,F.Bt)();return p._methodName="FieldValue.serverTimestamp",new st(p)}static delete(){const p=(0,F.AK)();return p._methodName="FieldValue.delete",new st(p)}static arrayUnion(...p){const g=(0,F.vr)(...p);return g._methodName="FieldValue.arrayUnion",new st(g)}static arrayRemove(...p){const g=(0,F.Ab)(...p);return g._methodName="FieldValue.arrayRemove",new st(g)}static increment(p){const g=(0,F.nP)(p);return g._methodName="FieldValue.increment",new st(g)}isEqual(p){return this._delegate.isEqual(p._delegate)}}const Gt={Firestore:dt,GeoPoint:F.F8,Timestamp:F.EK,Blob:B,Transaction:ze,WriteBatch:Re,DocumentReference:xe,DocumentSnapshot:Ie,Query:Ke,QueryDocumentSnapshot:Ge,QuerySnapshot:et,CollectionReference:It,FieldPath:un,FieldValue:st,setLogLevel:function zt(T){(0,F.Ub)(T)},CACHE_SIZE_UNLIMITED:F.IX};!function $t(T){(function en(T,p){T.INTERNAL.registerComponent(new we.wA("firestore-compat",g=>{const y=g.getProvider("app-compat").getImmediate(),E=g.getProvider("firestore").getImmediate();return p(y,E)},"PUBLIC").setServiceProps(Object.assign({},Gt)))})(T,(p,g)=>new dt(p,g,new at)),T.registerVersion("@firebase/firestore-compat","0.3.9")}(it.Z);var ht=C(1205),qe=C(6217);function fn(T,p){return function pt(T,p=j.z){return new P.y(g=>{let y;return null!=p?p.schedule(()=>{y=T.onSnapshot({includeMetadataChanges:!0},g)}):y=T.onSnapshot({includeMetadataChanges:!0},g),()=>{y?.()}})}(T,p)}function pn(T,p){return fn(T,p).pipe((0,ae.U)(g=>({payload:g,type:"query"})))}function qt(T,p){return pn(T,p).pipe((0,ye.O)(void 0),V(),(0,ae.U)(([g,y])=>{const E=y.payload.docChanges(),D=E.map(W=>({type:W.type,payload:W}));return g&&JSON.stringify(g.payload.metadata)!==JSON.stringify(y.payload.metadata)&&y.payload.docs.forEach((W,ce)=>{const Ue=E.find(Rt=>Rt.doc.ref.isEqual(W.ref)),cn=g?.payload.docs.find(Rt=>Rt.ref.isEqual(W.ref));Ue&&JSON.stringify(Ue.doc.metadata)===JSON.stringify(W.metadata)||!Ue&&cn&&JSON.stringify(cn.metadata)===JSON.stringify(W.metadata)||D.push({type:"modified",payload:{oldIndex:ce,newIndex:ce,type:"modified",doc:W}})}),D}))}function Ot(T,p,g){return qt(T,g).pipe((0,Z.R)((y,E)=>function En(T,p,g){return p.forEach(y=>{g.indexOf(y.type)>-1&&(T=function Ht(T,p){switch(p.type){case"added":if(!T[p.newIndex]||!T[p.newIndex].doc.ref.isEqual(p.doc.ref))return St(T,p.newIndex,0,p);break;case"modified":if(null==T[p.oldIndex]||T[p.oldIndex].doc.ref.isEqual(p.doc.ref)){if(p.oldIndex!==p.newIndex){const g=T.slice();return g.splice(p.oldIndex,1),g.splice(p.newIndex,0,p),g}return St(T,p.newIndex,1,p)}break;case"removed":if(T[p.oldIndex]&&T[p.oldIndex].doc.ref.isEqual(p.doc.ref))return St(T,p.oldIndex,1)}return T}(T,y))}),T}(y,E.map(D=>D.payload),p),[]),(0,H.x)(),(0,ae.U)(y=>y.map(E=>({type:E.type,payload:E}))))}function St(T,p,g,...y){const E=T.slice();return E.splice(p,g,...y),E}function bn(T){return(!T||0===T.length)&&(T=["added","removed","modified"]),T}C(9260);class tn{constructor(p,g,y){this.ref=p,this.query=g,this.afs=y}stateChanges(p){let g=qt(this.query,this.afs.schedulers.outsideAngular);return p&&p.length>0&&(g=g.pipe((0,ae.U)(y=>y.filter(E=>p.indexOf(E.type)>-1)))),g.pipe((0,ye.O)(void 0),V(),(0,le.h)(([y,E])=>E.length>0||!y),(0,ae.U)(([y,E])=>E),_e.iC)}auditTrail(p){return this.stateChanges(p).pipe((0,Z.R)((g,y)=>[...g,...y],[]))}snapshotChanges(p){const g=bn(p);return Ot(this.query,g,this.afs.schedulers.outsideAngular).pipe(_e.iC)}valueChanges(p={}){return pn(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(g=>g.payload.docs.map(y=>p.idField?Object.assign(Object.assign({},y.data()),{[p.idField]:y.id}):y.data())),_e.iC)}get(p){return(0,me.D)(this.query.get(p)).pipe(_e.iC)}add(p){return this.ref.add(p)}doc(p){return new Un(this.ref.doc(p),this.afs)}}class Un{constructor(p,g){this.ref=p,this.afs=g}set(p,g){return this.ref.set(p,g)}update(p){return this.ref.update(p)}delete(){return this.ref.delete()}collection(p,g){const y=this.ref.collection(p),{ref:E,query:D}=G(y,g);return new tn(E,D,this.afs)}snapshotChanges(){return function Fn(T,p){return fn(T,p).pipe((0,ye.O)(void 0),V(),(0,ae.U)(([g,y])=>y.exists?g?.exists?{payload:y,type:"modified"}:{payload:y,type:"added"}:{payload:y,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(_e.iC)}valueChanges(p={}){return this.snapshotChanges().pipe((0,ae.U)(({payload:g})=>p.idField?Object.assign(Object.assign({},g.data()),{[p.idField]:g.id}):g.data()))}get(p){return(0,me.D)(this.ref.get(p)).pipe(_e.iC)}}class nn{constructor(p,g){this.query=p,this.afs=g}stateChanges(p){return p&&0!==p.length?qt(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(g=>g.filter(y=>p.indexOf(y.type)>-1)),(0,le.h)(g=>g.length>0),_e.iC):qt(this.query,this.afs.schedulers.outsideAngular).pipe(_e.iC)}auditTrail(p){return this.stateChanges(p).pipe((0,Z.R)((g,y)=>[...g,...y],[]))}snapshotChanges(p){const g=bn(p);return Ot(this.query,g,this.afs.schedulers.outsideAngular).pipe(_e.iC)}valueChanges(p={}){return pn(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(y=>y.payload.docs.map(E=>p.idField?Object.assign({[p.idField]:E.id},E.data()):E.data())),_e.iC)}get(p){return(0,me.D)(this.query.get(p)).pipe(_e.iC)}}const rn=new f.OlP("angularfire2.enableFirestorePersistence"),qn=new f.OlP("angularfire2.firestore.persistenceSettings"),wn=new f.OlP("angularfire2.firestore.settings"),mn=new f.OlP("angularfire2.firestore.use-emulator");function G(T,p=(g=>g)){return{query:p(T),ref:T}}let x=(()=>{class T{constructor(g,y,E,D,W,ce,Ue,cn,Rt,Zt,Qt,nr,gn,Hn,jr,Tn,Wr){this.schedulers=Ue;const Zn=(0,te.on)(g,ce,y),fr=Rt;Zt&&(0,ht.nw)(Zn,ce,Qt,gn,Hn,jr,nr,Tn),[this.firestore,this.persistenceEnabled$]=(0,te.cc)(`${Zn.name}.firestore`,"AngularFirestore",Zn.name,()=>{const Qn=ce.runOutsideAngular(()=>Zn.firestore());if(D&&Qn.settings(D),fr&&Qn.useEmulator(...fr),E&&!(0,ue.PM)(W)){const Mn=()=>{try{return(0,me.D)(Qn.enablePersistence(cn||void 0).then(()=>!0,()=>!1))}catch(pr){return typeof console<"u"&&console.warn(pr),(0,re.of)(!1)}};return[Qn,ce.runOutsideAngular(Mn)]}return[Qn,(0,re.of)(!1)]},[D,fr,E])}collection(g,y){let E;E="string"==typeof g?this.firestore.collection(g):g;const{ref:D,query:W}=G(E,y),ce=this.schedulers.ngZone.run(()=>D);return new tn(ce,W,this)}collectionGroup(g,y){const E=y||(W=>W),D=this.firestore.collectionGroup(g);return new nn(E(D),this)}doc(g){let y;y="string"==typeof g?this.firestore.doc(g):g;const E=this.schedulers.ngZone.run(()=>y);return new Un(E,this)}createId(){return this.firestore.collection("_").doc().id}}return T.\u0275fac=function(g){return new(g||T)(f.LFG(te.Dh),f.LFG(te.xv,8),f.LFG(rn,8),f.LFG(wn,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(_e.HU),f.LFG(qn,8),f.LFG(mn,8),f.LFG(ht.zQ,8),f.LFG(ht.Qv,8),f.LFG(ht.L6,8),f.LFG(ht._Q,8),f.LFG(ht.rT,8),f.LFG(ht.lh,8),f.LFG(ht.f7,8),f.LFG(qe.nm,8))},T.\u0275prov=f.Yz7({token:T,factory:T.\u0275fac,providedIn:"any"}),T})()},2810:(Bt,Ne,C)=>{C.d(Ne,{u7:()=>hf,Jj:()=>fs,IX:()=>f_,my:()=>Vt,xU:()=>ho,Lz:()=>ps,WA:()=>$,F8:()=>Dl,$q:()=>rc,W:()=>fo,EK:()=>vt,PU:()=>mm,l7:()=>lr,Ky:()=>ne,Xb:()=>bt,Cf:()=>$e,K9:()=>Xl,Me:()=>fu,yq:()=>jn,Wi:()=>Wp,ET:()=>J_,Ab:()=>_y,vr:()=>gy,Fc:()=>g_,hJ:()=>u_,B$:()=>c_,at:()=>Qp,oe:()=>X_,AK:()=>py,TF:()=>v_,JU:()=>Yp,ST:()=>p_,fH:()=>m_,Ix:()=>y_,Wu:()=>V_,Lx:()=>U_,qY:()=>Wt,GL:()=>Ra,Yp:()=>ny,QT:()=>j_,kl:()=>W_,Xk:()=>$_,PL:()=>q_,UQ:()=>H_,zN:()=>Z_,nP:()=>yy,b9:()=>O_,vh:()=>P_,Pb:()=>I_,L$:()=>E_,cf:()=>ey,sc:()=>ty,Xo:()=>N_,IO:()=>R_,iE:()=>rf,Eo:()=>l_,i3:()=>fy,Bt:()=>my,pl:()=>Q_,Ub:()=>Yl,qK:()=>K_,TQ:()=>F_,e0:()=>L_,r7:()=>Y_,Mx:()=>__,ar:()=>M_});var U,f=C(5861),j=C(6881),P=C(4859),me=C(1877),re=C(2090),_e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ye={},ie=ie||{},V=_e||self;function ae(){}function Z(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function H(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var te="closure_uid_"+(1e9*Math.random()>>>0),ue=0;function De(n,e,t){return n.call.apply(n.bind,arguments)}function it(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function F(n,e,t){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?De:it).apply(null,arguments)}function Ze(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function we(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var u=Array(arguments.length-2),d=2;d<arguments.length;d++)u[d-2]=arguments[d];return e.prototype[i].apply(r,u)}}function J(){this.s=this.s,this.o=this.o}J.prototype.s=!1,J.prototype.ra=function(){!this.s&&(this.s=!0,this.N(),0)&&function le(n){Object.prototype.hasOwnProperty.call(n,te)&&n[te]||(n[te]=++ue)}(this)},J.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Oe=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Se(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Xe(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Z(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let u=0;u<s;u++)n[i+u]=r[u]}else n.push(r)}}function B(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var Qe=function(){if(!V.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{V.addEventListener("test",ae,e),V.removeEventListener("test",ae,e)}catch{}return n}();function be(n){return/^[\s\xa0]*$/.test(n)}var at=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function dt(n,e){return n<e?-1:n>e?1:0}function gt(){var n=V.navigator;return n&&(n=n.userAgent)?n:""}function zt(n){return-1!=gt().indexOf(n)}function ze(n){return ze[" "](n),n}function Re(n,e,t){return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}ze[" "]=ae;var Ke,n,Pe=zt("Opera"),xe=zt("Trident")||zt("MSIE"),Fe=zt("Edge"),Je=Fe||xe,Te=zt("Gecko")&&!(-1!=gt().toLowerCase().indexOf("webkit")&&!zt("Edge"))&&!(zt("Trident")||zt("MSIE"))&&!zt("Edge"),Ie=-1!=gt().toLowerCase().indexOf("webkit")&&!zt("Edge");function Ge(){var n=V.document;return n?n.documentMode:void 0}e:{var Mt="",et=(n=gt(),Te?/rv:([^\);]+)(\)|;)/.exec(n):Fe?/Edge\/([\d\.]+)/.exec(n):xe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Ie?/WebKit\/(\S+)/.exec(n):Pe?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(et&&(Mt=et?et[1]:""),xe){var It=Ge();if(null!=It&&It>parseFloat(Mt)){Ke=String(It);break e}}Ke=Mt}var Nt={},en=V.document&&xe&&(Ge()||parseInt(Ke,10))||void 0;function $t(n,e){if(B.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Te){e:{try{ze(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ht[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&$t.$.h.call(this)}}we($t,B);var ht={2:"touch",3:"pen",4:"mouse"};$t.prototype.h=function(){$t.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var qe="closure_listenable_"+(1e6*Math.random()|0),Et=0;function pt(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++Et,this.fa=this.ia=!1}function fn(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Fn(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function pn(n){const e={};for(const t in n)e[t]=n[t];return e}const qt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ot(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<qt.length;s++)t=qt[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function En(n){this.src=n,this.g={},this.h=0}function St(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=Oe(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(fn(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Ht(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}En.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var u=Ht(n,e,r,i);return-1<u?(e=n[u],t||(e.ia=!1)):((e=new pt(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var bn="closure_lm_"+(1e6*Math.random()|0),tn={};function Un(n,e,t,r,i){if(r&&r.once)return qn(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Un(n,e[s],t,r,i);return null}return t=p(t),n&&n[qe]?n.O(e,t,H(r)?!!r.capture:!!r,i):nn(n,e,t,!1,r,i)}function nn(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var u=H(i)?!!i.capture:!!i,d=A(n);if(d||(n[bn]=d=new En(n)),(t=d.add(e,t,r,u,s)).proxy)return t;if(r=function rn(){const e=x;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Qe||(i=u),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(G(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function qn(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)qn(n,e[s],t,r,i);return null}return t=p(t),n&&n[qe]?n.P(e,t,H(r)?!!r.capture:!!r,i):nn(n,e,t,!0,r,i)}function wn(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)wn(n,e[s],t,r,i);else r=H(r)?!!r.capture:!!r,t=p(t),n&&n[qe]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Ht(s=n.g[e],t,r,i))&&(fn(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=A(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Ht(e,t,r,i)),(t=-1<n?e[n]:null)&&mn(t))}function mn(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[qe])St(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(G(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=A(e))?(St(t,n),0==t.h&&(t.src=null,e[bn]=null)):fn(n)}}}function G(n){return n in tn?tn[n]:tn[n]="on"+n}function x(n,e){if(n.fa)n=!0;else{e=new $t(e,this);var t=n.listener,r=n.la||n.src;n.ia&&mn(n),n=t.call(r,e)}return n}function A(n){return(n=n[bn])instanceof En?n:null}var T="__closure_events_fn_"+(1e9*Math.random()>>>0);function p(n){return"function"==typeof n?n:(n[T]||(n[T]=function(e){return n.handleEvent(e)}),n[T])}function g(){J.call(this),this.i=new En(this),this.S=this,this.J=null}function y(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new B(e,n);else if(e instanceof B)e.target=e.target||n;else{var i=e;Ot(e=new B(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var u=e.g=t[s];i=E(u,r,!0,e)&&i}if(i=E(u=e.g=n,r,!0,e)&&i,i=E(u,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=E(u=e.g=t[s],r,!1,e)&&i}function E(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var u=e[s];if(u&&!u.fa&&u.capture==t){var d=u.listener,h=u.la||u.src;u.ia&&St(n.i,u),i=!1!==d.call(h,r)&&i}}return i&&!r.defaultPrevented}we(g,J),g.prototype[qe]=!0,g.prototype.removeEventListener=function(n,e,t,r){wn(this,n,e,t,r)},g.prototype.N=function(){if(g.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)fn(t[r]);delete n.g[e],n.h--}}this.J=null},g.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},g.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var D=V.JSON.stringify;function W(){var n=Hn;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Qt,Ue=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new cn,n=>n.reset());class cn{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Rt(n){V.setTimeout(()=>{throw n},0)}function Zt(n,e){Qt||function nr(){var n=V.Promise.resolve(void 0);Qt=function(){n.then(jr)}}(),gn||(Qt(),gn=!0),Hn.add(n,e)}var gn=!1,Hn=new class ce{constructor(){this.h=this.g=null}add(e,t){const r=Ue.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function jr(){for(var n;n=W();){try{n.h.call(n.g)}catch(t){Rt(t)}var e=Ue;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}gn=!1}function Tn(n,e){g.call(this),this.h=n||1,this.g=e||V,this.j=F(this.qb,this),this.l=Date.now()}function Wr(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function Zn(n,e,t){if("function"==typeof n)t&&(n=F(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=F(n.handleEvent,n)}return 2147483647<Number(e)?-1:V.setTimeout(n,e||0)}function fr(n){n.g=Zn(()=>{n.g=null,n.i&&(n.i=!1,fr(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}we(Tn,g),(U=Tn.prototype).ga=!1,U.T=null,U.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),y(this,"tick"),this.ga&&(Wr(this),this.start()))}},U.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},U.N=function(){Tn.$.N.call(this),Wr(this),delete this.g};class Qn extends J{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:fr(this)}N(){super.N(),this.g&&(V.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mn(n){J.call(this),this.h=n,this.g={}}we(Mn,J);var pr=[];function Ti(n,e,t,r){Array.isArray(t)||(t&&(pr[0]=t.toString()),t=pr);for(var i=0;i<t.length;i++){var s=Un(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function mr(n){Fn(n.g,function(e,t){this.g.hasOwnProperty(t)&&mn(e)},n),n.g={}}function Cr(){this.g=!0}function Yn(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function ys(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var u=1;u<i.length;u++)i[u]=""}}}return D(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Mn.prototype.N=function(){Mn.$.N.call(this),mr(this)},Mn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Cr.prototype.Ea=function(){this.g=!1},Cr.prototype.info=function(){};var Nn={},$r=null;function xi(){return $r=$r||new g}function vs(n){B.call(this,Nn.Ta,n)}function qr(n){const e=xi();y(e,new vs(e))}function Is(n,e){B.call(this,Nn.STAT_EVENT,n),this.stat=e}function ut(n){const e=xi();y(e,new Is(e,n))}function Ci(n,e){B.call(this,Nn.Ua,n),this.size=e}function Hr(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return V.setTimeout(function(){n()},e)}Nn.Ta="serverreachability",we(vs,B),Nn.STAT_EVENT="statevent",we(Is,B),Nn.Ua="timingevent",we(Ci,B);var Zr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ct={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function kr(){}function Vn(){}kr.prototype.h=null;var Es,Bn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Yr(){B.call(this,"d")}function Xr(){B.call(this,"c")}function ki(){}function Xn(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Mn(this),this.P=ws,this.V=new Tn(n=Je?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.aa=-1,this.J=!1,this.O=0,this.M=null,this.ca=this.K=this.ba=this.S=!1,this.h=new bs}function bs(){this.i=null,this.g="",this.h=!1}we(Yr,B),we(Xr,B),we(ki,kr),ki.prototype.g=function(){return new XMLHttpRequest},ki.prototype.i=function(){return{}},Es=new ki;var ws=45e3,Ts={},Jr={};function As(n,e,t){n.L=1,n.v=On(xt(e)),n.s=t,n.S=!0,Ss(n,null)}function Ss(n,e){n.G=Date.now(),Dr(n),n.A=xt(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),Di(t.i,"t",r),n.C=0,t=n.l.I,n.h=new bs,n.g=Ro(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Qn(F(n.Pa,n,n.g),n.O)),Ti(n.U,n.g,"readystatechange",n.nb),e=n.I?pn(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),qr(),function Ai(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var u="",d=s.split("&"),h=0;h<d.length;h++){var _=d[h].split("=");if(1<_.length){var I=_[0];_=_[1];var b=I.split("_");u=2<=b.length&&"type"==b[1]?u+(I+"=")+_+"&":u+(I+"=redacted&")}}else u=null;else u=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+u})}(n.j,n.u,n.A,n.m,n.W,n.s)}function xs(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function Cs(n,e,t){let i,r=!0;for(;!n.J&&n.C<t.length;){if(i=ks(n,t),i==Jr){4==e&&(n.o=4,ut(14),r=!1),Yn(n.j,n.m,null,"[Incomplete Response]");break}if(i==Ts){n.o=4,ut(15),Yn(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Yn(n.j,n.m,i,null),Y(n,i)}xs(n)&&i!=Jr&&i!=Ts&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,ut(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ca&&(n.ca=!0,(e=n.l).g==n&&e.ca&&!e.L&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),Ls(e),e.L=!0,ut(11))):(Yn(n.j,n.m,t,"[Invalid Chunked Response]"),K(n),M(n))}function ks(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Jr:(t=Number(e.substring(t,r)),isNaN(t)?Ts:(r+=1)+t>e.length?Jr:(e=e.substr(r,t),n.C=r+t,e))}function Dr(n){n.Y=Date.now()+n.P,k(n,n.P)}function k(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Hr(F(n.lb,n),e)}function S(n){n.B&&(V.clearTimeout(n.B),n.B=null)}function M(n){0==n.l.H||n.J||Wa(n.l,n)}function K(n){S(n);var e=n.M;e&&"function"==typeof e.ra&&e.ra(),n.M=null,Wr(n.V),mr(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.ra())}function Y(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||_o(t.h,n)))if(!n.K&&_o(t.h,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Fi(t),Ao(t)}ja(t),ut(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.M&&0==t.A&&!t.v&&(t.v=Hr(F(t.ib,t),6e3));if(1>=Pa(t.h)&&t.na){try{t.na()}catch{}t.na=void 0}}else si(t,11)}else if((n.K||t.g==n)&&Fi(t),!be(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let _=i[e];if(t.V=_[0],_=_[1],2==t.H)if("c"==_[0]){t.J=_[1],t.oa=_[2];const I=_[3];null!=I&&(t.qa=I,t.j.info("VER="+t.qa));const b=_[4];null!=b&&(t.Ga=b,t.j.info("SVER="+t.Ga));const N=_[5];null!=N&&"number"==typeof N&&0<N&&(t.K=r=1.5*N,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const z=n.g;if(z){const X=z.g?z.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(X){var s=r.h;s.g||-1==X.indexOf("spdy")&&-1==X.indexOf("quic")&&-1==X.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(La(s,s.h),s.h=null))}if(r.F){const de=z.g?z.g.getResponseHeader("X-HTTP-Session-Id"):null;de&&(r.Da=de,_t(r.G,r.F,de))}}t.H=3,t.l&&t.l.Ba(),t.ca&&(t.S=Date.now()-n.G,t.j.info("Handshake RTT: "+t.S+"ms"));var u=n;if((r=t).wa=dc(r,r.I?r.oa:null,r.Y),u.K){ri(r.h,u);var d=u,h=r.K;h&&d.setTimeout(h),d.B&&(S(d),Dr(d)),r.g=u}else Co(r);0<t.i.length&&Mr(t)}else"stop"!=_[0]&&"close"!=_[0]||si(t,7);else 3==t.H&&("stop"==_[0]||"close"==_[0]?"stop"==_[0]?si(t,7):Ps(t):"noop"!=_[0]&&t.l&&t.l.Aa(_),t.A=0)}qr()}catch{}}function je(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Z(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function He(n){if(n.sa&&"function"==typeof n.sa)return n.sa();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Z(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function Ae(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Z(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(U=Xn.prototype).setTimeout=function(n){this.P=n},U.nb=function(n){n=n.target;const e=this.M;e&&3==Jn(n)?e.l():this.Pa(n)},U.Pa=function(n){try{if(n==this.g)e:{const I=Jn(this.g);var e=this.g.Ia();if(this.g.da(),!(3>I)&&(3!=I||Je||this.g&&(this.h.h||this.g.ja()||Ga(this.g)))){this.J||4!=I||7==e||qr(),S(this);var t=this.g.da();this.aa=t;t:if(xs(this)){var r=Ga(this.g);n="";var i=r.length,s=4==Jn(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){K(this),M(this);var u="";break t}this.h.i=new V.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,u=this.h.g}else u=this.g.ja();if(this.i=200==t,function _s(n,e,t,r,i,s,u){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+u})}(this.j,this.u,this.A,this.m,this.W,I,t),this.i){if(this.ba&&!this.K){t:{if(this.g){var d,h=this.g;if((d=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!be(d)){var _=d;break t}}_=null}if(!(t=_)){this.i=!1,this.o=3,ut(12),K(this),M(this);break e}Yn(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Y(this,t)}this.S?(Cs(this,I,u),Je&&this.i&&3==I&&(Ti(this.U,this.V,"tick",this.mb),this.V.start())):(Yn(this.j,this.m,u,null),Y(this,u)),4==I&&K(this),this.i&&!this.J&&(4==I?Wa(this.l,this):(this.i=!1,Dr(this)))}else 400==t&&0<u.indexOf("Unknown SID")?(this.o=3,ut(12)):(this.o=0,ut(13)),K(this),M(this)}}}catch{}},U.mb=function(){if(this.g){var n=Jn(this.g),e=this.g.ja();this.C<e.length&&(S(this),Cs(this,n,e),this.i&&4!=n&&Dr(this))}},U.cancel=function(){this.J=!0,K(this)},U.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Si(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(qr(),ut(17)),K(this),this.o=2,M(this)):k(this,this.Y-n)};var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rr(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof rr){this.h=void 0!==e?e:n.h,Rr(this,n.j),this.s=n.s,this.g=n.g,zn(this,n.m),this.l=n.l,e=n.i;var t=new ti;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),mo(this,t),this.o=n.o}else n&&(t=String(n).match(nt))?(this.h=!!e,Rr(this,t[1]||"",!0),this.s=Ds(t[2]||""),this.g=Ds(t[3]||"",!0),zn(this,t[4]),this.l=Ds(t[5]||"",!0),mo(this,t[6]||"",!0),this.o=Ds(t[7]||"")):(this.h=!!e,this.i=new ti(null,this.h))}function xt(n){return new rr(n)}function Rr(n,e,t){n.j=t?Ds(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function zn(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function mo(n,e,t){e instanceof ti?(n.i=e,function Na(n,e){e&&!n.j&&(An(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(ic(this,r),Di(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=ei(e,Gl)),n.i=new ti(e,n.h))}function _t(n,e,t){n.i.set(e,t)}function On(n){return _t(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ds(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ei(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Bl),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Bl(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}rr.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ei(e,go,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(ei(e,go,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(ei(t,"/"==t.charAt(0)?Ma:zl,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ei(t,Kl)),n.join("")};var go=/[#\/\?@]/g,zl=/[#\?:]/g,Ma=/[#\?]/g,Gl=/[#\?@]/g,Kl=/#/g;function ti(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function An(n){n.g||(n.g=new Map,n.h=0,n.i&&function gr(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function ic(n,e){An(n),e=Rs(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function sc(n,e){return An(n),e=Rs(n,e),n.g.has(e)}function Di(n,e,t){ic(n,e),0<t.length&&(n.i=null,n.g.set(Rs(n,e),Se(t)),n.h+=t.length)}function Rs(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function ni(n){this.l=n||Ri,n=V.PerformanceNavigationTiming?0<(n=V.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(V.g&&V.g.Ka&&V.g.Ka()&&V.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(U=ti.prototype).add=function(n,e){An(this),this.i=null,n=Rs(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},U.forEach=function(n,e){An(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},U.sa=function(){An(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},U.Z=function(n){An(this);let e=[];if("string"==typeof n)sc(this,n)&&(e=e.concat(this.g.get(Rs(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},U.set=function(n,e){return An(this),this.i=null,sc(this,n=Rs(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},U.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},U.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),u=this.Z(r);for(r=0;r<u.length;r++){var i=s;""!==u[r]&&(i+="="+encodeURIComponent(String(u[r]))),n.push(i)}}return this.i=n.join("&")};var Ri=10;function Oa(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Pa(n){return n.h?1:n.g?n.g.size:0}function _o(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function La(n,e){n.g?n.g.add(e):n.h=e}function ri(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function oc(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return Se(n.i)}function Mi(){}function ac(){this.g=new Mi}function yo(n,e,t){const r=t||"";try{je(n,function(i,s){let u=i;H(i)&&(u=D(i)),e.push(r+s+"="+encodeURIComponent(u))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function _n(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ni(n){this.l=n.fc||null,this.j=n.ob||!1}function vo(n,e){g.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Ms,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ni.prototype.cancel=function(){if(this.i=oc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Mi.prototype.stringify=function(n){return V.JSON.stringify(n,void 0)},Mi.prototype.parse=function(n){return V.JSON.parse(n,void 0)},we(Ni,kr),Ni.prototype.g=function(){return new vo(this.l,this.j)},Ni.prototype.i=function(n){return function(){return n}}({}),we(vo,g);var Ms=0;function Ns(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function Oi(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Pi(n)}function Pi(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(U=vo.prototype).open=function(n,e){if(this.readyState!=Ms)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Pi(this)},U.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||V).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},U.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Oi(this)),this.readyState=Ms},U.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Pi(this)),this.g&&(this.readyState=3,Pi(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof V.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ns(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},U.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Oi(this):Pi(this),3==this.readyState&&Ns(this)}},U.Za=function(n){this.g&&(this.response=this.responseText=n,Oi(this))},U.Ya=function(n){this.g&&(this.response=n,Oi(this))},U.ka=function(){this.g&&Oi(this)},U.setRequestHeader=function(n,e){this.v.append(n,e)},U.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},U.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(vo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var jl=V.JSON.parse;function yt(n){g.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Io,this.L=this.M=!1}we(yt,g);var Io="",Ua=/^https?$/i,Eo=["POST","PUT"];function Ba(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,bo(n),Li(n)}function bo(n){n.F||(n.F=!0,y(n,"complete"),y(n,"error"))}function za(n){if(n.h&&typeof ie<"u"&&(!n.C[1]||4!=Jn(n)||2!=n.da()))if(n.v&&4==Jn(n))Zn(n.La,0,n);else if(y(n,"readystatechange"),4==Jn(n)){n.h=!1;try{const d=n.da();e:switch(d){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===d){var i=String(n.I).match(nt)[1]||null;if(!i&&V.self&&V.self.location){var s=V.self.location.protocol;i=s.substr(0,s.length-1)}r=!Ua.test(i?i.toLowerCase():"")}t=r}if(t)y(n,"complete"),y(n,"success");else{n.m=6;try{var u=2<Jn(n)?n.g.statusText:""}catch{u=""}n.j=u+" ["+n.da()+"]",bo(n)}}finally{Li(n)}}}function Li(n,e){if(n.g){Os(n);const t=n.g,r=n.C[0]?ae:null;n.g=null,n.C=null,e||y(n,"ready");try{t.onreadystatechange=r}catch{}}}function Os(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(V.clearTimeout(n.A),n.A=null)}function Jn(n){return n.g?n.g.readyState:0}function Ga(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case Io:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function wo(n){let e="";return Fn(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function To(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=wo(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):_t(n,e,t))}function ii(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function uc(n){this.Ga=0,this.i=[],this.j=new Cr,this.oa=this.wa=this.G=this.Y=this.g=this.Da=this.F=this.ma=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ii("failFast",!1,n),this.M=this.v=this.u=this.m=this.l=null,this.aa=!0,this.ta=this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ii("baseRetryDelayMs",5e3,n),this.hb=ii("retryDelaySeedMs",1e4,n),this.eb=ii("forwardChannelMaxRetries",2,n),this.xa=ii("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.K=void 0,this.I=n&&n.supportsCrossDomainXhr||!1,this.J="",this.h=new ni(n&&n.concurrentRequestLimit),this.Ja=new ac,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.j.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.na=void 0,this.S=0,this.L=!1,this.pa=this.B=null}function Ps(n){if(So(n),3==n.H){var e=n.W++,t=xt(n.G);_t(t,"SID",n.J),_t(t,"RID",e),_t(t,"TYPE","terminate"),ir(n,t),(e=new Xn(n,n.j,e,void 0)).L=2,e.v=On(xt(t)),t=!1,V.navigator&&V.navigator.sendBeacon&&(t=V.navigator.sendBeacon(e.v.toString(),"")),!t&&V.Image&&((new Image).src=e.v,t=!0),t||(e.g=Ro(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Dr(e)}Do(n)}function Ao(n){n.g&&(Ls(n),n.g.cancel(),n.g=null)}function So(n){Ao(n),n.u&&(V.clearTimeout(n.u),n.u=null),Fi(n),n.h.cancel(),n.m&&("number"==typeof n.m&&V.clearTimeout(n.m),n.m=null)}function Mr(n){Oa(n.h)||n.m||(n.m=!0,Zt(n.Na,n),n.C=0)}function xo(n,e){var t;t=e?e.m:n.W++;const r=xt(n.G);_t(r,"SID",n.J),_t(r,"RID",t),_t(r,"AID",n.V),ir(n,r),n.o&&n.s&&To(r,n.o,n.s),t=new Xn(n,n.j,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.i=e.F.concat(n.i)),e=cc(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),La(n.h,t),As(t,r,e)}function ir(n,e){n.ma&&Fn(n.ma,function(t,r){_t(e,r,t)}),n.l&&je({},function(t,r){_t(e,r,t)})}function cc(n,e,t){t=Math.min(n.i.length,t);var r=n.l?F(n.l.Va,n.l,n):null;e:{var i=n.i;let s=-1;for(;;){const u=["count="+t];-1==s?0<t?(s=i[0].h,u.push("ofs="+s)):s=0:u.push("ofs="+s);let d=!0;for(let h=0;h<t;h++){let _=i[h].h;const I=i[h].g;if(_-=s,0>_)s=Math.max(0,i[h].h-100),d=!1;else try{yo(I,u,"req"+_+"_")}catch{r&&r(I)}}if(d){r=u.join("&");break e}}}return n=n.i.splice(0,t),e.F=n,r}function Co(n){n.g||n.u||(n.ba=1,Zt(n.Ma,n),n.A=0)}function ja(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Hr(F(n.Ma,n),ko(n,n.A)),n.A++,0))}function Ls(n){null!=n.B&&(V.clearTimeout(n.B),n.B=null)}function lc(n){n.g=new Xn(n,n.j,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=xt(n.wa);_t(e,"RID","rpc"),_t(e,"SID",n.J),_t(e,"CI",n.M?"0":"1"),_t(e,"AID",n.V),_t(e,"TYPE","xmlhttp"),ir(n,e),n.o&&n.s&&To(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.oa,t.L=1,t.v=On(xt(e)),t.s=null,t.S=!0,Ss(t,n)}function Fi(n){null!=n.v&&(V.clearTimeout(n.v),n.v=null)}function Wa(n,e){var t=null;if(n.g==e){Fi(n),Ls(n),n.g=null;var r=2}else{if(!_o(n.h,e))return;t=e.F,ri(n.h,e),r=1}if(0!=n.H)if(n.ta=e.aa,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;y(r=xi(),new Ci(r,t)),Mr(n)}else Co(n);else if(3==(i=e.o)||0==i&&0<n.ta||!(1==r&&function Ka(n,e){return!(Pa(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.F.concat(n.i),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Hr(F(n.Na,n,e),ko(n,n.C)),n.C++,0)))}(n,e)||2==r&&ja(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:si(n,5);break;case 4:si(n,10);break;case 3:si(n,6);break;default:si(n,2)}}function ko(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.l||(t*=2),t*e}function si(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=F(n.pb,n);t||(t=new rr("//www.google.com/images/cleardot.gif"),V.location&&"http"==V.location.protocol||Rr(t,"https"),On(t)),function Fa(n,e){const t=new Cr;if(V.Image){const r=new Image;r.onload=Ze(_n,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Ze(_n,t,r,"TestLoadImage: error",!1,e),r.onabort=Ze(_n,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ze(_n,t,r,"TestLoadImage: timeout",!1,e),V.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else ut(2);n.H=0,n.l&&n.l.za(e),Do(n),So(n)}function Do(n){if(n.H=0,n.pa=[],n.l){const e=oc(n.h);(0!=e.length||0!=n.i.length)&&(Xe(n.pa,e),Xe(n.pa,n.i),n.h.i.length=0,Se(n.i),n.i.length=0),n.l.ya()}}function dc(n,e,t){var r=t instanceof rr?xt(t):new rr(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),zn(r,r.m);else{var i=V.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new rr(null,void 0);r&&Rr(s,r),e&&(s.g=e),i&&zn(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&_t(r,t,e),_t(r,"VER",n.qa),ir(n,r),r}function Ro(n,e,t){if(e&&!n.I)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new yt(t&&n.Ha&&!n.va?new Ni({ob:!0}):n.va)).Oa(n.I),e}function hc(){}function Mo(){if(xe&&!(10<=Number(en)))throw Error("Environmental error: no available transport.")}function yn(n,e){g.call(this),this.g=new uc(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!be(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!be(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Nr(this)}function fc(n){Yr.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function pc(){Xr.call(this),this.status=1}function Nr(n){this.g=n}function Pn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function $a(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],u=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;u=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(u<<7&4294967295|u>>>25))+((u=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|u>>>20))+((u=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|u>>>15))+((u=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|u>>>10))+((u=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|u>>>25))+((u=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|u>>>20))+((u=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|u>>>15))+((u=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|u>>>10))+((u=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|u>>>25))+((u=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|u>>>20))+((u=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|u>>>15))+((u=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|u>>>10))+((u=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|u>>>25))+((u=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|u>>>20))+((u=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|u>>>15))+((u=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|u>>>10))+((u=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|u>>>27))+((u=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|u>>>23))+((u=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|u>>>18))+((u=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|u>>>12))+((u=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|u>>>27))+((u=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|u>>>23))+((u=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|u>>>18))+((u=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|u>>>12))+((u=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|u>>>27))+((u=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|u>>>23))+((u=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|u>>>18))+((u=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|u>>>12))+((u=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|u>>>27))+((u=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|u>>>23))+((u=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|u>>>18))+((u=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|u>>>12))+((u=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|u>>>28))+((u=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|u>>>21))+((u=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|u>>>16))+((u=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|u>>>9))+((u=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|u>>>28))+((u=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|u>>>21))+((u=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|u>>>16))+((u=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|u>>>9))+((u=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|u>>>28))+((u=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|u>>>21))+((u=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|u>>>16))+((u=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|u>>>9))+((u=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|u>>>28))+((u=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|u>>>21))+((u=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|u>>>16))+((u=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|u>>>9))+((u=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|u>>>26))+((u=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|u>>>22))+((u=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|u>>>17))+((u=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|u>>>11))+((u=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|u>>>26))+((u=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|u>>>22))+((u=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|u>>>17))+((u=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|u>>>11))+((u=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|u>>>26))+((u=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|u>>>22))+((u=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|u>>>17))+((u=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|u>>>11))+((s=(e=t+((u=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|u>>>26))+((u=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|u>>>22))^((i=s+((u=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|u>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(u<<21&4294967295|u>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function tt(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(U=yt.prototype).Oa=function(n){this.M=n},U.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Es.g(),this.C=function Qr(n){return n.h||(n.h=n.i())}(this.u?this.u:Es),this.g.onreadystatechange=F(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void Ba(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=V.FormData&&n instanceof V.FormData,!(0<=Oe(Eo,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,u]of t)this.g.setRequestHeader(s,u);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Os(this),0<this.B&&((this.L=function Va(n){return xe&&function un(){return Re(Nt,9,function(){let n=0;const e=at(String(Ke)).split("."),t=at("9").split("."),r=Math.max(e.length,t.length);for(let u=0;0==n&&u<r;u++){var i=e[u]||"",s=t[u]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;n=dt(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||dt(0==i[2].length,0==s[2].length)||dt(i[2],s[2]),i=i[3],s=s[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=F(this.ua,this)):this.A=Zn(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Ba(this,s)}},U.ua=function(){typeof ie<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,y(this,"timeout"),this.abort(8))},U.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,y(this,"complete"),y(this,"abort"),Li(this))},U.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Li(this,!0)),yt.$.N.call(this)},U.La=function(){this.s||(this.G||this.v||this.l?za(this):this.kb())},U.kb=function(){za(this)},U.da=function(){try{return 2<Jn(this)?this.g.status:-1}catch{return-1}},U.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},U.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),jl(e)}},U.Ia=function(){return this.m},U.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(U=uc.prototype).qa=8,U.H=1,U.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Xn(this,this.j,n,void 0);let s=this.s;if(this.U&&(s?(s=pn(s),Ot(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=cc(this,i,e),_t(t=xt(this.G),"RID",n),_t(t,"CVER",22),this.F&&_t(t,"X-HTTP-Session-Id",this.F),ir(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(wo(s)))+"&"+e:this.o&&To(t,this.o,s)),La(this.h,i),this.bb&&_t(t,"TYPE","init"),this.P?(_t(t,"$req",e),_t(t,"SID","null"),i.ba=!0,As(i,t,null)):As(i,t,e),this.H=2}}else 3==this.H&&(n?xo(this,n):0==this.i.length||Oa(this.h)||xo(this))},U.Ma=function(){if(this.u=null,lc(this),this.ca&&!(this.L||null==this.g||0>=this.S)){var n=2*this.S;this.j.info("BP detection timer enabled: "+n),this.B=Hr(F(this.jb,this),n)}},U.jb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.M=!1,this.L=!0,ut(10),Ao(this),lc(this))},U.ib=function(){null!=this.v&&(this.v=null,Ao(this),ja(this),ut(19))},U.pb=function(n){n?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))},(U=hc.prototype).Ba=function(){},U.Aa=function(){},U.za=function(){},U.ya=function(){},U.Va=function(){},Mo.prototype.g=function(n,e){return new yn(n,e)},we(yn,g),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.I=!0);var n=this.g,e=this.l,t=this.h||void 0;ut(0),n.Y=e,n.ma=t||{},n.M=n.aa,n.G=dc(n,null,n.Y),Mr(n)},yn.prototype.close=function(){Ps(this.g)},yn.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=D(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.fb++,n)),3==e.H&&Mr(e)},yn.prototype.N=function(){this.g.l=null,delete this.j,Ps(this.g),delete this.g,yn.$.N.call(this)},we(fc,Yr),we(pc,Xr),we(Nr,hc),Nr.prototype.Ba=function(){y(this.g,"a")},Nr.prototype.Aa=function(n){y(this.g,new fc(n))},Nr.prototype.za=function(n){y(this.g,new pc)},Nr.prototype.ya=function(){y(this.g,"b")},we(Pn,function Wl(){this.blockSize=-1}),Pn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Pn.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)$a(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){$a(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){$a(this,r),i=0;break}}this.h=i,this.i+=e},Pn.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var $l={};function Fs(n){return-128<=n&&128>n?Re($l,n,function(e){return new tt([0|e],0>e?-1:0)}):new tt([0|n],0>n?-1:0)}function sr(n){if(isNaN(n)||!isFinite(n))return Or;if(0>n)return Yt(sr(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=qa;return new tt(e,0)}var qa=4294967296,Or=Fs(0),Ha=Fs(1),Oo=Fs(16777216);function yr(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Gn(n){return-1==n.h}function Yt(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new tt(t,~n.h).add(Ha)}function Ui(n,e){return n.add(Yt(e))}function Po(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function or(n,e){this.g=n,this.h=e}function Us(n,e){if(yr(e))throw Error("division by zero");if(yr(n))return new or(Or,Or);if(Gn(n))return e=Us(Yt(n),e),new or(Yt(e.g),Yt(e.h));if(Gn(e))return e=Us(n,Yt(e)),new or(Yt(e.g),e.h);if(30<n.g.length){if(Gn(n)||Gn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Ha,r=e;0>=r.X(n);)t=mc(t),r=mc(r);var i=Vi(t,1),s=Vi(r,1);for(r=Vi(r,2),t=Vi(t,2);!yr(r);){var u=s.add(r);0>=u.X(n)&&(i=i.add(t),s=u),r=Vi(r,1),t=Vi(t,1)}return e=Ui(n,i.R(e)),new or(i,e)}for(i=Or;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),u=(s=sr(t)).R(e);Gn(u)||0<u.X(n);)u=(s=sr(t-=r)).R(e);yr(s)&&(s=Ha),i=i.add(s),n=Ui(n,u)}return new or(i,n)}function mc(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new tt(t,n.h)}function Vi(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new tt(i,n.h)}(U=tt.prototype).ea=function(){if(Gn(this))return-Yt(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:qa+r)*e,e*=qa}return n},U.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(yr(this))return"0";if(Gn(this))return"-"+Yt(this).toString(n);for(var e=sr(Math.pow(n,6)),t=this,r="";;){var i=Us(t,e).g,s=((0<(t=Ui(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(yr(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},U.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},U.X=function(n){return Gn(n=Ui(this,n))?-1:yr(n)?0:1},U.abs=function(){return Gn(this)?Yt(this):this},U.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),u=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=u>>>16,t[i]=(u&=65535)<<16|(s&=65535)}return new tt(t,-2147483648&t[t.length-1]?-1:0)},U.R=function(n){if(yr(this)||yr(n))return Or;if(Gn(this))return Gn(n)?Yt(this).R(Yt(n)):Yt(Yt(this).R(n));if(Gn(n))return Yt(this.R(Yt(n)));if(0>this.X(Oo)&&0>n.X(Oo))return sr(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,u=65535&this.D(r),d=n.D(i)>>>16,h=65535&n.D(i);t[2*r+2*i]+=u*h,Po(t,2*r+2*i),t[2*r+2*i+1]+=s*h,Po(t,2*r+2*i+1),t[2*r+2*i+1]+=u*d,Po(t,2*r+2*i+1),t[2*r+2*i+2]+=s*d,Po(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new tt(t,0)},U.gb=function(n){return Us(this,n).h},U.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new tt(t,this.h&n.h)},U.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new tt(t,this.h|n.h)},U.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new tt(t,this.h^n.h)},Mo.prototype.createWebChannel=Mo.prototype.g,yn.prototype.send=yn.prototype.u,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Zr.NO_ERROR=0,Zr.TIMEOUT=8,Zr.HTTP_ERROR=6,ct.COMPLETE="complete",Vn.EventType=Bn,Bn.OPEN="a",Bn.CLOSE="b",Bn.ERROR="c",Bn.MESSAGE="d",g.prototype.listen=g.prototype.O,yt.prototype.listenOnce=yt.prototype.P,yt.prototype.getLastError=yt.prototype.Sa,yt.prototype.getLastErrorCode=yt.prototype.Ia,yt.prototype.getStatus=yt.prototype.da,yt.prototype.getResponseJson=yt.prototype.Wa,yt.prototype.getResponseText=yt.prototype.ja,yt.prototype.send=yt.prototype.ha,yt.prototype.setWithCredentials=yt.prototype.Oa,Pn.prototype.digest=Pn.prototype.l,Pn.prototype.reset=Pn.prototype.reset,Pn.prototype.update=Pn.prototype.j,tt.prototype.add=tt.prototype.add,tt.prototype.multiply=tt.prototype.R,tt.prototype.modulo=tt.prototype.gb,tt.prototype.compare=tt.prototype.X,tt.prototype.toNumber=tt.prototype.ea,tt.prototype.toString=tt.prototype.toString,tt.prototype.getBits=tt.prototype.D,tt.fromNumber=sr,tt.fromString=function No(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return Yt(No(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=sr(Math.pow(e,8)),r=Or,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),u=parseInt(n.substring(i,i+s),e);8>s?(s=sr(Math.pow(e,s)),r=r.R(s).add(sr(u))):r=(r=r.R(t)).add(sr(u))}return r};var ql=ye.createWebChannelTransport=function(){return new Mo},Hl=ye.getStatEventTarget=function(){return xi()},Za=ye.ErrorCode=Zr,pf=ye.EventType=ct,mf=ye.Event=Nn,gc=ye.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Zl=ye.FetchXmlHttpFactory=Ni,Qa=ye.WebChannel=Vn,gf=ye.XhrIo=yt,_f=ye.Md5=Pn,Vs=ye.Integer=tt;const Ql="@firebase/firestore";class Pt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pt.UNAUTHENTICATED=new Pt(null),Pt.GOOGLE_CREDENTIALS=new Pt("google-credentials-uid"),Pt.FIRST_PARTY=new Pt("first-party-uid"),Pt.MOCK_USER=new Pt("mock-user");let Kn="9.22.0";const ar=new me.Yd("@firebase/firestore");function Ya(){return ar.logLevel}function Yl(n){ar.setLogLevel(n)}function Q(n,...e){if(ar.logLevel<=me.in.DEBUG){const t=e.map(Xa);ar.debug(`Firestore (${Kn}): ${n}`,...t)}}function Lt(n,...e){if(ar.logLevel<=me.in.ERROR){const t=e.map(Xa);ar.error(`Firestore (${Kn}): ${n}`,...t)}}function jn(n,...e){if(ar.logLevel<=me.in.WARN){const t=e.map(Xa);ar.warn(`Firestore (${Kn}): ${n}`,...t)}}function Xa(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function he(n="Unexpected state"){const e=`FIRESTORE (${Kn}) INTERNAL ASSERTION FAILED: `+n;throw Lt(e),new Error(e)}function ve(n,e){n||he()}function Xl(n,e){n||he()}function se(n,e){return n}const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends re.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Kt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class _c{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pt.UNAUTHENTICATED))}shutdown(){}}class Lo{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vf{constructor(e){this.t=e,this.currentUser=Pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=_=>this.i!==i?(i=this.i,t(_)):Promise.resolve();let u=new Kt;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new Kt,e.enqueueRetryable(()=>s(this.currentUser))};const d=()=>{const _=u;e.enqueueRetryable((0,f.Z)(function*(){yield _.promise,yield s(r.currentUser)}))},h=_=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(_=>h(_)),setTimeout(()=>{if(!this.auth){const _=this.t.getImmediate({optional:!0});_?h(_):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Kt)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve("string"==typeof r.accessToken),new _c(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ve(null===e||"string"==typeof e),new Pt(e)}}class Pr{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=Pt.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Jl{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new Pr(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Bs{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const r=s=>{null!=s.error&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const u=s.token!==this.T;return this.T=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ve("string"==typeof t.token),this.T=t.token,new yc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ft(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class vc{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Ft(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function Ce(n,e){return n<e?-1:n>e?1:0}function Bi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Fo(n){return n+"\0"}class vt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new $(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new vt(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ee{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ee(e)}static min(){return new Ee(new vt(0,0))}static max(){return new Ee(new vt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class zi{constructor(e,t,r){void 0===t?t=0:t>e.length&&he(),void 0===r?r=e.length-t:r>e.length-t&&he(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===zi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zi?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),u=t.get(i);if(s<u)return-1;if(s>u)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class We extends zi{construct(e,t,r){return new We(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new We(t)}static emptyPath(){return new We([])}}const Uo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bt extends zi{construct(e,t,r){return new bt(e,t,r)}static isValidIdentifier(e){return Uo.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bt(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new $(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;i<e.length;){const d=e[i];if("\\"===d){if(i+1===e.length)throw new $(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if("\\"!==h&&"."!==h&&"`"!==h)throw new $(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else"`"===d?(u=!u,i++):"."!==d||u?(r+=d,i++):(s(),i++)}if(s(),u)throw new $(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bt(t)}static emptyPath(){return new bt([])}}class ne{constructor(e){this.path=e}static fromPath(e){return new ne(We.fromString(e))}static fromName(e){return new ne(We.fromString(e).popFirst(5))}static empty(){return new ne(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===We.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return We.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new We(e.slice()))}}class oi{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Ja(n){return n.fields.find(e=>2===e.kind)}function vr(n){return n.fields.filter(e=>2!==e.kind)}oi.UNKNOWN_ID=-1;class Gi{constructor(e,t){this.fieldPath=e,this.kind=t}}class ai{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ai(0,Ln.min())}}function eu(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ee.fromTimestamp(1e9===r?new vt(t+1,0):new vt(t,r));return new Ln(i,ne.empty(),e)}function Ec(n){return new Ln(n.readTime,n.key,-1)}class Ln{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ln(Ee.min(),ne.empty(),-1)}static max(){return new Ln(Ee.max(),ne.empty(),-1)}}function bc(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=ne.comparator(n.documentKey,e.documentKey),0!==t?t:Ce(n.largestBatchId,e.largestBatchId))}const ui="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Lr(n){return tu.apply(this,arguments)}function tu(){return tu=(0,f.Z)(function*(n){if(n.code!==L.FAILED_PRECONDITION||n.message!==ui)throw n;Q("LocalStore","Unexpectedly lost primary lease")}),tu.apply(this,arguments)}class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):O.reject(t)}static resolve(e){return new O((t,r)=>{t(e)})}static reject(e){return new O((t,r)=>{r(e)})}static waitFor(e){return new O((t,r)=>{let i=0,s=0,u=!1;e.forEach(d=>{++i,d.next(()=>{++s,u&&s===i&&t()},h=>r(h))}),u=!0,s===i&&t()})}static or(e){let t=O.resolve(!1);for(const r of e)t=t.next(i=>i?O.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new O((r,i)=>{const s=e.length,u=new Array(s);let d=0;for(let h=0;h<s;h++){const _=h;t(e[_]).next(I=>{u[_]=I,++d,d===s&&r(u)},I=>i(I))}})}static doWhile(e,t){return new O((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Vo{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new Kt,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new zs(e,t.error)):this.v.resolve()},this.transaction.onerror=r=>{const i=ru(r.target.error);this.v.reject(new zs(e,i))}}static open(e,t,r,i){try{return new Vo(t,e.transaction(i,r))}catch(s){throw new zs(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(Q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new nu(t)}}class Sn{constructor(e,t,r){this.name=e,this.version=t,this.V=r,12.2===Sn.S((0,re.z$)())&&Lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Q("SimpleDb","Removing database:",e),ci(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,re.hl)())return!1;if(Sn.C())return!0;const e=(0,re.z$)(),t=Sn.S(e),r=0<t&&t<10,i=Sn.N(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}$(e){var t=this;return(0,f.Z)(function*(){return t.db||(Q("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=u=>{r(u.target.result)},s.onblocked=()=>{i(new zs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=u=>{const d=u.target.error;i("VersionError"===d.name?new $(L.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===d.name?new $(L.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d):new zs(e,d))},s.onupgradeneeded=u=>{Q("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',u.oldVersion),t.V.O(u.target.result,s.transaction,u.oldVersion,t.version).next(()=>{Q("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=r=>t.F(r)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,f.Z)(function*(){const u="readonly"===t;let d=0;for(;;){++d;try{s.db=yield s.$(e);const h=Vo.open(s.db,e,u?"readonly":"readwrite",r),_=i(h).next(I=>(h.P(),I)).catch(I=>(h.abort(I),O.reject(I))).toPromise();return _.catch(()=>{}),yield h.R,_}catch(h){const _=h,I="FirebaseError"!==_.name&&d<3;if(Q("SimpleDb","Transaction failed with error:",_.message,"Retrying:",I),s.close(),!I)return Promise.reject(_)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class td{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return ci(this.L.delete())}}class zs extends ${constructor(e,t){super(L.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fr(n){return"IndexedDbTransactionError"===n.name}class nu{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Q("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ci(r)}add(e){return Q("SimpleDb","ADD",this.store.name,e,e),ci(this.store.add(e))}get(e){return ci(this.store.get(e)).next(t=>(void 0===t&&(t=null),Q("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Q("SimpleDb","DELETE",this.store.name,e),ci(this.store.delete(e))}count(){return Q("SimpleDb","COUNT",this.store.name),ci(this.store.count())}j(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.W(i,(u,d)=>{s.push(d)}).next(()=>s)}{const i=this.store.getAll(r.range);return new O((s,u)=>{i.onerror=d=>{u(d.target.error)},i.onsuccess=d=>{s(d.target.result)}})}}H(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new O((i,s)=>{r.onerror=u=>{s(u.target.error)},r.onsuccess=u=>{i(u.target.result)}})}J(e,t){Q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.W(i,(s,u,d)=>d.delete())}X(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Z(e){const t=this.cursor({});return new O((r,i)=>{t.onerror=s=>{const u=ru(s.target.error);i(u)},t.onsuccess=s=>{const u=s.target.result;u?e(u.primaryKey,u.value).next(d=>{d?u.continue():r()}):r()}})}W(e,t){const r=[];return new O((i,s)=>{e.onerror=u=>{s(u.target.error)},e.onsuccess=u=>{const d=u.target.result;if(!d)return void i();const h=new td(d),_=t(d.primaryKey,d.value,h);if(_ instanceof O){const I=_.catch(b=>(h.done(),O.reject(b)));r.push(I)}h.isDone?i():null===h.K?d.continue():d.continue(h.K)}}).next(()=>O.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ci(n){return new O((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=ru(r.target.error);t(i)}})}let Tc=!1;function ru(n){const e=Sn.S((0,re.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new $("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Tc||(Tc=!0,setTimeout(()=>{throw r},0)),r}}return n}class nd{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;Q("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,f.Z)(function*(){t.task=null;try{Q("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(r){Fr(r)?Q("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Lr(r)}yield t.et(6e4)}))}}class rd{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,f.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.st(r,e))})()}st(e,t){const r=new Set;let i=t,s=!0;return O.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(null!==u&&!r.has(u))return Q("IndexBackiller",`Processing collection: ${u}`),this.it(e,u,i).next(d=>{i-=d,r.add(u)});s=!1})).next(()=>t-i)}it(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const u=s.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.rt(i,s)).next(d=>(Q("IndexBackiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>u.size)}))}rt(e,t){let r=e;return t.changes.forEach((i,s)=>{const u=Ec(s);bc(u,r)>0&&(r=u)}),new Ln(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let xn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>r.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function Gs(n){return null==n}function Ks(n){return 0===n&&1/n==-1/0}function Ac(n){return"number"==typeof n&&Number.isInteger(n)&&!Ks(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Bo(e)),e=id(n.get(t),e);return Bo(e)}function id(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function Bo(n){return n+"\x01\x01"}function ur(n){const e=n.length;if(ve(e>=2),2===e)return ve("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),We.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const u=n.indexOf("\x01",s);switch((u<0||u>t)&&he(),n.charAt(u+1)){case"\x01":const d=n.substring(s,u);let h;0===i.length?h=d:(i+=d,h=i,i=""),r.push(h);break;case"\x10":i+=n.substring(s,u),i+="\0";break;case"\x11":i+=n.substring(s,u+1);break;default:he()}s=u+2}return new We(r)}const zo=["userId","batchId"];function Go(n,e){return[n,Xt(e)]}function Ko(n,e,t){return[n,Xt(e),t]}const jo={},iu=["prefixPath","collectionGroup","readTime","documentId"],sd=["prefixPath","collectionGroup","documentId"],su=["collectionGroup","readTime","prefixPath","documentId"],js=["canonicalId","targetId"],li=["targetId","path"],ou=["path","targetId"],od=["collectionId","parent"],ad=["indexId","uid"],ud=["uid","sequenceNumber"],au=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Sc=["indexId","uid","orderedDocumentKey"],cd=["userId","collectionPath","documentId"],ld=["userId","collectionPath","largestBatchId"],uu=["userId","collectionGroup","largestBatchId"],xc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],cu=[...xc,"documentOverlays"],Cc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Wo=Cc,lu=[...Wo,"indexConfiguration","indexState","indexEntries"];class du extends wc{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Ct(n,e){const t=se(n);return Sn.M(t.ht,e)}function kc(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ur(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $o(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ot{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new ot(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ki(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ki(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ki(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ki(this.root,e,this.comparator,!0)}}class Ki{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??sn.RED,this.left=i??sn.EMPTY,this.right=s??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new sn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return sn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1,sn.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(n,e,t,r,i){return this}insert(n,e,t){return new sn(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class lt{constructor(e){this.comparator=e,this.data=new ot(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hu(this.data.getIterator())}getIteratorFrom(e){return new hu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new lt(this.comparator);return t.data=e,t}}class hu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function di(n){return n.hasNext()?n.getNext():void 0}class Cn{constructor(e){this.fields=e,e.sort(bt.comparator)}static empty(){return new Cn([])}unionWith(e){let t=new lt(bt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Cn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bi(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Dc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function fu(){return typeof atob<"u"}class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Dc("Invalid base64 string: "+i):i}}(e);return new jt(t)}static fromUint8Array(e){const t=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new jt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const dd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cr(n){if(ve(!!n),"string"==typeof n){let e=0;const t=dd.exec(n);if(ve(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:kt(n.seconds),nanos:kt(n.nanos)}}function kt(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Ir(n){return"string"==typeof n?jt.fromBase64String(n):jt.fromUint8Array(n)}function ji(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function qo(n){const e=n.mapValue.fields.__previous_value__;return ji(e)?qo(e):e}function hi(n){const e=cr(n.mapValue.fields.__local_write_time__.timestampValue);return new vt(e.seconds,e.nanos)}class Ho{constructor(e,t,r,i,s,u,d,h,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=_}}class lr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new lr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof lr&&e.projectId===this.projectId&&e.database===this.database}}const Er={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Wi={nullValue:"NULL_VALUE"};function Vr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ji(n)?4:Hs(n)?9007199254740991:10:he()}function er(n,e){if(n===e)return!0;const t=Vr(n);if(t!==Vr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hi(n).isEqual(hi(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=cr(r.timestampValue),u=cr(i.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Ir(n.bytesValue).isEqual(Ir(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return kt(r.geoPointValue.latitude)===kt(i.geoPointValue.latitude)&&kt(r.geoPointValue.longitude)===kt(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return kt(r.integerValue)===kt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=kt(r.doubleValue),u=kt(i.doubleValue);return s===u?Ks(s)===Ks(u):isNaN(s)&&isNaN(u)}return!1}(n,e);case 9:return Bi(n.arrayValue.values||[],e.arrayValue.values||[],er);case 10:return function(r,i){const s=r.mapValue.fields||{},u=i.mapValue.fields||{};if(kc(s)!==kc(u))return!1;for(const d in s)if(s.hasOwnProperty(d)&&(void 0===u[d]||!er(s[d],u[d])))return!1;return!0}(n,e);default:return he()}var i}function $i(n,e){return void 0!==(n.values||[]).find(t=>er(t,e))}function br(n,e){if(n===e)return 0;const t=Vr(n),r=Vr(e);if(t!==r)return Ce(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ce(n.booleanValue,e.booleanValue);case 2:return function(i,s){const u=kt(i.integerValue||i.doubleValue),d=kt(s.integerValue||s.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(n,e);case 3:return Rc(n.timestampValue,e.timestampValue);case 4:return Rc(hi(n),hi(e));case 5:return Ce(n.stringValue,e.stringValue);case 6:return function(i,s){const u=Ir(i),d=Ir(s);return u.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(i,s){const u=i.split("/"),d=s.split("/");for(let h=0;h<u.length&&h<d.length;h++){const _=Ce(u[h],d[h]);if(0!==_)return _}return Ce(u.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,s){const u=Ce(kt(i.latitude),kt(s.latitude));return 0!==u?u:Ce(kt(i.longitude),kt(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,s){const u=i.values||[],d=s.values||[];for(let h=0;h<u.length&&h<d.length;++h){const _=br(u[h],d[h]);if(_)return _}return Ce(u.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===Er.mapValue&&s===Er.mapValue)return 0;if(i===Er.mapValue)return 1;if(s===Er.mapValue)return-1;const u=i.fields||{},d=Object.keys(u),h=s.fields||{},_=Object.keys(h);d.sort(),_.sort();for(let I=0;I<d.length&&I<_.length;++I){const b=Ce(d[I],_[I]);if(0!==b)return b;const N=br(u[d[I]],h[_[I]]);if(0!==N)return N}return Ce(d.length,_.length)}(n.mapValue,e.mapValue);default:throw he()}}function Rc(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ce(n,e);const t=cr(n),r=cr(e),i=Ce(t.seconds,r.seconds);return 0!==i?i:Ce(t.nanos,r.nanos)}function fi(n){return Ws(n)}function Ws(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=cr(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Ir(n.bytesValue).toBase64():"referenceValue"in n?ne.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(const u of r.values||[])s?s=!1:i+=",",i+=Ws(u);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",u=!0;for(const d of i)u?u=!1:s+=",",s+=`${d}:${Ws(r.fields[d])}`;return s+"}"}(n.mapValue):he();var e}function pi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pu(n){return!!n&&"integerValue"in n}function mi(n){return!!n&&"arrayValue"in n}function Mc(n){return!!n&&"nullValue"in n}function Nc(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $s(n){return!!n&&"mapValue"in n}function qs(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ur(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=qs(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=qs(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Hs(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function hd(n){return"nullValue"in n?Wi:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?pi(lr.empty(),ne.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:he()}function fd(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?pi(lr.empty(),ne.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Er:he()}function Oc(n,e){const t=br(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Pc(n,e){const t=br(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!$s(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qs(t)}setAll(e){let t=bt.emptyPath(),r={},i=[];e.forEach((u,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=d.popLast()}u?r[d.lastSegment()]=qs(u):i.push(d.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());$s(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return er(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];$s(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ur(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new on(qs(this.value))}}function Lc(n){const e=[];return Ur(n.fields,(t,r)=>{const i=new bt([t]);if($s(r)){const s=Lc(r.mapValue).fields;if(0===s.length)e.push(i);else for(const u of s)e.push(i.child(u))}else e.push(i)}),new Cn(e)}class mt{constructor(e,t,r,i,s,u,d){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=u,this.documentState=d}static newInvalidDocument(e){return new mt(e,0,Ee.min(),Ee.min(),Ee.min(),on.empty(),0)}static newFoundDocument(e,t,r,i){return new mt(e,1,t,Ee.min(),r,i,0)}static newNoDocument(e,t){return new mt(e,2,t,Ee.min(),Ee.min(),on.empty(),0)}static newUnknownDocument(e,t){return new mt(e,3,t,Ee.min(),Ee.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ee.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Br{constructor(e,t){this.position=e,this.inclusive=t}}function Qo(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],u=n.position[i];if(r=s.field.isKeyField()?ne.comparator(ne.fromName(u.referenceValue),t.key):br(u,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Fc(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!er(n.position[t],e.position[t]))return!1;return!0}class qi{constructor(e,t="asc"){this.field=e,this.dir=t}}function pd(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Uc{}class Be extends Uc{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new yu(e,t,r):"array-contains"===t?new vu(e,r):"in"===t?new Kc(e,r):"not-in"===t?new Ef(e,r):"array-contains-any"===t?new Iu(e,r):new Be(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new md(e,r):new zc(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(br(t,this.value)):null!==t&&Vr(this.value)===Vr(t)&&this.matchesComparison(br(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class rt extends Uc{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new rt(e,t)}matches(e){return Hi(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Hi(n){return"and"===n.op}function mu(n){return"or"===n.op}function gu(n){return Vc(n)&&Hi(n)}function Vc(n){for(const e of n.filters)if(e instanceof rt)return!1;return!0}function _u(n){if(n instanceof Be)return n.field.canonicalString()+n.op.toString()+fi(n.value);if(gu(n))return n.filters.map(e=>_u(e)).join(",");{const e=n.filters.map(t=>_u(t)).join(",");return`${n.op}(${e})`}}function Yo(n,e){return n instanceof Be?(t=n,(r=e)instanceof Be&&t.op===r.op&&t.field.isEqual(r.field)&&er(t.value,r.value)):n instanceof rt?function(t,r){return r instanceof rt&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((i,s,u)=>i&&Yo(s,r.filters[u]),!0)}(n,e):void he();var t,r}function Xo(n,e){const t=n.filters.concat(e);return rt.create(t,n.op)}function Bc(n){return n instanceof Be?`${(e=n).field.canonicalString()} ${e.op} ${fi(e.value)}`:n instanceof rt?function(e){return e.op.toString()+" {"+e.getFilters().map(Bc).join(" ,")+"}"}(n):"Filter";var e}class yu extends Be{constructor(e,t,r){super(e,t,r),this.key=ne.fromName(r.referenceValue)}matches(e){const t=ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class md extends Be{constructor(e,t){super(e,"in",t),this.keys=Gc(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class zc extends Be{constructor(e,t){super(e,"not-in",t),this.keys=Gc(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Gc(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>ne.fromName(r.referenceValue))}class vu extends Be{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mi(t)&&$i(t.arrayValue,this.value)}}class Kc extends Be{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&$i(this.value.arrayValue,t)}}class Ef extends Be{constructor(e,t){super(e,"not-in",t)}matches(e){if($i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!$i(this.value.arrayValue,t)}}class Iu extends Be{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>$i(this.value.arrayValue,r))}}class jc{constructor(e,t=null,r=[],i=[],s=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=u,this.endAt=d,this.dt=null}}function Zi(n,e=null,t=[],r=[],i=null,s=null,u=null){return new jc(n,e,t,r,i,s,u)}function zr(n){const e=se(n);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_u(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),Gs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>fi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>fi(r)).join(",")),e.dt=t}return e.dt}function Qi(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pd(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Yo(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Fc(n.startAt,e.startAt)&&Fc(n.endAt,e.endAt)}function Jo(n){return ne.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function ea(n,e){return n.filters.filter(t=>t instanceof Be&&t.field.isEqual(e))}function Wc(n,e,t){let r=Wi,i=!0;for(const s of ea(n,e)){let u=Wi,d=!0;switch(s.op){case"<":case"<=":u=hd(s.value);break;case"==":case"in":case">=":u=s.value;break;case">":u=s.value,d=!1;break;case"!=":case"not-in":u=Wi}Oc({value:r,inclusive:i},{value:u,inclusive:d})<0&&(r=u,i=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];Oc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}function $c(n,e,t){let r=Er,i=!0;for(const s of ea(n,e)){let u=Er,d=!0;switch(s.op){case">=":case">":u=fd(s.value),d=!1;break;case"==":case"in":case"<=":u=s.value;break;case"<":u=s.value,d=!1;break;case"!=":case"not-in":u=Er}Pc({value:r,inclusive:i},{value:u,inclusive:d})>0&&(r=u,i=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];Pc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}class wr{constructor(e,t=null,r=[],i=[],s=null,u="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=u,this.startAt=d,this.endAt=h,this.wt=null,this._t=null}}function Eu(n,e,t,r,i,s,u,d){return new wr(n,e,t,r,i,s,u,d)}function Yi(n){return new wr(n)}function gd(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Tr(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function ta(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function bu(n){return null!==n.collectionGroup}function Ar(n){const e=se(n);if(null===e.wt){e.wt=[];const t=ta(e),r=Tr(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new qi(t)),e.wt.push(new qi(bt.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new qi(bt.keyField(),s))}}}return e.wt}function vn(n){const e=se(n);if(!e._t)if("F"===e.limitType)e._t=Zi(e.path,e.collectionGroup,Ar(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Ar(e))t.push(new qi(s.field,"desc"===s.dir?"asc":"desc"));const r=e.endAt?new Br(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Br(e.startAt.position,e.startAt.inclusive):null;e._t=Zi(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e._t}function Zs(n,e){e.getFirstInequalityField(),ta(n);const t=n.filters.concat([e]);return new wr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function na(n,e,t){return new wr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qs(n,e){return Qi(vn(n),vn(e))&&n.limitType===e.limitType}function ra(n){return`${zr(vn(n))}|lt:${n.limitType}`}function wu(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>Bc(r)).join(", ")}]`),Gs(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>fi(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>fi(r)).join(",")),`Target(${t})`}(vn(n))}; limitType=${n.limitType})`}function Ys(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):ne.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of Ar(t))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,s,u){const d=Qo(i,s,u);return i.inclusive?d<=0:d<0}(t.startAt,Ar(t),r)||t.endAt&&!function(i,s,u){const d=Qo(i,s,u);return i.inclusive?d>=0:d>0}(t.endAt,Ar(t),r)));var t,r}function ia(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function qc(n){return(e,t)=>{let r=!1;for(const i of Ar(n)){const s=_d(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function _d(n,e,t){const r=n.field.isKeyField()?ne.comparator(e.key,t.key):function(i,s,u){const d=s.data.field(i),h=u.data.field(i);return null!==d&&null!==h?br(d,h):he()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}class Sr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ur(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return $o(this.inner)}size(){return this.innerSize}}const yd=new ot(ne.comparator);function kn(){return yd}const Tu=new ot(ne.comparator);function gi(...n){let e=Tu;for(const t of n)e=e.insert(t.key,t);return e}function Hc(n){let e=Tu;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function dr(){return _i()}function sa(){return _i()}function _i(){return new Sr(n=>n.toString(),(n,e)=>n.isEqual(e))}const vd=new ot(ne.comparator),Id=new lt(ne.comparator);function ke(...n){let e=Id;for(const t of n)e=e.add(t);return e}const Ed=new lt(Ce);function Au(){return Ed}function Zc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ks(e)?"-0":e}}function Su(n){return{integerValue:""+n}}function Qc(n,e){return Ac(e)?Su(e):Zc(n,e)}class oa{constructor(){this._=void 0}}function bd(n,e,t){return n instanceof Ji?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&ji(i)&&(i=qo(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):n instanceof Gr?Yc(n,e):n instanceof yi?Xc(n,e):function(r,i){const s=Xi(r,i),u=xu(s)+xu(r.gt);return pu(s)&&pu(r.gt)?Su(u):Zc(r.serializer,u)}(n,e)}function wd(n,e,t){return n instanceof Gr?Yc(n,e):n instanceof yi?Xc(n,e):t}function Xi(n,e){return n instanceof es?pu(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Ji extends oa{}class Gr extends oa{constructor(e){super(),this.elements=e}}function Yc(n,e){const t=aa(e);for(const r of n.elements)t.some(i=>er(i,r))||t.push(r);return{arrayValue:{values:t}}}class yi extends oa{constructor(e){super(),this.elements=e}}function Xc(n,e){let t=aa(e);for(const r of n.elements)t=t.filter(i=>!er(i,r));return{arrayValue:{values:t}}}class es extends oa{constructor(e,t){super(),this.serializer=e,this.gt=t}}function xu(n){return kt(n.integerValue||n.doubleValue)}function aa(n){return mi(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vi{constructor(e,t){this.field=e,this.transform=t}}class Td{constructor(e,t){this.version=e,this.transformResults=t}}class ft{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ft}static exists(e){return new ft(void 0,e)}static updateTime(e){return new ft(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ua(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class ln{}function ts(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new rs(n.key,ft.none()):new ns(n.key,n.data,ft.none());{const t=n.data,r=on.empty();let i=new lt(bt.comparator);for(let s of e.fields)if(!i.has(s)){let u=t.field(s);null===u&&s.length>1&&(s=s.popLast(),u=t.field(s)),null===u?r.delete(s):r.set(s,u),i=i.add(s)}return new hr(n.key,r,new Cn(i.toArray()),ft.none())}}function el(n,e,t){n instanceof ns?function(r,i,s){const u=r.value.clone(),d=xr(r.fieldTransforms,i,s.transformResults);u.setAll(d),i.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):n instanceof hr?function(r,i,s){if(!ua(r.precondition,i))return void i.convertToUnknownDocument(s.version);const u=xr(r.fieldTransforms,i,s.transformResults),d=i.data;d.setAll(tl(r)),d.setAll(u),i.convertToFoundDocument(s.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Xs(n,e,t,r){return n instanceof ns?function(i,s,u,d){if(!ua(i.precondition,s))return u;const h=i.value.clone(),_=ku(i.fieldTransforms,d,s);return h.setAll(_),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof hr?function(i,s,u,d){if(!ua(i.precondition,s))return u;const h=ku(i.fieldTransforms,d,s),_=s.data;return _.setAll(tl(i)),_.setAll(h),s.convertToFoundDocument(s.version,_).setHasLocalMutations(),null===u?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(I=>I.field))}(n,e,t,r):(u=t,ua(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):u);var s,u}function Cu(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Xi(r.transform,i||null);null!=s&&(null===t&&(t=on.empty()),t.set(r.field,s))}return t||null}function ca(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Bi(t,r,(i,s)=>function Jc(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Gr&&r instanceof Gr||t instanceof yi&&r instanceof yi?Bi(t.elements,r.elements,er):t instanceof es&&r instanceof es?er(t.gt,r.gt):t instanceof Ji&&r instanceof Ji);var t,r}(i,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class ns extends ln{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class hr extends ln{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function tl(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function xr(n,e,t){const r=new Map;ve(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],u=s.transform,d=e.data.field(s.field);r.set(s.field,wd(u,d,t[i]))}return r}function ku(n,e,t){const r=new Map;for(const i of n){const s=i.transform,u=t.data.field(i.field);r.set(i.field,bd(s,u,e))}return r}class rs extends ln{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Du extends ln{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ru{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&el(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Xs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Xs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sa();return this.mutations.forEach(i=>{const s=e.get(i.key),u=s.overlayedDocument;let d=this.applyToLocalView(u,s.mutatedFields);d=t.has(i.key)?null:d;const h=ts(u,d);null!==h&&r.set(i.key,h),u.isValidDocument()||u.convertToNoDocument(Ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ke())}isEqual(e){return this.batchId===e.batchId&&Bi(this.mutations,e.mutations,(t,r)=>ca(t,r))&&Bi(this.baseMutations,e.baseMutations,(t,r)=>ca(t,r))}}class la{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ve(e.mutations.length===r.length);let i=vd;const s=e.mutations;for(let u=0;u<s.length;u++)i=i.insert(s[u].key,r[u].version);return new la(e,t,r,i)}}class dn{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Mu{constructor(e,t,r){this.alias=e,this.yt=t,this.fieldPath=r}}class Nu{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ut,Me;function is(n){switch(n){default:return he();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function Ou(n){if(void 0===n)return Lt("GRPC error has no .code"),L.UNKNOWN;switch(n){case Ut.OK:return L.OK;case Ut.CANCELLED:return L.CANCELLED;case Ut.UNKNOWN:return L.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return L.INTERNAL;case Ut.UNAVAILABLE:return L.UNAVAILABLE;case Ut.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Ut.NOT_FOUND:return L.NOT_FOUND;case Ut.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Ut.ABORTED:return L.ABORTED;case Ut.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Ut.DATA_LOSS:return L.DATA_LOSS;default:return he()}}(Me=Ut||(Ut={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";class da{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ha}static getOrCreateInstance(){return null===ha&&(ha=new da),ha}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let ha=null;function fa(){return new TextEncoder}const Ad=new Vs([4294967295,4294967295],0);function nl(n){const e=fa().encode(n),t=new _f;return t.update(e),new Uint8Array(t.digest())}function rl(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Vs([t,r],0),new Vs([i,s],0)]}class Pu{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new c(`Invalid padding: ${t}`);if(r<0)throw new c(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new c(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new c(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Vs.fromNumber(this.It)}Et(e,t,r){let i=e.add(t.multiply(Vs.fromNumber(r)));return 1===i.compare(Ad)&&(i=new Vs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=nl(e),[r,i]=rl(t);for(let s=0;s<this.hashCount;s++){const u=this.Et(r,i,s);if(!this.At(u))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),u=new Pu(s,i,t);return r.forEach(d=>u.insert(d)),u}insert(e){if(0===this.It)return;const t=nl(e),[r,i]=rl(t);for(let s=0;s<this.hashCount;s++){const u=this.Et(r,i,s);this.Rt(u)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class c extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class o{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,a.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new o(Ee.min(),i,new ot(Ce),kn(),ke())}}class a{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new a(r,t,ke(),ke(),ke())}}class l{constructor(e,t,r,i){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=i}}class m{constructor(e,t){this.targetId=e,this.Vt=t}}class v{constructor(e,t,r=jt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class w{constructor(){this.St=0,this.Dt=ee(),this.Ct=jt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=ke(),t=ke(),r=ke();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:he()}}),new a(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=ee()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class R{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=kn(),this.zt=q(),this.Wt=new ot(Ce)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:he()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,i)=>{this.te(i)&&t(i)})}ne(e){var t;const r=e.targetId,i=e.Vt.count,s=this.se(r);if(s){const u=s.target;if(Jo(u))if(0===i){const d=new ne(u.path);this.Yt(r,d,mt.newNoDocument(d,Ee.min()))}else ve(1===i);else{const d=this.ie(r);if(d!==i){const h=this.re(e,d);0!==h&&(this.ee(r),this.Wt=this.Wt.insert(r,2===h?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=da.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(_,I,b){var N,z,X,de,pe,Le;const Ye={localCacheCount:I,existenceFilterCount:b.count},Ve=b.unchangedNames;return Ve&&(Ye.bloomFilter={applied:0===_,hashCount:null!==(N=Ve?.hashCount)&&void 0!==N?N:0,bitmapLength:null!==(de=null===(X=null===(z=Ve?.bits)||void 0===z?void 0:z.bitmap)||void 0===X?void 0:X.length)&&void 0!==de?de:0,padding:null!==(Le=null===(pe=Ve?.bits)||void 0===pe?void 0:pe.padding)&&void 0!==Le?Le:0}),Ye}(h,d,e.Vt))}}}}re(e,t){const{unchangedNames:r,count:i}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:s="",padding:u=0},hashCount:d=0}=r;let h,_;try{h=Ir(s).toUint8Array()}catch(I){if(I instanceof Dc)return jn("Decoding the base64 bloom filter in existence filter failed ("+I.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw I}try{_=new Pu(h,u,d)}catch(I){return jn(I instanceof c?"BloomFilter error: ":"Applying bloom filter failed: ",I),1}return 0===_.It?1:i!==t-this.oe(e.targetId,_)?2:0}oe(e,t){const r=this.Gt.getRemoteKeysForTarget(e);let i=0;return r.forEach(s=>{const u=this.Gt.ue(),d=`projects/${u.projectId}/databases/${u.database}/documents/${s.path.canonicalString()}`;t.vt(d)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,u)=>{const d=this.se(u);if(d){if(s.current&&Jo(d.target)){const h=new ne(d.target.path);null!==this.jt.get(h)||this.ae(u,h)||this.Yt(u,h,mt.newNoDocument(h,e))}s.Mt&&(t.set(u,s.Ot()),s.Ft())}});let r=ke();this.zt.forEach((s,u)=>{let d=!0;u.forEachWhile(h=>{const _=this.se(h);return!_||"TargetPurposeLimboResolution"===_.purpose||(d=!1,!1)}),d&&(r=r.add(s))}),this.jt.forEach((s,u)=>u.setReadTime(e));const i=new o(e,t,this.Wt,this.jt,r);return this.jt=kn(),this.zt=q(),this.Wt=new ot(Ce),i}Jt(e,t){if(!this.te(e))return;const r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new w,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new lt(Ce),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Q("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new w),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function q(){return new ot(ne.comparator)}function ee(){return new ot(ne.comparator)}const fe={asc:"ASCENDING",desc:"DESCENDING"},ge={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wt={and:"AND",or:"OR"};class tr{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ss(n,e){return n.useProto3Json||Gs(e)?e:{value:e}}function Ii(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pa(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function il(n,e){return Ii(n,e.toTimestamp())}function Dt(n){return ve(!!n),Ee.fromTimestamp(function(e){const t=cr(e);return new vt(t.seconds,t.nanos)}(n))}function Js(n,e){return(t=n,new We(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function Lu(n){const e=We.fromString(n);return ve(Cf(e)),e}function os(n,e){return Js(n.databaseId,e.path)}function Wn(n,e){const t=Lu(e);if(t.get(1)!==n.databaseId.projectId)throw new $(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new $(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(ol(t))}function ma(n,e){return Js(n.databaseId,e)}function sl(n){const e=Lu(n);return 4===e.length?We.emptyPath():ol(e)}function Ei(n){return new We(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ol(n){return ve(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function bf(n,e,t){return{name:os(n,e),fields:t.value.mapValue.fields}}function wf(n,e,t){const r=Wn(n,e.name),i=Dt(e.updateTime),s=e.createTime?Dt(e.createTime):Ee.min(),u=new on({mapValue:{fields:e.fields}}),d=mt.newFoundDocument(r,i,s,u);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function Fu(n,e){let t;if(e instanceof ns)t={update:bf(n,e.key,e.value)};else if(e instanceof rs)t={delete:os(n,e.key)};else if(e instanceof hr)t={update:bf(n,e.key,e.data),updateMask:Am(e.fieldMask)};else{if(!(e instanceof Du))return he();t={verify:os(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const u=s.transform;if(u instanceof Ji)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Gr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof yi)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof es)return{fieldPath:s.field.canonicalString(),increment:u.gt};throw he()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:il(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:he()),t;var i}function Sd(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?ft.updateTime(Dt(i.updateTime)):void 0!==i.exists?ft.exists(i.exists):ft.none():ft.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,u){let d=null;"setToServerValue"in u?(ve("REQUEST_TIME"===u.setToServerValue),d=new Ji):"appendMissingElements"in u?d=new Gr(u.appendMissingElements.values||[]):"removeAllFromArray"in u?d=new yi(u.removeAllFromArray.values||[]):"increment"in u?d=new es(s,u.increment):he();const h=bt.fromServerFormat(u.fieldPath);return new vi(h,d)}(n,i)):[];var i;if(e.update){const i=Wn(n,e.update.name),s=new on({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=new Cn((e.updateMask.fieldPaths||[]).map(_=>bt.fromServerFormat(_)));return new hr(i,s,u,t,r)}return new ns(i,s,t,r)}if(e.delete){const i=Wn(n,e.delete);return new rs(i,t)}if(e.verify){const i=Wn(n,e.verify);return new Du(i,t)}return he()}function Tf(n,e){return{documents:[ma(n,e.path)]}}function xd(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=ma(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=ma(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(0!==h.length)return xf(rt.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(0!==h.length)return h.map(_=>{return{field:as((I=_).field),direction:bm(I.dir)};var I})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const u=ss(n,e.limit);var d,h;return null!==u&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(h=e.endAt).inclusive,values:h.position}),t}function Af(n){let e=sl(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ve(1===r);const I=t.from[0];I.allDescendants?i=I.collectionId:e=e.child(I.collectionId)}let s=[];t.where&&(s=function(I){const b=Sf(I);return b instanceof rt&&gu(b)?b.getFilters():[b]}(t.where));let u=[];t.orderBy&&(u=t.orderBy.map(I=>{return new qi(ga((b=I).field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction));var b}));let d=null;t.limit&&(d=function(I){let b;return b="object"==typeof I?I.value:I,Gs(b)?null:b}(t.limit));let h=null;var I;t.startAt&&(h=new Br((I=t.startAt).values||[],!!I.before));let _=null;return t.endAt&&(_=function(I){return new Br(I.values||[],!I.before)}(t.endAt)),Eu(e,i,u,s,d,"F",h,_)}function Sf(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ga(e.unaryFilter.field);return Be.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=ga(e.unaryFilter.field);return Be.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ga(e.unaryFilter.field);return Be.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ga(e.unaryFilter.field);return Be.create(s,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(n):void 0!==n.fieldFilter?Be.create(ga((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return rt.create(e.compositeFilter.filters.map(t=>Sf(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return he()}}(e.compositeFilter.op))}(n):he();var e}function bm(n){return fe[n]}function wm(n){return ge[n]}function Tm(n){return wt[n]}function as(n){return{fieldPath:n.canonicalString()}}function ga(n){return bt.fromServerFormat(n.fieldPath)}function xf(n){return n instanceof Be?function(e){if("=="===e.op){if(Nc(e.value))return{unaryFilter:{field:as(e.field),op:"IS_NAN"}};if(Mc(e.value))return{unaryFilter:{field:as(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Nc(e.value))return{unaryFilter:{field:as(e.field),op:"IS_NOT_NAN"}};if(Mc(e.value))return{unaryFilter:{field:as(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:as(e.field),op:wm(e.op),value:e.value}}}(n):n instanceof rt?function(e){const t=e.getFilters().map(r=>xf(r));return 1===t.length?t[0]:{compositeFilter:{op:Tm(e.op),filters:t}}}(n):he()}function Am(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Cf(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class bi{constructor(e,t,r,i,s=Ee.min(),u=Ee.min(),d=jt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class kf{constructor(e){this.fe=e}}function Df(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:al(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:os(i=n.fe,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:Ii(i,s.version.toTimestamp()),createTime:Ii(i,s.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:eo(e.version)};else{if(!e.isUnknownDocument())return he();r.unknownDocument={path:t.path.toArray(),version:eo(e.version)}}var i,s;return r}function al(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function eo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function to(n){const e=new vt(n.seconds,n.nanoseconds);return Ee.fromTimestamp(e)}function no(n,e){const t=(e.baseMutations||[]).map(s=>Sd(n.fe,s));for(let s=0;s<e.mutations.length-1;++s){const u=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(u.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const r=e.mutations.map(s=>Sd(n.fe,s)),i=vt.fromMillis(e.localWriteTimeMs);return new Ru(e.batchId,i,t,r)}function Uu(n){const e=to(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?to(n.lastLimboFreeSnapshotVersion):Ee.min();let r;var i;return void 0!==n.query.documents?(ve(1===(i=n.query).documents.length),r=vn(Yi(sl(i.documents[0])))):r=vn(Af(n.query)),new bi(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,jt.fromBase64String(n.resumeToken))}function Rf(n,e){const t=eo(e.snapshotVersion),r=eo(e.lastLimboFreeSnapshotVersion);let i;i=Jo(e.target)?Tf(n.fe,e.target):xd(n.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:zr(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Cd(n){const e=Af({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?na(e,e.limit,"L"):e}function kd(n,e){return new dn(e.largestBatchId,Sd(n.fe,e.overlayMutation))}function Mf(n,e){const t=e.path.lastSegment();return[n,Xt(e.path.popLast()),t]}function Nf(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:eo(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}class xm{getBundleMetadata(e,t){return Of(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:to(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return Of(e).put({bundleId:(r=t).id,createTime:eo(Dt(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Pf(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Cd(i.bundledQuery),readTime:to(i.readTime)};var i})}saveNamedQuery(e,t){return Pf(e).put({name:(r=t).name,readTime:eo(Dt(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Of(n){return Ct(n,"bundles")}function Pf(n){return Ct(n,"namedQueries")}class ul{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new ul(e,t.uid||"")}getOverlay(e,t){return Vu(e).get(Mf(this.userId,t)).next(r=>r?kd(this.serializer,r):null)}getOverlays(e,t){const r=dr();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,u)=>{const d=new dn(t,u);i.push(this.we(e,d))}),O.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(u=>i.add(Xt(u.getCollectionPath())));const s=[];return i.forEach(u=>{const d=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);s.push(Vu(e).J("collectionPathOverlayIndex",d))}),O.waitFor(s)}getOverlaysForCollection(e,t,r){const i=dr(),s=Xt(t),u=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Vu(e).j("collectionPathOverlayIndex",u).next(d=>{for(const h of d){const _=kd(this.serializer,h);i.set(_.getKey(),_)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=dr();let u;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Vu(e).X({index:"collectionGroupOverlayIndex",range:d},(h,_,I)=>{const b=kd(this.serializer,_);s.size()<i||b.largestBatchId===u?(s.set(b.getKey(),b),u=b.largestBatchId):I.done()}).next(()=>s)}we(e,t){return Vu(e).put(function(r,i,s){const[u,d,h]=Mf(i,s.mutation.key);return{userId:i,collectionPath:d,documentId:h,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Fu(r.fe,s.mutation)}}(this.serializer,this.userId,t))}}function Vu(n){return Ct(n,"documentOverlays")}class ro{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(kt(e.integerValue));else if("doubleValue"in e){const r=kt(e.doubleValue);isNaN(r)?this.ye(t,13):(this.ye(t,15),Ks(r)?t.pe(0):t.pe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie(`${r.seconds||""}`),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Ir(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ye(t,45),t.pe(r.latitude||0),t.pe(r.longitude||0)}else"mapValue"in e?Hs(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):he()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const r=e.fields||{};this.ye(t,55);for(const i of Object.keys(r))this.Te(i,t),this.me(r[i],t)}Pe(e,t){const r=e.values||[];this.ye(t,50);for(const i of r)this.me(i,t)}ve(e,t){this.ye(t,37),ne.fromName(e).path.forEach(r=>{this.ye(t,60),this.be(r,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function Cm(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function Lf(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const s=Cm(255&t[i]);if(r+=s,8!==s)break}return r}(n);return Math.ceil(e/8)}ro.Ve=new ro;class km{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.De(r.value),r=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ne(r.value),r=t.next();this.ke()}Me(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const i=t.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const i=t.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(e){const t=this.Fe(e),r=Lf(t);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Le(e){const t=this.Fe(e),r=Lf(t);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Dm{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Rm{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Bu{constructor(){this.je=new km,this.ze=new Dm(this.je),this.We=new Rm(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class io{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new io(this.indexId,this.documentKey,this.arrayValue,r)}}function us(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Ff(n.arrayValue,e.arrayValue),0!==t?t:(t=Ff(n.directionalValue,e.directionalValue),0!==t?t:ne.comparator(n.documentKey,e.documentKey)))}function Ff(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Mm{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const r=t;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){ve(e.collectionGroup===this.collectionId);const t=Ja(e);if(void 0!==t&&!this.en(t))return!1;const r=vr(e);let i=0,s=0;for(;i<r.length&&this.en(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ze){const u=r[i];if(!this.nn(this.Ze,u)||!this.sn(this.Ye[s++],u))return!1;++i}for(;i<r.length;++i){const u=r[i];if(s>=this.Ye.length||!this.sn(this.Ye[s++],u))return!1}return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Uf(n){var e,t;if(ve(n instanceof Be||n instanceof rt),n instanceof Be){if(n instanceof Kc){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Be.create(n.field,"==",s)))||[];return rt.create(i,"or")}return n}const r=n.filters.map(i=>Uf(i));return rt.create(r,n.op)}function Nm(n){if(0===n.getFilters().length)return[];const e=Md(Uf(n));return ve(Vf(e)),Dd(e)||Rd(e)?[e]:e.getFilters()}function Dd(n){return n instanceof Be}function Rd(n){return n instanceof rt&&gu(n)}function Vf(n){return Dd(n)||Rd(n)||function(e){if(e instanceof rt&&mu(e)){for(const t of e.getFilters())if(!Dd(t)&&!Rd(t))return!1;return!0}return!1}(n)}function Md(n){if(ve(n instanceof Be||n instanceof rt),n instanceof Be)return n;if(1===n.filters.length)return Md(n.filters[0]);const e=n.filters.map(r=>Md(r));let t=rt.create(e,n.op);return t=cl(t),Vf(t)?t:(ve(t instanceof rt),ve(Hi(t)),ve(t.filters.length>1),t.filters.reduce((r,i)=>Nd(r,i)))}function Nd(n,e){let t;return ve(n instanceof Be||n instanceof rt),ve(e instanceof Be||e instanceof rt),t=n instanceof Be?e instanceof Be?rt.create([n,e],"and"):Bf(n,e):e instanceof Be?Bf(e,n):function(r,i){if(ve(r.filters.length>0&&i.filters.length>0),Hi(r)&&Hi(i))return Xo(r,i.getFilters());const s=mu(r)?r:i,u=mu(r)?i:r,d=s.filters.map(h=>Nd(h,u));return rt.create(d,"or")}(n,e),cl(t)}function Bf(n,e){if(Hi(e))return Xo(e,n.getFilters());{const t=e.filters.map(r=>Nd(n,r));return rt.create(t,"or")}}function cl(n){if(ve(n instanceof Be||n instanceof rt),n instanceof Be)return n;const e=n.getFilters();if(1===e.length)return cl(e[0]);if(Vc(n))return n;const t=e.map(i=>cl(i)),r=[];return t.forEach(i=>{i instanceof Be?r.push(i):i instanceof rt&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:rt.create(r,n.op)}class Om{constructor(){this.rn=new Od}addToCollectionParentIndex(e,t){return this.rn.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(Ln.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(Ln.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class Od{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new lt(We.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new lt(We.comparator)).toArray()}}const ll=new Uint8Array(0);class Pm{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Od,this.un=new Sr(r=>zr(r),(r,i)=>Qi(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const s={collectionId:r,parent:Xt(i)};return zf(e).put(s)}return O.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Fo(t),""],!1,!0);return zf(e).j(i).next(s=>{for(const u of s){if(u.collectionId!==t)break;r.push(ur(u.parent))}return r})}addFieldIndex(e,t){const r=dl(e),i={indexId:(u=t).indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])};var u;delete i.indexId;const s=r.add(i);if(t.indexState){const u=Gu(e);return s.next(d=>{u.put(Nf(d,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=dl(e),i=Gu(e),s=zu(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=zu(e);let i=!0;const s=new Map;return O.forEach(this.cn(t),u=>this.an(e,u).next(d=>{i&&(i=!!d),s.set(u,d)})).next(()=>{if(i){let u=ke();const d=[];return O.forEach(s,(h,_)=>{var I;Q("IndexedDbIndexManager",`Using index ${I=h,`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(Ve=>`${Ve.fieldPath}:${Ve.kind}`).join(",")}`} to execute ${zr(t)}`);const b=function(Ve,an){const Jt=Ja(an);if(void 0===Jt)return null;for(const At of ea(Ve,Jt.fieldPath))switch(At.op){case"array-contains-any":return At.value.arrayValue.values||[];case"array-contains":return[At.value]}return null}(_,h),N=function(Ve,an){const Jt=new Map;for(const At of vr(an))for(const $n of ea(Ve,At.fieldPath))switch($n.op){case"==":case"in":Jt.set(At.fieldPath.canonicalString(),$n.value);break;case"not-in":case"!=":return Jt.set(At.fieldPath.canonicalString(),$n.value),Array.from(Jt.values())}return null}(_,h),z=function(Ve,an){const Jt=[];let At=!0;for(const $n of vr(an)){const po=0===$n.kind?Wc(Ve,$n.fieldPath,Ve.startAt):$c(Ve,$n.fieldPath,Ve.startAt);Jt.push(po.value),At&&(At=po.inclusive)}return new Br(Jt,At)}(_,h),X=function(Ve,an){const Jt=[];let At=!0;for(const $n of vr(an)){const po=0===$n.kind?$c(Ve,$n.fieldPath,Ve.endAt):Wc(Ve,$n.fieldPath,Ve.endAt);Jt.push(po.value),At&&(At=po.inclusive)}return new Br(Jt,At)}(_,h),de=this.hn(h,_,z),pe=this.hn(h,_,X),Le=this.ln(h,_,N),Ye=this.fn(h.indexId,b,de,z.inclusive,pe,X.inclusive,Le);return O.forEach(Ye,Ve=>r.H(Ve,t.limit).next(an=>{an.forEach(Jt=>{const At=ne.fromSegments(Jt.documentKey);u.has(At)||(u=u.add(At),d.push(At))})}))}).next(()=>d)}return O.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Nm(rt.create(e.filters,"and")).map(r=>Zi(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,r,i,s,u,d){const h=(null!=t?t.length:1)*Math.max(r.length,s.length),_=h/(null!=t?t.length:1),I=[];for(let b=0;b<h;++b){const N=t?this.dn(t[b/_]):ll,z=this.wn(e,N,r[b%_],i),X=this._n(e,N,s[b%_],u),de=d.map(pe=>this.wn(e,N,pe,!0));I.push(...this.createRange(z,X,de))}return I}wn(e,t,r,i){const s=new io(e,ne.empty(),t,r);return i?s:s.Je()}_n(e,t,r,i){const s=new io(e,ne.empty(),t,r);return i?s.Je():s}an(e,t){const r=new Mm(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let u=null;for(const d of s)r.tn(d)&&(!u||d.fields.length>u.fields.length)&&(u=d);return u})}getIndexType(e,t){let r=2;const i=this.cn(t);return O.forEach(i,s=>this.an(e,s).next(u=>{u?0!==r&&u.fields.length<function(d){let h=new lt(bt.comparator),_=!1;for(const I of d.filters)for(const b of I.getFlattenedFilters())b.field.isKeyField()||("array-contains"===b.op||"array-contains-any"===b.op?_=!0:h=h.add(b.field));for(const I of d.orderBy)I.field.isKeyField()||(h=h.add(I.field));return h.size+(_?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}mn(e,t){const r=new Bu;for(const i of vr(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const u=r.He(i.kind);ro.Ve._e(s,u)}return r.Qe()}dn(e){const t=new Bu;return ro.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const r=new Bu;return ro.Ve._e(pi(this.databaseId,t),r.He(function(i){const s=vr(i);return 0===s.length?0:s[s.length-1].kind}(e))),r.Qe()}ln(e,t,r){if(null===r)return[];let i=[];i.push(new Bu);let s=0;for(const u of vr(e)){const d=r[s++];for(const h of i)if(this.yn(t,u.fieldPath)&&mi(d))i=this.pn(i,u,d);else{const _=h.He(u.kind);ro.Ve._e(d,_)}}return this.In(i)}hn(e,t,r){return this.ln(e,t,r.position)}In(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Qe();return t}pn(e,t,r){const i=[...e],s=[];for(const u of r.arrayValue.values||[])for(const d of i){const h=new Bu;h.seed(d.Qe()),ro.Ve._e(u,h.He(t.kind)),s.push(h)}return s}yn(e,t){return!!e.filters.find(r=>r instanceof Be&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=dl(e),i=Gu(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next(s=>{const u=[];return O.forEach(s,d=>i.get([d.indexId,this.uid]).next(h=>{u.push(function(_,I){const b=I?new ai(I.sequenceNumber,new Ln(to(I.readTime),new ne(ur(I.documentKey)),I.largestBatchId)):ai.empty(),N=_.fields.map(([z,X])=>new Gi(bt.fromServerFormat(z),X));return new oi(_.indexId,_.collectionGroup,N,b)}(d,h))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ce(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=dl(e),s=Gu(e);return this.Tn(e).next(u=>i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(d=>O.forEach(d,h=>s.put(Nf(h.indexId,this.user,u,r)))))}updateIndexEntries(e,t){const r=new Map;return O.forEach(t,(i,s)=>{const u=r.get(i.collectionGroup);return(u?O.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(d=>(r.set(i.collectionGroup,d),O.forEach(d,h=>this.En(e,i,h).next(_=>{const I=this.An(s,h);return _.isEqual(I)?O.resolve():this.vn(e,s,h,_,I)}))))})}Rn(e,t,r,i){return zu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,r,i){return zu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}En(e,t,r){const i=zu(e);let s=new lt(us);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(u,d)=>{s=s.add(new io(r.indexId,t,d.arrayValue,d.directionalValue))}).next(()=>s)}An(e,t){let r=new lt(us);const i=this.mn(t,e);if(null==i)return r;const s=Ja(t);if(null!=s){const u=e.data.field(s.fieldPath);if(mi(u))for(const d of u.arrayValue.values||[])r=r.add(new io(t.indexId,e.key,this.dn(d),i))}else r=r.add(new io(t.indexId,e.key,ll,i));return r}vn(e,t,r,i,s){Q("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const u=[];return function(d,h,_,I,b){const N=d.getIterator(),z=h.getIterator();let X=di(N),de=di(z);for(;X||de;){let pe=!1,Le=!1;if(X&&de){const Ye=_(X,de);Ye<0?Le=!0:Ye>0&&(pe=!0)}else null!=X?Le=!0:pe=!0;pe?(I(de),de=di(z)):Le?(b(X),X=di(N)):(X=di(N),de=di(z))}}(i,s,us,d=>{u.push(this.Rn(e,t,r,d))},d=>{u.push(this.Pn(e,t,r,d))}),O.waitFor(u)}Tn(e){let t=1;return Gu(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((u,d)=>us(u,d)).filter((u,d,h)=>!d||0!==us(u,h[d-1]));const i=[];i.push(e);for(const u of r){const d=us(u,e),h=us(u,t);if(0===d)i[0]=e.Je();else if(d>0&&h<0)i.push(u),i.push(u.Je());else if(h>0)break}i.push(t);const s=[];for(let u=0;u<i.length;u+=2){if(this.bn(i[u],i[u+1]))return[];s.push(IDBKeyRange.bound([i[u].indexId,this.uid,i[u].arrayValue,i[u].directionalValue,ll,[]],[i[u+1].indexId,this.uid,i[u+1].arrayValue,i[u+1].directionalValue,ll,[]]))}return s}bn(e,t){return us(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Gf)}getMinOffset(e,t){return O.mapArray(this.cn(t),r=>this.an(e,r).next(i=>i||he())).next(Gf)}}function zf(n){return Ct(n,"collectionParents")}function zu(n){return Ct(n,"indexEntries")}function dl(n){return Ct(n,"indexConfiguration")}function Gu(n){return Ct(n,"indexState")}function Gf(n){ve(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;bc(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ln(e.readTime,e.documentKey,t)}const Kf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Dn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Dn(e,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function jf(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],u=IDBKeyRange.only(t.batchId);let d=0;const h=r.X({range:u},(I,b,N)=>(d++,N.delete()));s.push(h.next(()=>{ve(1===d)}));const _=[];for(const I of t.mutations){const b=Ko(e,I.key.path,t.batchId);s.push(i.delete(b)),_.push(I.key)}return O.waitFor(s).next(()=>_)}function hl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw he();e=n.noDocument}return JSON.stringify(e).length}Dn.DEFAULT_COLLECTION_PERCENTILE=10,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dn.DEFAULT=new Dn(41943040,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dn.DISABLED=new Dn(-1,0,0);class fl{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(e,t,r,i){ve(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new fl(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cs(e).X({index:"userMutationsIndex",range:r},(i,s,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=_a(e),u=cs(e);return u.add({}).next(d=>{ve("number"==typeof d);const h=new Ru(d,t,r,i),_=function(N,z,X){const de=X.baseMutations.map(Le=>Fu(N.fe,Le)),pe=X.mutations.map(Le=>Fu(N.fe,Le));return{userId:z,batchId:X.batchId,localWriteTimeMs:X.localWriteTime.toMillis(),baseMutations:de,mutations:pe}}(this.serializer,this.userId,h),I=[];let b=new lt((N,z)=>Ce(N.canonicalString(),z.canonicalString()));for(const N of i){const z=Ko(this.userId,N.key.path,d);b=b.add(N.key.path.popLast()),I.push(u.put(_)),I.push(s.put(z,jo))}return b.forEach(N=>{I.push(this.indexManager.addToCollectionParentIndex(e,N))}),e.addOnCommittedListener(()=>{this.Vn[d]=h.keys()}),O.waitFor(I).next(()=>h)})}lookupMutationBatch(e,t){return cs(e).get(t).next(r=>r?(ve(r.userId===this.userId),no(this.serializer,r)):null)}Sn(e,t){return this.Vn[t]?O.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Vn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return cs(e).X({index:"userMutationsIndex",range:i},(u,d,h)=>{d.userId===this.userId&&(ve(d.batchId>=r),s=no(this.serializer,d)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return cs(e).X({index:"userMutationsIndex",range:t,reverse:!0},(i,s,u)=>{r=s.batchId,u.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cs(e).j("userMutationsIndex",t).next(r=>r.map(i=>no(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Go(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return _a(e).X({range:i},(u,d,h)=>{const[_,I,b]=u,N=ur(I);if(_===this.userId&&t.path.isEqual(N))return cs(e).get(b).next(z=>{if(!z)throw he();ve(z.userId===this.userId),s.push(no(this.serializer,z))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(Ce);const i=[];return t.forEach(s=>{const u=Go(this.userId,s.path),d=IDBKeyRange.lowerBound(u),h=_a(e).X({range:d},(_,I,b)=>{const[N,z,X]=_,de=ur(z);N===this.userId&&s.path.isEqual(de)?r=r.add(X):b.done()});i.push(h)}),O.waitFor(i).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Go(this.userId,r),u=IDBKeyRange.lowerBound(s);let d=new lt(Ce);return _a(e).X({range:u},(h,_,I)=>{const[b,N,z]=h,X=ur(N);b===this.userId&&r.isPrefixOf(X)?X.length===i&&(d=d.add(z)):I.done()}).next(()=>this.Dn(e,d))}Dn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(cs(e).get(s).next(u=>{if(null===u)throw he();ve(u.userId===this.userId),r.push(no(this.serializer,u))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return jf(e.ht,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return _a(e).X({range:r},(s,u,d)=>{if(s[0]===this.userId){const h=ur(s[1]);i.push(h)}else d.done()}).next(()=>{ve(0===i.length)})})}containsKey(e,t){return Wf(e,this.userId,t)}xn(e){return $f(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Wf(n,e,t){const r=Go(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let u=!1;return _a(n).X({range:s,Y:!0},(d,h,_)=>{const[I,b,N]=d;I===e&&b===i&&(u=!0),_.done()}).next(()=>u)}function cs(n){return Ct(n,"mutations")}function _a(n){return Ct(n,"documentMutations")}function $f(n){return Ct(n,"mutationQueues")}class so{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new so(0)}static Mn(){return new so(-1)}}class Lm{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const r=new so(t.highestTargetId);return t.highestTargetId=r.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>Ee.fromTimestamp(new vt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.$n(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.On(e,i)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(t,r),this.On(e,r))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ya(e).delete(t.targetId)).next(()=>this.$n(e)).next(r=>(ve(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return ya(e).X((u,d)=>{const h=Uu(d);h.sequenceNumber<=t&&null===r.get(h.targetId)&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,t){return ya(e).X((r,i)=>{const s=Uu(i);t(s)})}$n(e){return qf(e).get("targetGlobalKey").next(t=>(ve(null!==t),t))}On(e,t){return qf(e).put("targetGlobalKey",t)}Fn(e,t){return ya(e).put(Rf(this.serializer,t))}Bn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const r=zr(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ya(e).X({range:i,index:"queryTargetsIndex"},(u,d,h)=>{const _=Uu(d);Qi(t,_.target)&&(s=_,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=ls(e);return t.forEach(u=>{const d=Xt(u.path);i.push(s.put({targetId:r,path:d})),i.push(this.referenceDelegate.addReference(e,r,u))}),O.waitFor(i)}removeMatchingKeys(e,t,r){const i=ls(e);return O.forEach(t,s=>{const u=Xt(s.path);return O.waitFor([i.delete([r,u]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=ls(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ls(e);let s=ke();return i.X({range:r,Y:!0},(u,d,h)=>{const _=ur(u[1]),I=new ne(_);s=s.add(I)}).next(()=>s)}containsKey(e,t){const r=Xt(t.path),i=IDBKeyRange.bound([r],[Fo(r)],!1,!0);let s=0;return ls(e).X({index:"documentTargetsIndex",Y:!0,range:i},([u,d],h,_)=>{0!==u&&(s++,_.done())}).next(()=>s>0)}le(e,t){return ya(e).get(t).next(r=>r?Uu(r):null)}}function ya(n){return Ct(n,"targets")}function qf(n){return Ct(n,"targetGlobal")}function ls(n){return Ct(n,"targetDocuments")}function Hf([n,e],[t,r]){const i=Ce(n,t);return 0===i?Ce(e,r):i}class Fm{constructor(e){this.Ln=e,this.buffer=new lt(Hf),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Hf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Zf{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;Q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,f.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Fr(r)?Q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Lr(r)}yield t.Qn(3e5)}))}}class Um{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return O.resolve(xn.ct);const r=new Fm(t);return this.jn.forEachTarget(e,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(e,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(Kf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Kf):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let r,i,s,u,d,h,_;const I=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),i=this.params.maximumSequenceNumbersToCollect):i=b,u=Date.now(),this.nthSequenceNumber(e,i))).next(b=>(r=b,d=Date.now(),this.removeTargets(e,r,t))).next(b=>(s=b,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(b=>(_=Date.now(),Ya()<=me.in.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${u-I}ms\n\tDetermined least recently used ${i} in `+(d-u)+`ms\n\tRemoved ${s} targets in `+(h-d)+`ms\n\tRemoved ${b} documents in `+(_-h)+`ms\nTotal Duration: ${_-I}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:b})))}}class Vm{constructor(e,t){this.db=e,this.garbageCollector=function Qf(n,e){return new Um(n,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Jn(e){let t=0;return this.Wn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(r,i)=>t(i))}addReference(e,t,r){return pl(e,r)}removeReference(e,t,r){return pl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return pl(e,t)}Xn(e,t){return function(r,i){let s=!1;return $f(r).Z(u=>Wf(r,u,i).next(d=>(d&&(s=!0),O.resolve(!d)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Yn(e,(u,d)=>{if(d<=t){const h=this.Xn(e,u).next(_=>{if(!_)return s++,r.getEntry(e,u).next(()=>(r.removeEntry(u,Ee.min()),ls(e).delete([0,Xt(u.path)])))});i.push(h)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return pl(e,t)}Yn(e,t){const r=ls(e);let i,s=xn.ct;return r.X({index:"documentTargetsIndex"},([u,d],{path:h,sequenceNumber:_})=>{0===u?(s!==xn.ct&&t(new ne(ur(i)),s),s=_,i=h):s=xn.ct}).next(()=>{s!==xn.ct&&t(new ne(ur(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function pl(n,e){return ls(n).put((r=n.currentSequenceNumber,{targetId:0,path:Xt(e.path),sequenceNumber:r}));var r}class Yf{constructor(){this.changes=new Sr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Bm{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return oo(e).put(r)}removeEntry(e,t,r){return oo(e).delete(function(i,s){const u=i.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],al(s),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Zn(e,r)))}getEntry(e,t){let r=mt.newInvalidDocument(t);return oo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ku(t))},(i,s)=>{r=this.ts(t,s)}).next(()=>r)}es(e,t){let r={size:0,document:mt.newInvalidDocument(t)};return oo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ku(t))},(i,s)=>{r={document:this.ts(t,s),size:hl(s)}}).next(()=>r)}getEntries(e,t){let r=kn();return this.ns(e,t,(i,s)=>{const u=this.ts(i,s);r=r.insert(i,u)}).next(()=>r)}ss(e,t){let r=kn(),i=new ot(ne.comparator);return this.ns(e,t,(s,u)=>{const d=this.ts(s,u);r=r.insert(s,d),i=i.insert(s,hl(u))}).next(()=>({documents:r,rs:i}))}ns(e,t,r){if(t.isEmpty())return O.resolve();let i=new lt(tp);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(Ku(i.first()),Ku(i.last())),u=i.getIterator();let d=u.getNext();return oo(e).X({index:"documentKeyIndex",range:s},(h,_,I)=>{const b=ne.fromSegments([..._.prefixPath,_.collectionGroup,_.documentId]);for(;d&&tp(d,b)<0;)r(d,null),d=u.getNext();d&&d.isEqual(b)&&(r(d,_),d=u.hasNext()?u.getNext():null),d?I.G(Ku(d)):I.done()}).next(()=>{for(;d;)r(d,null),d=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,r,i){const s=t.path,u=[s.popLast().toArray(),s.lastSegment(),al(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return oo(e).j(IDBKeyRange.bound(u,d,!0)).next(h=>{let _=kn();for(const I of h){const b=this.ts(ne.fromSegments(I.prefixPath.concat(I.collectionGroup,I.documentId)),I);b.isFoundDocument()&&(Ys(t,b)||i.has(b.key))&&(_=_.insert(b.key,b))}return _})}getAllFromCollectionGroup(e,t,r,i){let s=kn();const u=ep(t,r),d=ep(t,Ln.max());return oo(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,d,!0)},(h,_,I)=>{const b=this.ts(ne.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);s=s.insert(b.key,b),s.size===i&&I.done()}).next(()=>s)}newChangeBuffer(e){return new zm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Jf(e).get("remoteDocumentGlobalKey").next(t=>(ve(!!t),t))}Zn(e,t){return Jf(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const r=function Sm(n,e){let t;if(e.document)t=wf(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ne.fromSegments(e.noDocument.path),i=to(e.noDocument.readTime);t=mt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return he();{const r=ne.fromSegments(e.unknownDocument.path),i=to(e.unknownDocument.version);t=mt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new vt(r[0],r[1]);return Ee.fromTimestamp(i)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(Ee.min()))return r}return mt.newInvalidDocument(e)}}function Xf(n){return new Bm(n)}class zm extends Yf{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new Sr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new lt((s,u)=>Ce(s.canonicalString(),u.canonicalString()));return this.changes.forEach((s,u)=>{const d=this.us.get(s);if(t.push(this.os.removeEntry(e,s,d.readTime)),u.isValidDocument()){const h=Df(this.os.serializer,u);i=i.add(s.path.popLast()),r+=hl(h)-d.size,t.push(this.os.addEntry(e,s,h))}else if(r-=d.size,this.trackRemovals){const h=Df(this.os.serializer,u.convertToNoDocument(Ee.min()));t.push(this.os.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,r)),O.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(r=>(this.us.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:r,rs:i})=>(i.forEach((s,u)=>{this.us.set(s,{size:u,readTime:r.get(s).readTime})}),r))}}function Jf(n){return Ct(n,"remoteDocumentGlobal")}function oo(n){return Ct(n,"remoteDocumentsV14")}function Ku(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ep(n,e){const t=e.documentKey.path.toArray();return[n,al(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tp(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Ce(t[s],r[s]),i)return i;return i=Ce(t.length,r.length),i||(i=Ce(t[t.length-2],r[r.length-2]),i||Ce(t[t.length-1],r[r.length-1]))}class Gm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class np{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&Xs(r.mutation,i,Cn.empty(),vt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ke()){const i=dr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let u=gi();return s.forEach((d,h)=>{u=u.insert(d,h.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const r=dr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ke()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((u,d)=>{t.set(u,d)})})}computeViews(e,t,r,i){let s=kn();const u=_i(),d=_i();return t.forEach((h,_)=>{const I=r.get(_.key);i.has(_.key)&&(void 0===I||I.mutation instanceof hr)?s=s.insert(_.key,_):void 0!==I?(u.set(_.key,I.mutation.getFieldMask()),Xs(I.mutation,_,I.mutation.getFieldMask(),vt.now())):u.set(_.key,Cn.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((_,I)=>u.set(_,I)),t.forEach((_,I)=>{var b;return d.set(_,new Gm(I,null!==(b=u.get(_))&&void 0!==b?b:null))}),d))}recalculateAndSaveOverlays(e,t){const r=_i();let i=new ot((u,d)=>u-d),s=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const d of u)d.keys().forEach(h=>{const _=t.get(h);if(null===_)return;let I=r.get(h)||Cn.empty();I=d.applyToLocalView(_,I),r.set(h,I);const b=(i.get(d.batchId)||ke()).add(h);i=i.insert(d.batchId,b)})}).next(()=>{const u=[],d=i.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),_=h.key,I=h.value,b=sa();I.forEach(N=>{if(!s.has(N)){const z=ts(t.get(N),r.get(N));null!==z&&b.set(N,z),s=s.add(N)}}),u.push(this.documentOverlayCache.saveOverlays(e,_,b))}return O.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return ne.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):bu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const u=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):O.resolve(dr());let d=-1,h=s;return u.next(_=>O.forEach(_,(I,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),s.get(I)?O.resolve():this.remoteDocumentCache.getEntry(e,I).next(N=>{h=h.insert(I,N)}))).next(()=>this.populateOverlays(e,_,s)).next(()=>this.computeViews(e,h,_,ke())).next(I=>({batchId:d,changes:Hc(I)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next(r=>{let i=gi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let s=gi();return this.indexManager.getCollectionParents(e,i).next(u=>O.forEach(u,d=>{const h=(_=t,I=d.child(i),new wr(I,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt));var _,I;return this.getDocumentsMatchingCollectionQuery(e,h,r).next(_=>{_.forEach((I,b)=>{s=s.insert(I,b)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(s=>{i.forEach((d,h)=>{const _=h.getKey();null===s.get(_)&&(s=s.insert(_,mt.newInvalidDocument(_)))});let u=gi();return s.forEach((d,h)=>{const _=i.get(d);void 0!==_&&Xs(_.mutation,h,Cn.empty(),vt.now()),Ys(t,h)&&(u=u.insert(d,h))}),u})}}class Km{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return O.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:Dt(r.createTime)}),O.resolve()}getNamedQuery(e,t){return O.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(r=t).name,query:Cd(r.bundledQuery),readTime:Dt(r.readTime)}),O.resolve();var r}}class jm{constructor(){this.overlays=new ot(ne.comparator),this.ls=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const r=dr();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.we(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.ls.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){const i=dr(),s=t.length+1,u=new ne(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const h=d.getNext().value,_=h.getKey();if(!t.isPrefixOf(_.path))break;_.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return O.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ot((_,I)=>_-I);const u=this.overlays.getIterator();for(;u.hasNext();){const _=u.getNext().value;if(_.getKey().getCollectionGroup()===t&&_.largestBatchId>r){let I=s.get(_.largestBatchId);null===I&&(I=dr(),s=s.insert(_.largestBatchId,I)),I.set(_.getKey(),_)}}const d=dr(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((_,I)=>d.set(_,I)),!(d.size()>=i)););return O.resolve(d)}we(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const u=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new dn(t,r));let s=this.ls.get(t);void 0===s&&(s=ke(),this.ls.set(t,s)),this.ls.set(t,s.add(r.key))}}class Pd{constructor(){this.fs=new lt(hn.ds),this.ws=new lt(hn._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const r=new hn(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new hn(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){const t=new ne(new We([])),r=new hn(t,e),i=new hn(t,e+1),s=[];return this.ws.forEachInRange([r,i],u=>{this.ys(u),s.push(u.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new ne(new We([])),r=new hn(t,e),i=new hn(t,e+1);let s=ke();return this.ws.forEachInRange([r,i],u=>{s=s.add(u.key)}),s}containsKey(e){const t=new hn(e,0),r=this.fs.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class hn{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return ne.comparator(e.key,t.key)||Ce(e.As,t.As)}static _s(e,t){return Ce(e.As,t.As)||ne.comparator(e.key,t.key)}}class Wm{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new lt(hn.ds)}checkEmpty(e){return O.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.vs;this.vs++;const u=new Ru(s,t,r,i);this.mutationQueue.push(u);for(const d of i)this.Rs=this.Rs.add(new hn(d.key,s)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return O.resolve(u)}lookupMutationBatch(e,t){return O.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hn(t,0),i=new hn(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,i],u=>{const d=this.Ps(u.As);s.push(d)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new lt(Ce);return t.forEach(i=>{const s=new hn(i,0),u=new hn(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,u],d=>{r=r.add(d.As)})}),O.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ne.isDocumentKey(s)||(s=s.child(""));const u=new hn(new ne(s),0);let d=new lt(Ce);return this.Rs.forEachWhile(h=>{const _=h.key.path;return!!r.isPrefixOf(_)&&(_.length===i&&(d=d.add(h.As)),!0)},u),O.resolve(this.Vs(d))}Vs(e){const t=[];return e.forEach(r=>{const i=this.Ps(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){ve(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let r=this.Rs;return O.forEach(t.mutations,i=>{const s=new hn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){const r=new hn(t,0),i=this.Rs.firstAfterOrEqual(r);return O.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return O.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $m{constructor(e){this.Ds=e,this.docs=new ot(ne.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,u=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():mt.newInvalidDocument(t))}getEntries(e,t){let r=kn();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():mt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=kn();const u=t.path,d=new ne(u.child("")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:_,value:{document:I}}=h.getNext();if(!u.isPrefixOf(_.path))break;_.path.length>u.length+1||bc(Ec(I),r)<=0||(i.has(I.key)||Ys(t,I))&&(s=s.insert(I.key,I.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,t,r,i){he()}Cs(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new qm(this)}getSize(e){return O.resolve(this.size)}}class qm extends Yf{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class Hm{constructor(e){this.persistence=e,this.xs=new Sr(t=>zr(t),Qi),this.lastRemoteSnapshotVersion=Ee.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Pd,this.targetCount=0,this.Ms=so.kn()}forEachTarget(e,t){return this.xs.forEach((r,i)=>t(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),O.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new so(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Fn(t),O.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.xs.forEach((u,d)=>{d.sequenceNumber<=t&&null===r.get(d.targetId)&&(this.xs.delete(u),s.push(this.removeMatchingKeysForTargetId(e,d.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const r=this.xs.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(u=>{s.push(i.markPotentiallyOrphaned(e,u))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),O.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ks.Es(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.ks.containsKey(t))}}class Ld{constructor(e,t){this.$s={},this.overlays={},this.Os=new xn(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Hm(this),this.indexManager=new Om,this.remoteDocumentCache=new $m(r=>this.referenceDelegate.Ls(r)),this.serializer=new kf(t),this.qs=new Km(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new jm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new Wm(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){Q("MemoryPersistence","Starting transaction:",e);const i=new Zm(this.Os.next());return this.referenceDelegate.Us(),r(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return O.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}}class Zm extends wc{constructor(e){super(),this.currentSequenceNumber=e}}class ml{constructor(e){this.persistence=e,this.Qs=new Pd,this.js=null}static zs(e){return new ml(e)}get Ws(){if(this.js)return this.js;throw he()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),O.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Ws,r=>{const i=ne.fromPath(r);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,Ee.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return O.or([()=>O.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Qm{constructor(e){this.serializer=e}O(e,t,r,i){const s=new Vo("createOrUpgrade",t);var d;r<1&&i>=1&&(e.createObjectStore("owner"),(d=e).createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zo,{unique:!0}),d.createObjectStore("documentMutations"),rp(e),function(d){d.createObjectStore("remoteDocuments")}(e));let u=O.resolve();return r<3&&i>=3&&(0!==r&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),rp(e)),u=u.next(()=>function(d){const h=d.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ee.min().toTimestamp(),targetCount:0};return h.put("targetGlobalKey",_)}(s))),r<4&&i>=4&&(0!==r&&(u=u.next(()=>function(d,h){return h.store("mutations").j().next(_=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zo,{unique:!0});const I=h.store("mutations"),b=_.map(N=>I.put(N));return O.waitFor(b)})}(e,s))),u=u.next(()=>{!function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(u=u.next(()=>this.Ys(s))),r<6&&i>=6&&(u=u.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),r<7&&i>=7&&(u=u.next(()=>this.Zs(s))),r<8&&i>=8&&(u=u.next(()=>this.ti(e,s))),r<9&&i>=9&&(u=u.next(()=>{!function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(u=u.next(()=>this.ei(s))),r<11&&i>=11&&(u=u.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(u=u.next(()=>{!function(d){const h=d.createObjectStore("documentOverlays",{keyPath:cd});h.createIndex("collectionPathOverlayIndex",ld,{unique:!1}),h.createIndex("collectionGroupOverlayIndex",uu,{unique:!1})}(e)})),r<13&&i>=13&&(u=u.next(()=>function(d){const h=d.createObjectStore("remoteDocumentsV14",{keyPath:iu});h.createIndex("documentKeyIndex",sd),h.createIndex("collectionGroupIndex",su)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(u=u.next(()=>this.si(e,s))),r<15&&i>=15&&(u=u.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:ad}).createIndex("sequenceNumberIndex",ud,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:au}).createIndex("documentKeyIndex",Sc,{unique:!1})}(e))),u}Xs(e){let t=0;return e.store("remoteDocuments").X((r,i)=>{t+=hl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.j().next(i=>O.forEach(i,s=>{const u=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",u).next(d=>O.forEach(d,h=>{ve(h.userId===s.userId);const _=no(this.serializer,h);return jf(e,s.userId,_).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.X((u,d)=>{const h=new We(u),_=[0,Xt(h)];s.push(t.get(_).next(I=>I?O.resolve():t.put({targetId:0,path:Xt(h),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>O.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:od});const r=t.store("collectionParents"),i=new Od,s=u=>{if(i.add(u)){const d=u.lastSegment(),h=u.popLast();return r.put({collectionId:d,parent:Xt(h)})}};return t.store("remoteDocuments").X({Y:!0},(u,d)=>{const h=new We(u);return s(h.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([u,d,h],_)=>{const I=ur(d);return s(I.popLast())}))}ei(e){const t=e.store("targets");return t.X((r,i)=>{const s=Uu(i),u=Rf(this.serializer,s);return t.put(u)})}ni(e,t){const r=t.store("remoteDocuments"),i=[];return r.X((s,u)=>{const d=t.store("remoteDocumentsV14"),h=(_=u,_.document?new ne(We.fromString(_.document.name).popFirst(5)):_.noDocument?ne.fromSegments(_.noDocument.path):_.unknownDocument?ne.fromSegments(_.unknownDocument.path):he()).path.toArray();var _;const I={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(d.put(I))}).next(()=>O.waitFor(i))}si(e,t){const r=t.store("mutations"),i=Xf(this.serializer),s=new Ld(ml.zs,this.serializer.fe);return r.j().next(u=>{const d=new Map;return u.forEach(h=>{var _;let I=null!==(_=d.get(h.userId))&&void 0!==_?_:ke();no(this.serializer,h).keys().forEach(b=>I=I.add(b)),d.set(h.userId,I)}),O.forEach(d,(h,_)=>{const I=new Pt(_),b=ul.de(this.serializer,I),N=s.getIndexManager(I),z=fl.de(I,this.serializer,N,s.referenceDelegate);return new np(i,z,b,N).recalculateAndSaveOverlaysForDocumentKeys(new du(t,xn.ct),h).next()})})}}function rp(n){n.createObjectStore("targetDocuments",{keyPath:li}).createIndex("documentTargetsIndex",ou,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",js,{unique:!0}),n.createObjectStore("targetGlobal")}const Fd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ud{constructor(e,t,r,i,s,u,d,h,_,I,b=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ii=s,this.window=u,this.document=d,this.ri=_,this.oi=I,this.ui=b,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=N=>Promise.resolve(),!Ud.D())throw new $(L.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Vm(this,i),this.di=t+"main",this.serializer=new kf(h),this.wi=new Sn(this.di,this.ui,new Qm(this.serializer)),this.Bs=new Lm(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Xf(this.serializer),this.qs=new xm,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===I&&Lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new $(L.FAILED_PRECONDITION,Fd);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new xn(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var t=this;return this.fi=function(){var r=(0,f.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(function(){var t=(0,f.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,f.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_l(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(Fr(e))return Q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return ju(e).get("owner").next(t=>O.resolve(this.Ri(t)))}Pi(e){return _l(e).delete(this.clientId)}bi(){var e=this;return(0,f.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Ct(r,"clientMetadata");return i.j().next(s=>{const u=e.Si(s,18e5),d=s.filter(h=>-1===u.indexOf(h));return O.forEach(d,h=>i.delete(h.clientId)).next(()=>d)})}).catch(()=>[]);if(e._i)for(const r of t)e._i.removeItem(e.Di(r.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?O.resolve(!0):ju(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new $(L.FAILED_PRECONDITION,Fd);return!1}}return!(!this.networkEnabled||!this.inForeground)||_l(e).j().next(r=>void 0===this.Si(r,5e3).find(i=>{if(this.clientId!==i.clientId){const u=!this.inForeground&&i.inForeground,d=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||u&&d)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Q("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,f.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new du(t,xn.ct);return e.Ai(r).next(()=>e.Pi(r))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(r=>this.Vi(r.updateTimeMs,t)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>_l(e).j().next(t=>this.Si(t,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return fl.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Pm(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return ul.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,r){Q("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(u=this.ui)?lu:14===u?Wo:13===u?Cc:12===u?cu:11===u?xc:void he();var u;let d;return this.wi.runTransaction(e,i,s,h=>(d=new du(h,this.Os?this.Os.next():xn.ct),"readwrite-primary"===t?this.Ti(d).next(_=>!!_||this.Ei(d)).next(_=>{if(!_)throw Lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new $(L.FAILED_PRECONDITION,ui);return r(d)}).next(_=>this.vi(d).next(()=>_)):this.Oi(d).next(()=>r(d)))).then(h=>(d.raiseOnCommittedEvent(),h))}Oi(e){return ju(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new $(L.FAILED_PRECONDITION,Fd)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ju(e).put("owner",t)}static D(){return Sn.D()}Ai(e){const t=ju(e);return t.get("owner").next(r=>this.Ri(r)?(Q("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):O.resolve())}Vi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Lt(`Detected an update time that is in the future: ${e} > ${r}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,re.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const r=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Lt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Lt("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ju(n){return Ct(n,"owner")}function _l(n){return Ct(n,"clientMetadata")}function Vd(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Bd{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=i}static Li(e,t){let r=ke(),i=ke();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Bd(e,t.fromCache,r,i)}}class ip{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,r)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(gd(t))return O.resolve(null);let r=vn(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=na(t,null,"F"),r=vn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const u=ke(...s);return this.Ui.getDocuments(e,u).next(d=>this.indexManager.getMinOffset(e,r).next(h=>{const _=this.ji(t,d);return this.zi(t,_,u,h.readTime)?this.Ki(e,na(t,null,"F")):this.Wi(e,_,t,h)}))})))}Gi(e,t,r,i){return gd(t)||i.isEqual(Ee.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(s=>{const u=this.ji(t,s);return this.zi(t,u,r,i)?this.Qi(e,t):(Ya()<=me.in.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wu(t)),this.Wi(e,u,t,eu(i,-1)))})}ji(e,t){let r=new lt(qc(e));return t.forEach((i,s)=>{Ys(e,s)&&(r=r.add(s))}),r}zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return Ya()<=me.in.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",wu(t)),this.Ui.getDocumentsMatchingQuery(e,t,Ln.min())}Wi(e,t,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(u=>{s=s.insert(u.key,u)}),s))}}class Ym{constructor(e,t,r,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new ot(Ce),this.Yi=new Sr(s=>zr(s),Qi),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new np(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function sp(n,e,t,r){return new Ym(n,e,t,r)}function op(n,e){return zd.apply(this,arguments)}function zd(){return zd=(0,f.Z)(function*(n,e){const t=se(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const u=[],d=[];let h=ke();for(const _ of i){u.push(_.batchId);for(const I of _.mutations)h=h.add(I.key)}for(const _ of s){d.push(_.batchId);for(const I of _.mutations)h=h.add(I.key)}return t.localDocuments.getDocuments(r,h).next(_=>({er:_,removedBatchIds:u,addedBatchIds:d}))})})}),zd.apply(this,arguments)}function Xm(n,e){const t=se(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(u,d,h,_){const I=h.batch,b=I.keys();let N=O.resolve();return b.forEach(z=>{N=N.next(()=>_.getEntry(d,z)).next(X=>{const de=h.docVersions.get(z);ve(null!==de),X.version.compareTo(de)<0&&(I.applyToRemoteDocument(X,h),X.isValidDocument()&&(X.setReadTime(h.commitVersion),_.addEntry(X)))})}),N.next(()=>u.mutationQueue.removeMutationBatch(d,I))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let d=ke();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(d=d.add(u.batch.mutations[h].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function ap(n){const e=se(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function Jm(n,e){const t=se(n),r=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const u=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const d=[];e.targetChanges.forEach((I,b)=>{const N=i.get(b);if(!N)return;d.push(t.Bs.removeMatchingKeys(s,I.removedDocuments,b).next(()=>t.Bs.addMatchingKeys(s,I.addedDocuments,b)));let z=N.withSequenceNumber(s.currentSequenceNumber);var X,de,pe;null!==e.targetMismatches.get(b)?z=z.withResumeToken(jt.EMPTY_BYTE_STRING,Ee.min()).withLastLimboFreeSnapshotVersion(Ee.min()):I.resumeToken.approximateByteSize()>0&&(z=z.withResumeToken(I.resumeToken,r)),i=i.insert(b,z),de=z,pe=I,(0===(X=N).resumeToken.approximateByteSize()||de.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=3e8||pe.addedDocuments.size+pe.modifiedDocuments.size+pe.removedDocuments.size>0)&&d.push(t.Bs.updateTargetData(s,z))});let h=kn(),_=ke();if(e.documentUpdates.forEach(I=>{e.resolvedLimboDocuments.has(I)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(s,I))}),d.push(up(s,u,e.documentUpdates).next(I=>{h=I.nr,_=I.sr})),!r.isEqual(Ee.min())){const I=t.Bs.getLastRemoteSnapshotVersion(s).next(b=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));d.push(I)}return O.waitFor(d).next(()=>u.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,_)).next(()=>h)}).then(s=>(t.Ji=i,s))}function up(n,e,t){let r=ke(),i=ke();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let u=kn();return t.forEach((d,h)=>{const _=s.get(d);h.isFoundDocument()!==_.isFoundDocument()&&(i=i.add(d)),h.isNoDocument()&&h.version.isEqual(Ee.min())?(e.removeEntry(d,h.readTime),u=u.insert(d,h)):!_.isValidDocument()||h.version.compareTo(_.version)>0||0===h.version.compareTo(_.version)&&_.hasPendingWrites?(e.addEntry(h),u=u.insert(d,h)):Q("LocalStore","Ignoring outdated watch update for ",d,". Current version:",_.version," Watch version:",h.version)}),{nr:u,sr:i}})}function eg(n,e){const t=se(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function va(n,e){const t=se(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Bs.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):t.Bs.allocateTargetId(r).next(u=>(i=new bi(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ji.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}function Ia(n,e,t){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,f.Z)(function*(n,e,t){const r=se(n),i=r.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,u=>r.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!Fr(u))throw u;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${u}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}),Gd.apply(this,arguments)}function yl(n,e,t){const r=se(n);let i=Ee.min(),s=ke();return r.persistence.runTransaction("Execute query","readonly",u=>function(d,h,_){const I=se(d),b=I.Yi.get(_);return void 0!==b?O.resolve(I.Ji.get(b)):I.Bs.getTargetData(h,_)}(r,u,vn(e)).next(d=>{if(d)return i=d.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(u,d.targetId).next(h=>{s=h})}).next(()=>r.Hi.getDocumentsMatchingQuery(u,e,t?i:Ee.min(),t?s:ke())).next(d=>(dp(r,ia(e),d),{documents:d,ir:s})))}function cp(n,e){const t=se(n),r=se(t.Bs),i=t.Ji.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.le(s,e).next(u=>u?u.target:null))}function lp(n,e){const t=se(n),r=t.Xi.get(e)||Ee.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Zi.getAllFromCollectionGroup(i,e,eu(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(dp(t,e,i),i))}function dp(n,e,t){let r=n.Xi.get(e)||Ee.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Xi.set(e,r)}function Kd(){return Kd=(0,f.Z)(function*(n,e,t,r){const i=se(n);let s=ke(),u=kn();for(const _ of t){const I=e.rr(_.metadata.name);_.document&&(s=s.add(I));const b=e.ur(_);b.setReadTime(e.cr(_.metadata.readTime)),u=u.insert(I,b)}const d=i.Zi.newChangeBuffer({trackRemovals:!0}),h=yield va(i,(_=r,vn(Yi(We.fromString(`__bundle__/docs/${_}`)))));var _;return i.persistence.runTransaction("Apply bundle documents","readwrite",_=>up(_,d,u).next(I=>(d.apply(_),I)).next(I=>i.Bs.removeMatchingKeysForTargetId(_,h.targetId).next(()=>i.Bs.addMatchingKeys(_,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(_,I.nr,I.sr)).next(()=>I.nr)))}),Kd.apply(this,arguments)}function ng(n,e){return jd.apply(this,arguments)}function jd(){return jd=(0,f.Z)(function*(n,e,t=ke()){const r=yield va(n,vn(Cd(e.bundledQuery))),i=se(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const u=Dt(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return i.qs.saveNamedQuery(s,e);const d=r.withResumeToken(jt.EMPTY_BYTE_STRING,u);return i.Ji=i.Ji.insert(d.targetId,d),i.Bs.updateTargetData(s,d).next(()=>i.Bs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Bs.addMatchingKeys(s,t,r.targetId)).next(()=>i.qs.saveNamedQuery(s,e))})}),jd.apply(this,arguments)}function hp(n,e){return`firestore_clients_${n}_${e}`}function fp(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Wd(n,e){return`firestore_targets_${n}_${e}`}class vl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static ar(e,t,r){const i=JSON.parse(r);let s,u="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return u&&i.error&&(u="string"==typeof i.error.message&&"string"==typeof i.error.code,u&&(s=new $(i.error.code,i.error.message))),u?new vl(e,t,i.state,s):(Lt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static ar(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new $(r.error.code,r.error.message))),s?new Wu(e,r.state,i):(Lt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Il{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=Au();for(let u=0;i&&u<r.activeTargetIds.length;++u)i=Ac(r.activeTargetIds[u]),s=s.add(r.activeTargetIds[u]);return i?new Il(e,s):(Lt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class $d{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new $d(t.clientId,t.onlineState):(Lt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class qd{constructor(){this.activeTargetIds=Au()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hd{constructor(e,t,r,i,s){this.window=e,this.ii=t,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new ot(Ce),this.started=!1,this.yr=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=hp(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new qd),this.Tr=new RegExp(`^firestore_clients_${u}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${u}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${u}_(\\d+)$`),this.vr=`firestore_online_state_${this.persistenceKey}`,this.Rr=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,f.Z)(function*(){const t=yield e.syncEngine.$i();for(const i of t){if(i===e.wr)continue;const s=e.getItem(hp(e.persistenceKey,i));if(s){const u=Il.ar(i,s);u&&(e.gr=e.gr.insert(u.clientId,u))}}e.Pr();const r=e.storage.getItem(e.vr);if(r){const i=e.br(r);i&&e.Vr(i)}for(const i of e.yr)e.mr(i);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,r){this.Dr(e,t,r),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Wd(this.persistenceKey,e));if(r){const i=Wu.ar(e,r);i&&(t=i.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Wd(this.persistenceKey,e))}updateQueryState(e,t,r){this.kr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Cr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Q("SharedClientState","READ",e,t),t}setItem(e,t){Q("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Q("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Q("SharedClientState","EVENT",r.key,r.newValue),r.key===this.pr)return void Lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,f.Z)(function*(){if(t.started){if(null!==r.key)if(t.Tr.test(r.key)){if(null==r.newValue){const i=t.Or(r.key);return t.Fr(i,null)}{const i=t.Br(r.key,r.newValue);if(i)return t.Fr(i.clientId,i)}}else if(t.Er.test(r.key)){if(null!==r.newValue){const i=t.Lr(r.key,r.newValue);if(i)return t.qr(i)}}else if(t.Ar.test(r.key)){if(null!==r.newValue){const i=t.Ur(r.key,r.newValue);if(i)return t.Kr(i)}}else if(r.key===t.vr){if(null!==r.newValue){const i=t.br(r.newValue);if(i)return t.Vr(i)}}else if(r.key===t.Ir){const i=function(s){let u=xn.ct;if(null!=s)try{const d=JSON.parse(s);ve("number"==typeof d),u=d}catch(d){Lt("SharedClientState","Failed to read sequence number from WebStorage",d)}return u}(r.newValue);i!==xn.ct&&t.sequenceNumberHandler(i)}else if(r.key===t.Rr){const i=t.Gr(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Qr(s)))}}else t.yr.push(r)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,r){const i=new vl(this.currentUser,e,t,r),s=fp(this.persistenceKey,this.currentUser,e);this.setItem(s,i.hr())}Cr(e){const t=fp(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,r){const i=Wd(this.persistenceKey,e),s=new Wu(e,t,r);this.setItem(i,s.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const r=this.Or(e);return Il.ar(r,t)}Lr(e,t){const r=this.Er.exec(e),i=Number(r[1]);return vl.ar(new Pt(void 0!==r[2]?r[2]:null),i,t)}Ur(e,t){const r=this.Ar.exec(e),i=Number(r[1]);return Wu.ar(i,t)}br(e){return $d.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,f.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);Q("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),s=this.Sr(r),u=[],d=[];return s.forEach(h=>{i.has(h)||u.push(h)}),i.forEach(h=>{s.has(h)||d.push(h)}),this.syncEngine.Wr(u,d).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=Au();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class pp{constructor(){this.Hr=new qd,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new qd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class rg{Yr(e){}shutdown(){}}class mp{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let El=null;function Zd(){return null===El?El=268435456+Math.round(2147483648*Math.random()):El++,"0x"+El.toString(16)}const ig={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sg{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Rn="WebChannelConnection";class og extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,i,s){const u=Zd(),d=this.To(e,t);Q("RestConnection",`Sending RPC '${e}' ${u}:`,d,r);const h={};return this.Eo(h,i,s),this.Ao(e,d,h,r).then(_=>(Q("RestConnection",`Received RPC '${e}' ${u}: `,_),_),_=>{throw jn("RestConnection",`RPC '${e}' ${u} failed with error: `,_,"url: ",d,"request:",r),_})}vo(e,t,r,i,s,u){return this.Io(e,t,r,i,s)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Kn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${ig[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,i){const s=Zd();return new Promise((u,d)=>{const h=new gf;h.setWithCredentials(!0),h.listenOnce(pf.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Za.NO_ERROR:const I=h.getResponseJson();Q(Rn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(I)),u(I);break;case Za.TIMEOUT:Q(Rn,`RPC '${e}' ${s} timed out`),d(new $(L.DEADLINE_EXCEEDED,"Request time out"));break;case Za.HTTP_ERROR:const b=h.getStatus();if(Q(Rn,`RPC '${e}' ${s} failed with status:`,b,"response text:",h.getResponseText()),b>0){let N=h.getResponseJson();Array.isArray(N)&&(N=N[0]);const z=N?.error;if(z&&z.status&&z.message){const X=function(de){const pe=de.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(pe)>=0?pe:L.UNKNOWN}(z.status);d(new $(X,z.message))}else d(new $(L.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new $(L.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{Q(Rn,`RPC '${e}' ${s} completed.`)}});const _=JSON.stringify(i);Q(Rn,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",_,r,15)})}Ro(e,t,r){const i=Zd(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=ql(),d=Hl(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;void 0!==_&&(h.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(h.xmlHttpFactory=new Zl({})),this.Eo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const I=s.join("");Q(Rn,`Creating RPC '${e}' stream ${i}: ${I}`,h);const b=u.createWebChannel(I,h);let N=!1,z=!1;const X=new sg({ro:pe=>{z?Q(Rn,`Not sending because RPC '${e}' stream ${i} is closed:`,pe):(N||(Q(Rn,`Opening RPC '${e}' stream ${i} transport.`),b.open(),N=!0),Q(Rn,`RPC '${e}' stream ${i} sending:`,pe),b.send(pe))},oo:()=>b.close()}),de=(pe,Le,Ye)=>{pe.listen(Le,Ve=>{try{Ye(Ve)}catch(an){setTimeout(()=>{throw an},0)}})};return de(b,Qa.EventType.OPEN,()=>{z||Q(Rn,`RPC '${e}' stream ${i} transport opened.`)}),de(b,Qa.EventType.CLOSE,()=>{z||(z=!0,Q(Rn,`RPC '${e}' stream ${i} transport closed`),X.wo())}),de(b,Qa.EventType.ERROR,pe=>{z||(z=!0,jn(Rn,`RPC '${e}' stream ${i} transport errored:`,pe),X.wo(new $(L.UNAVAILABLE,"The operation could not be completed")))}),de(b,Qa.EventType.MESSAGE,pe=>{var Le;if(!z){const Ye=pe.data[0];ve(!!Ye);const Ve=Ye,an=Ve.error||(null===(Le=Ve[0])||void 0===Le?void 0:Le.error);if(an){Q(Rn,`RPC '${e}' stream ${i} received error:`,an);const Jt=an.status;let At=function(po){const _m=Ut[po];if(void 0!==_m)return Ou(_m)}(Jt),$n=an.message;void 0===At&&(At=L.INTERNAL,$n="Unknown error status: "+Jt+" with message "+an.message),z=!0,X.wo(new $(At,$n)),b.close()}else Q(Rn,`RPC '${e}' stream ${i} received:`,Ye),X._o(Ye)}}),de(d,mf.STAT_EVENT,pe=>{pe.stat===gc.PROXY?Q(Rn,`RPC '${e}' stream ${i} detected buffering proxy`):pe.stat===gc.NOPROXY&&Q(Rn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{X.fo()},0),X}}function gp(){return typeof window<"u"?window:null}function bl(){return typeof document<"u"?document:null}function $u(n){return new tr(n,!0)}class Qd{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class _p{constructor(e,t,r,i,s,u,d,h){this.ii=e,this.$o=r,this.Oo=i,this.connection=s,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Qd(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,f.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,f.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var r=this;return(0,f.Z)(function*(){r.Ho(),r.Jo(),r.qo.cancel(),r.Fo++,4!==e?r.qo.reset():t&&t.code===L.RESOURCE_EXHAUSTED?(Lt(t.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),r.qo.xo()):t&&t.code===L.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Yo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===t&&this.Zo(r,i)},r=>{e(()=>{const i=new $(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(e,t){const r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No((0,f.Z)(function*(){e.state=0,e.start()}))}tu(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ag extends _p{constructor(e,t,r,i,s,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,u),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function vm(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(h=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===h?1:"REMOVE"===h?2:"CURRENT"===h?3:"RESET"===h?4:he(),i=e.targetChange.targetIds||[],s=function(h,_){return h.useProto3Json?(ve(void 0===_||"string"==typeof _),jt.fromBase64String(_||"")):(ve(void 0===_||_ instanceof Uint8Array),jt.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&function(h){const _=void 0===h.code?L.UNKNOWN:Ou(h.code);return new $(_,h.message||"")}(u);t=new v(r,i,s,d||null)}else if("documentChange"in e){const r=e.documentChange,i=Wn(n,r.document.name),s=Dt(r.document.updateTime),u=r.document.createTime?Dt(r.document.createTime):Ee.min(),d=new on({mapValue:{fields:r.document.fields}}),h=mt.newFoundDocument(i,s,u,d);t=new l(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=Wn(n,r.document),s=r.readTime?Dt(r.readTime):Ee.min(),u=mt.newNoDocument(i,s);t=new l([],r.removedTargetIds||[],u.key,u)}else if("documentRemove"in e){const r=e.documentRemove,i=Wn(n,r.document);t=new l([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return he();{const r=e.filter,{count:i=0,unchangedNames:s}=r,u=new Nu(i,s);t=new m(r.targetId,u)}}var h;return t}(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ee.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Ee.min():s.readTime?Dt(s.readTime):Ee.min()}(e);return this.listener.nu(t,r)}su(e){const t={};t.database=Ei(this.serializer),t.addTarget=function(i,s){let u;const d=s.target;if(u=Jo(d)?{documents:Tf(i,d)}:{query:xd(i,d)},u.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){u.resumeToken=pa(i,s.resumeToken);const h=ss(i,s.expectedCount);null!==h&&(u.expectedCount=h)}else if(s.snapshotVersion.compareTo(Ee.min())>0){u.readTime=Ii(i,s.snapshotVersion.toTimestamp());const h=ss(i,s.expectedCount);null!==h&&(u.expectedCount=h)}return u}(this.serializer,e);const r=function Em(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Wo(t)}iu(e){const t={};t.database=Ei(this.serializer),t.removeTarget=e,this.Wo(t)}}class ug extends _p{constructor(e,t,r,i,s,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,u),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(ve(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function Im(n,e){return n&&n.length>0?(ve(void 0!==e),n.map(t=>function(r,i){let s=Dt(r.updateTime?r.updateTime:i);return s.isEqual(Ee.min())&&(s=Dt(i)),new Td(s,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Dt(e.commitTime);return this.listener.cu(r,t)}return ve(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Ei(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Fu(this.serializer,r))};this.Wo(t)}}class cg extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new $(L.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $(L.UNKNOWN,i.toString())})}vo(e,t,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,u])=>this.connection.vo(e,t,r,s,u,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(L.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}function Yd(){return Yd=(0,f.Z)(function*(n,e,t){var r;const i=se(n),{request:s,du:u}=function(I,b,N){const z=xd(I,b),X={},de=[];let pe=0;return N.forEach(Le=>{const Ye="aggregate_"+pe++;X[Ye]=Le.alias,"count"===Le.yt?de.push({alias:Ye,count:{}}):"avg"===Le.yt?de.push({alias:Ye,avg:{field:as(Le.fieldPath)}}):"sum"===Le.yt&&de.push({alias:Ye,sum:{field:as(Le.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:de,structuredQuery:z.structuredQuery},parent:z.parent},du:X}}(i.serializer,vn(e),t),d=s.parent;i.connection.po||delete s.parent;const h=(yield i.vo("RunAggregationQuery",d,s,1)).filter(I=>!!I.result);ve(1===h.length);const _=null===(r=h[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(_).reduce((I,b)=>(I[u[b]]=_[b],I),{})}),Yd.apply(this,arguments)}class dg{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Lt(t),this.mu=!1):Q("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class hg{constructor(e,t,r,i,s){var u=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(d=>{r.enqueueAndForget((0,f.Z)(function*(){var h;ds(u)&&(Q("RemoteStore","Restarting streams for network reachability change."),yield(h=(0,f.Z)(function*(_){const I=se(_);I.vu.add(4),yield Ea(I),I.bu.set("Unknown"),I.vu.delete(4),yield qu(I)}),function(_){return h.apply(this,arguments)})(u))}))}),this.bu=new dg(r,i)}}function qu(n){return Xd.apply(this,arguments)}function Xd(){return Xd=(0,f.Z)(function*(n){if(ds(n))for(const e of n.Ru)yield e(!0)}),Xd.apply(this,arguments)}function Ea(n){return Jd.apply(this,arguments)}function Jd(){return Jd=(0,f.Z)(function*(n){for(const e of n.Ru)yield e(!1)}),Jd.apply(this,arguments)}function wl(n,e){const t=se(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),nh(t)?th(t):wa(t).Ko()&&eh(t,e))}function Hu(n,e){const t=se(n),r=wa(t);t.Au.delete(e),r.Ko()&&yp(t,e),0===t.Au.size&&(r.Ko()?r.jo():ds(t)&&t.bu.set("Unknown"))}function eh(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ee.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wa(n).su(e)}function yp(n,e){n.Vu.qt(e),wa(n).iu(e)}function th(n){n.Vu=new R({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),wa(n).start(),n.bu.gu()}function nh(n){return ds(n)&&!wa(n).Uo()&&n.Au.size>0}function ds(n){return 0===se(n).vu.size}function vp(n){n.Vu=void 0}function fg(n){return rh.apply(this,arguments)}function rh(){return rh=(0,f.Z)(function*(n){n.Au.forEach((e,t)=>{eh(n,e)})}),rh.apply(this,arguments)}function pg(n,e){return ih.apply(this,arguments)}function ih(){return ih=(0,f.Z)(function*(n,e){vp(n),nh(n)?(n.bu.Iu(e),th(n)):n.bu.set("Unknown")}),ih.apply(this,arguments)}function mg(n,e,t){return sh.apply(this,arguments)}function sh(){return sh=(0,f.Z)(function*(n,e,t){if(n.bu.set("Online"),e instanceof v&&2===e.state&&e.cause)try{yield(r=(0,f.Z)(function*(i,s){const u=s.cause;for(const d of s.targetIds)i.Au.has(d)&&(yield i.remoteSyncer.rejectListen(d,u),i.Au.delete(d),i.Vu.removeTarget(d))}),function(i,s){return r.apply(this,arguments)})(n,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Tl(n,r)}else if(e instanceof l?n.Vu.Ht(e):e instanceof m?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(Ee.min()))try{const r=yield ap(n.localStore);t.compareTo(r)>=0&&(yield function(i,s){const u=i.Vu.ce(s);return u.targetChanges.forEach((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const _=i.Au.get(h);_&&i.Au.set(h,_.withResumeToken(d.resumeToken,s))}}),u.targetMismatches.forEach((d,h)=>{const _=i.Au.get(d);if(!_)return;i.Au.set(d,_.withResumeToken(jt.EMPTY_BYTE_STRING,_.snapshotVersion)),yp(i,d);const I=new bi(_.target,d,h,_.sequenceNumber);eh(i,I)}),i.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),yield Tl(n,r)}var r}),sh.apply(this,arguments)}function Tl(n,e,t){return oh.apply(this,arguments)}function oh(){return oh=(0,f.Z)(function*(n,e,t){if(!Fr(e))throw e;n.vu.add(1),yield Ea(n),n.bu.set("Offline"),t||(t=()=>ap(n.localStore)),n.asyncQueue.enqueueRetryable((0,f.Z)(function*(){Q("RemoteStore","Retrying IndexedDB access"),yield t(),n.vu.delete(1),yield qu(n)}))}),oh.apply(this,arguments)}function Ip(n,e){return e().catch(t=>Tl(n,t,e))}function ba(n){return ah.apply(this,arguments)}function ah(){return ah=(0,f.Z)(function*(n){const e=se(n),t=hs(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;gg(e);)try{const i=yield eg(e.localStore,r);if(null===i){0===e.Eu.length&&t.jo();break}r=i.batchId,_g(e,i)}catch(i){yield Tl(e,i)}Ep(e)&&bp(e)}),ah.apply(this,arguments)}function gg(n){return ds(n)&&n.Eu.length<10}function _g(n,e){n.Eu.push(e);const t=hs(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function Ep(n){return ds(n)&&!hs(n).Uo()&&n.Eu.length>0}function bp(n){hs(n).start()}function yg(n){return uh.apply(this,arguments)}function uh(){return uh=(0,f.Z)(function*(n){hs(n).hu()}),uh.apply(this,arguments)}function vg(n){return ch.apply(this,arguments)}function ch(){return ch=(0,f.Z)(function*(n){const e=hs(n);for(const t of n.Eu)e.uu(t.mutations)}),ch.apply(this,arguments)}function Ig(n,e,t){return lh.apply(this,arguments)}function lh(){return lh=(0,f.Z)(function*(n,e,t){const r=n.Eu.shift(),i=la.from(r,e,t);yield Ip(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ba(n)}),lh.apply(this,arguments)}function Eg(n,e){return dh.apply(this,arguments)}function dh(){return dh=(0,f.Z)(function*(n,e){var t;e&&hs(n).ou&&(yield(t=(0,f.Z)(function*(r,i){if(is(s=i.code)&&s!==L.ABORTED){const u=r.Eu.shift();hs(r).Qo(),yield Ip(r,()=>r.remoteSyncer.rejectFailedWrite(u.batchId,i)),yield ba(r)}var s}),function(r,i){return t.apply(this,arguments)})(n,e)),Ep(n)&&bp(n)}),dh.apply(this,arguments)}function wp(n,e){return hh.apply(this,arguments)}function hh(){return hh=(0,f.Z)(function*(n,e){const t=se(n);t.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=ds(t);t.vu.add(3),yield Ea(t),r&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield qu(t)}),hh.apply(this,arguments)}function fh(n,e){return ph.apply(this,arguments)}function ph(){return ph=(0,f.Z)(function*(n,e){const t=se(n);e?(t.vu.delete(2),yield qu(t)):e||(t.vu.add(2),yield Ea(t),t.bu.set("Unknown"))}),ph.apply(this,arguments)}function wa(n){return n.Su||(n.Su=function(e,t,r){const i=se(e);return i.fu(),new ag(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:fg.bind(null,n),ao:pg.bind(null,n),nu:mg.bind(null,n)}),n.Ru.push(function(){var e=(0,f.Z)(function*(t){t?(n.Su.Qo(),nh(n)?th(n):n.bu.set("Unknown")):(yield n.Su.stop(),vp(n))});return function(t){return e.apply(this,arguments)}}())),n.Su}function hs(n){return n.Du||(n.Du=function(e,t,r){const i=se(e);return i.fu(),new ug(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:yg.bind(null,n),ao:Eg.bind(null,n),au:vg.bind(null,n),cu:Ig.bind(null,n)}),n.Ru.push(function(){var e=(0,f.Z)(function*(t){t?(n.Du.Qo(),yield ba(n)):(yield n.Du.stop(),n.Eu.length>0&&(Q("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Du}class mh{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}static createAndSchedule(e,t,r,i,s){const u=Date.now()+r,d=new mh(e,t,u,i,s);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new $(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ta(n,e){if(Lt("AsyncQueue",`${e}: ${n}`),Fr(n))return new $(L.UNAVAILABLE,`${e}: ${n}`);throw n}class Aa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ne.comparator(t.key,r.key):(t,r)=>ne.comparator(t.key,r.key),this.keyedMap=gi(),this.sortedSet=new ot(this.comparator)}static emptySet(e){return new Aa(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Aa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Aa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Tp{constructor(){this.Cu=new ot(ne.comparator)}track(e){const t=e.doc.key,r=this.Cu.get(t);r?0!==e.type&&3===r.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==r.type?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Cu=this.Cu.remove(t):1===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):he():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Sa{constructor(e,t,r,i,s,u,d,h,_){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=_}static fromInitialDocuments(e,t,r,i,s){const u=[];return t.forEach(d=>{u.push({type:0,doc:d})}),new Sa(e,t,Aa.emptySet(t),u,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class bg{constructor(){this.Nu=void 0,this.listeners=[]}}class wg{constructor(){this.queries=new Sr(e=>ra(e),Qs),this.onlineState="Unknown",this.ku=new Set}}function gh(n,e){return _h.apply(this,arguments)}function _h(){return _h=(0,f.Z)(function*(n,e){const t=se(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new bg),i)try{s.Nu=yield t.onListen(r)}catch(u){const d=Ta(u,`Initialization of query '${wu(e.query)}' failed`);return void e.onError(d)}t.queries.set(r,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&Ih(t)}),_h.apply(this,arguments)}function yh(n,e){return vh.apply(this,arguments)}function vh(){return vh=(0,f.Z)(function*(n,e){const t=se(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const u=s.listeners.indexOf(e);u>=0&&(s.listeners.splice(u,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),vh.apply(this,arguments)}function Tg(n,e){const t=se(n);let r=!1;for(const i of e){const u=t.queries.get(i.query);if(u){for(const d of u.listeners)d.$u(i)&&(r=!0);u.Nu=i}}r&&Ih(t)}function Ag(n,e,t){const r=se(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Ih(n){n.ku.forEach(e=>{e.next()})}class Eh{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Sa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=Sa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class Sg{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class Ap{constructor(e){this.serializer=e}rr(e){return Wn(this.serializer,e)}ur(e){return e.metadata.exists?wf(this.serializer,e.document,!1):mt.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Dt(e)}}class xg{constructor(e,t,r){this.ju=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Sp(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const r=We.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,r=new Ap(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.rr(i.metadata.name);for(const u of i.metadata.queries){const d=(t.get(u)||ke()).add(s);t.set(u,d)}}return t}complete(){var e=this;return(0,f.Z)(function*(){const t=yield function tg(n,e,t,r){return Kd.apply(this,arguments)}(e.localStore,new Ap(e.serializer),e.documents,e.ju.id),r=e.Wu(e.documents);for(const i of e.queries)yield ng(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function Sp(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class xp{constructor(e){this.key=e}}class Cp{constructor(e){this.key=e}}class kp{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=ke(),this.mutatedKeys=ke(),this.tc=qc(e),this.ec=new Aa(this.tc)}get nc(){return this.Yu}sc(e,t){const r=t?t.ic:new Tp,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,u=i,d=!1;const h="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,_="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((I,b)=>{const N=i.get(I),z=Ys(this.query,b)?b:null,X=!!N&&this.mutatedKeys.has(N.key),de=!!z&&(z.hasLocalMutations||this.mutatedKeys.has(z.key)&&z.hasCommittedMutations);let pe=!1;N&&z?N.data.isEqual(z.data)?X!==de&&(r.track({type:3,doc:z}),pe=!0):this.rc(N,z)||(r.track({type:2,doc:z}),pe=!0,(h&&this.tc(z,h)>0||_&&this.tc(z,_)<0)&&(d=!0)):!N&&z?(r.track({type:0,doc:z}),pe=!0):N&&!z&&(r.track({type:1,doc:N}),pe=!0,(h||_)&&(d=!0)),pe&&(z?(u=u.add(z),s=de?s.add(I):s.delete(I)):(u=u.delete(I),s=s.delete(I)))}),null!==this.query.limit)for(;u.size>this.query.limit;){const I="F"===this.query.limitType?u.last():u.first();u=u.delete(I.key),s=s.delete(I.key),r.track({type:1,doc:I})}return{ec:u,ic:r,zi:d,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((_,I)=>function(b,N){const z=X=>{switch(X){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return z(b)-z(N)}(_.type,I.type)||this.tc(_.doc,I.doc)),this.oc(r);const u=t?this.uc():[],d=0===this.Zu.size&&this.current?1:0,h=d!==this.Xu;return this.Xu=d,0!==s.length||h?{snapshot:new Sa(this.query,e.ec,i,s,e.mutatedKeys,0===d,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:u}:{cc:u}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Tp,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=ke(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new Cp(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new xp(r))}),t}hc(e){this.Yu=e.ir,this.Zu=ke();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Sa.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Cg{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kg{constructor(e){this.key=e,this.fc=!1}}class Dg{constructor(e,t,r,i,s,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=u,this.dc={},this.wc=new Sr(d=>ra(d),Qs),this._c=new Map,this.mc=new Set,this.gc=new ot(ne.comparator),this.yc=new Map,this.Ic=new Pd,this.Tc={},this.Ec=new Map,this.Ac=so.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function Rg(n,e){return bh.apply(this,arguments)}function bh(){return bh=(0,f.Z)(function*(n,e){const t=Wh(n);let r,i;const s=t.wc.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const u=yield va(t.localStore,vn(e)),d=t.sharedClientState.addLocalQueryTarget(u.targetId);r=u.targetId,i=yield wh(t,e,r,"current"===d,u.resumeToken),t.isPrimaryClient&&wl(t.remoteStore,u)}return i}),bh.apply(this,arguments)}function wh(n,e,t,r,i){return Th.apply(this,arguments)}function Th(){return Th=(0,f.Z)(function*(n,e,t,r,i){n.Rc=(b,N,z)=>{return(X=(0,f.Z)(function*(de,pe,Le,Ye){let Ve=pe.view.sc(Le);Ve.zi&&(Ve=yield yl(de.localStore,pe.query,!1).then(({documents:At})=>pe.view.sc(At,Ve)));const an=Ye&&Ye.targetChanges.get(pe.targetId),Jt=pe.view.applyChanges(Ve,de.isPrimaryClient,an);return Oh(de,pe.targetId,Jt.cc),Jt.snapshot}),function(de,pe,Le,Ye){return X.apply(this,arguments)})(n,b,N,z);var X};const s=yield yl(n.localStore,e,!0),u=new kp(e,s.ir),d=u.sc(s.documents),h=a.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),_=u.applyChanges(d,n.isPrimaryClient,h);Oh(n,t,_.cc);const I=new Cg(e,t,u);return n.wc.set(e,I),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),_.snapshot}),Th.apply(this,arguments)}function Mg(n,e){return Ah.apply(this,arguments)}function Ah(){return Ah=(0,f.Z)(function*(n,e){const t=se(n),r=t.wc.get(e),i=t._c.get(r.targetId);if(i.length>1)return t._c.set(r.targetId,i.filter(s=>!Qs(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ia(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Hu(t.remoteStore,r.targetId),xa(t,r.targetId)}).catch(Lr))):(xa(t,r.targetId),yield Ia(t.localStore,r.targetId,!0))}),Ah.apply(this,arguments)}function Sh(){return Sh=(0,f.Z)(function*(n,e,t){const r=$h(n);try{const i=yield function(s,u){const d=se(s),h=vt.now(),_=u.reduce((N,z)=>N.add(z.key),ke());let I,b;return d.persistence.runTransaction("Locally write mutations","readwrite",N=>{let z=kn(),X=ke();return d.Zi.getEntries(N,_).next(de=>{z=de,z.forEach((pe,Le)=>{Le.isValidDocument()||(X=X.add(pe))})}).next(()=>d.localDocuments.getOverlayedDocuments(N,z)).next(de=>{I=de;const pe=[];for(const Le of u){const Ye=Cu(Le,I.get(Le.key).overlayedDocument);null!=Ye&&pe.push(new hr(Le.key,Ye,Lc(Ye.value.mapValue),ft.exists(!0)))}return d.mutationQueue.addMutationBatch(N,h,pe,u)}).next(de=>{b=de;const pe=de.applyToLocalDocumentSet(I,X);return d.documentOverlayCache.saveOverlays(N,de.batchId,pe)})}).then(()=>({batchId:b.batchId,changes:Hc(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,u,d){let h=s.Tc[s.currentUser.toKey()];h||(h=new ot(Ce)),h=h.insert(u,d),s.Tc[s.currentUser.toKey()]=h}(r,i.batchId,t),yield wi(r,i.changes),yield ba(r.remoteStore)}catch(i){const s=Ta(i,"Failed to persist write");t.reject(s)}}),Sh.apply(this,arguments)}function Dp(n,e){return xh.apply(this,arguments)}function xh(){return xh=(0,f.Z)(function*(n,e){const t=se(n);try{const r=yield Jm(t.localStore,e);e.targetChanges.forEach((i,s)=>{const u=t.yc.get(s);u&&(ve(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.fc=!0:i.modifiedDocuments.size>0?ve(u.fc):i.removedDocuments.size>0&&(ve(u.fc),u.fc=!1))}),yield wi(t,r,e)}catch(r){yield Lr(r)}}),xh.apply(this,arguments)}function Rp(n,e,t){const r=se(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.wc.forEach((s,u)=>{const d=u.view.Mu(e);d.snapshot&&i.push(d.snapshot)}),function(s,u){const d=se(s);d.onlineState=u;let h=!1;d.queries.forEach((_,I)=>{for(const b of I.listeners)b.Mu(u)&&(h=!0)}),h&&Ih(d)}(r.eventManager,e),i.length&&r.dc.nu(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Og(n,e,t){return Ch.apply(this,arguments)}function Ch(){return Ch=(0,f.Z)(function*(n,e,t){const r=se(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.yc.get(e),s=i&&i.key;if(s){let u=new ot(ne.comparator);u=u.insert(s,mt.newNoDocument(s,Ee.min()));const d=ke().add(s),h=new o(Ee.min(),new Map,new ot(Ce),u,d);yield Dp(r,h),r.gc=r.gc.remove(s),r.yc.delete(e),Ph(r)}else yield Ia(r.localStore,e,!1).then(()=>xa(r,e,t)).catch(Lr)}),Ch.apply(this,arguments)}function Pg(n,e){return kh.apply(this,arguments)}function kh(){return kh=(0,f.Z)(function*(n,e){const t=se(n),r=e.batch.batchId;try{const i=yield Xm(t.localStore,e);Nh(t,r,null),Mh(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield wi(t,i)}catch(i){yield Lr(i)}}),kh.apply(this,arguments)}function Lg(n,e,t){return Dh.apply(this,arguments)}function Dh(){return Dh=(0,f.Z)(function*(n,e,t){const r=se(n);try{const i=yield function(s,u){const d=se(s);return d.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let _;return d.mutationQueue.lookupMutationBatch(h,u).next(I=>(ve(null!==I),_=I.keys(),d.mutationQueue.removeMutationBatch(h,I))).next(()=>d.mutationQueue.performConsistencyCheck(h)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(h,_,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,_)).next(()=>d.localDocuments.getDocuments(h,_))})}(r.localStore,e);Nh(r,e,t),Mh(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield wi(r,i)}catch(i){yield Lr(i)}}),Dh.apply(this,arguments)}function Rh(){return Rh=(0,f.Z)(function*(n,e){const t=se(n);ds(t.remoteStore)||Q("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(s){const u=se(s);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>u.mutationQueue.getHighestUnacknowledgedBatchId(d))}(t.localStore);if(-1===r)return void e.resolve();const i=t.Ec.get(r)||[];i.push(e),t.Ec.set(r,i)}catch(r){const i=Ta(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),Rh.apply(this,arguments)}function Mh(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function Nh(n,e,t){const r=se(n);let i=r.Tc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Tc[r.currentUser.toKey()]=i}}function xa(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||Mp(n,r)})}function Mp(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);null!==t&&(Hu(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),Ph(n))}function Oh(n,e,t){for(const r of t)r instanceof xp?(n.Ic.addReference(r.key,e),Ug(n,r)):r instanceof Cp?(Q("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||Mp(n,r.key)):he()}function Ug(n,e){const t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(Q("SyncEngine","New document in limbo: "+t),n.mc.add(r),Ph(n))}function Ph(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new ne(We.fromString(e)),r=n.Ac.next();n.yc.set(r,new kg(t)),n.gc=n.gc.insert(t,r),wl(n.remoteStore,new bi(vn(Yi(t.path)),r,"TargetPurposeLimboResolution",xn.ct))}}function wi(n,e,t){return Lh.apply(this,arguments)}function Lh(){return Lh=(0,f.Z)(function*(n,e,t){const r=se(n),i=[],s=[],u=[];var d;r.wc.isEmpty()||(r.wc.forEach((d,h)=>{u.push(r.Rc(h,e,t).then(_=>{if((_||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,_?.fromCache?"not-current":"current"),_){i.push(_);const I=Bd.Li(h.targetId,_);s.push(I)}}))}),yield Promise.all(u),r.dc.nu(i),yield(d=(0,f.Z)(function*(h,_){const I=se(h);try{yield I.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>O.forEach(_,N=>O.forEach(N.Fi,z=>I.persistence.referenceDelegate.addReference(b,N.targetId,z)).next(()=>O.forEach(N.Bi,z=>I.persistence.referenceDelegate.removeReference(b,N.targetId,z)))))}catch(b){if(!Fr(b))throw b;Q("LocalStore","Failed to update sequence numbers: "+b)}for(const b of _){const N=b.targetId;if(!b.fromCache){const z=I.Ji.get(N),de=z.withLastLimboFreeSnapshotVersion(z.snapshotVersion);I.Ji=I.Ji.insert(N,de)}}}),function(h,_){return d.apply(this,arguments)})(r.localStore,s))}),Lh.apply(this,arguments)}function Vg(n,e){return Fh.apply(this,arguments)}function Fh(){return Fh=(0,f.Z)(function*(n,e){const t=se(n);if(!t.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=yield op(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(u=>{u.forEach(d=>{d.reject(new $(L.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield wi(t,r.er)}var i}),Fh.apply(this,arguments)}function Bg(n,e){const t=se(n),r=t.yc.get(e);if(r&&r.fc)return ke().add(r.key);{let i=ke();const s=t._c.get(e);if(!s)return i;for(const u of s){const d=t.wc.get(u);i=i.unionWith(d.view.nc)}return i}}function zg(n,e){return Uh.apply(this,arguments)}function Uh(){return Uh=(0,f.Z)(function*(n,e){const t=se(n),r=yield yl(t.localStore,e.query,!0),i=e.view.hc(r);return t.isPrimaryClient&&Oh(t,e.targetId,i.cc),i}),Uh.apply(this,arguments)}function Gg(n,e){return Vh.apply(this,arguments)}function Vh(){return Vh=(0,f.Z)(function*(n,e){const t=se(n);return lp(t.localStore,e).then(r=>wi(t,r))}),Vh.apply(this,arguments)}function Kg(n,e,t,r){return Bh.apply(this,arguments)}function Bh(){return Bh=(0,f.Z)(function*(n,e,t,r){const i=se(n),s=yield function(u,d){const h=se(u),_=se(h.mutationQueue);return h.persistence.runTransaction("Lookup mutation documents","readonly",I=>_.Sn(I,d).next(b=>b?h.localDocuments.getDocuments(I,b):O.resolve(null)))}(i.localStore,e);var d;null!==s?("pending"===t?yield ba(i.remoteStore):"acknowledged"===t||"rejected"===t?(Nh(i,e,r||null),Mh(i,e),d=e,se(se(i.localStore).mutationQueue).Cn(d)):he(),yield wi(i,s)):Q("SyncEngine","Cannot apply mutation batch with id: "+e)}),Bh.apply(this,arguments)}function zh(){return zh=(0,f.Z)(function*(n,e){const t=se(n);if(Wh(t),$h(t),!0===e&&!0!==t.vc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Np(t,r.toArray());t.vc=!0,yield fh(t.remoteStore,!0);for(const s of i)wl(t.remoteStore,s)}else if(!1===e&&!1!==t.vc){const r=[];let i=Promise.resolve();t._c.forEach((s,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):i=i.then(()=>(xa(t,u),Ia(t.localStore,u,!0))),Hu(t.remoteStore,u)}),yield i,yield Np(t,r),function(s){const u=se(s);u.yc.forEach((d,h)=>{Hu(u.remoteStore,h)}),u.Ic.Ts(),u.yc=new Map,u.gc=new ot(ne.comparator)}(t),t.vc=!1,yield fh(t.remoteStore,!1)}}),zh.apply(this,arguments)}function Np(n,e,t){return Gh.apply(this,arguments)}function Gh(){return Gh=(0,f.Z)(function*(n,e,t){const r=se(n),i=[],s=[];for(const u of e){let d;const h=r._c.get(u);if(h&&0!==h.length){d=yield va(r.localStore,vn(h[0]));for(const _ of h){const I=r.wc.get(_),b=yield zg(r,I);b.snapshot&&s.push(b.snapshot)}}else{const _=yield cp(r.localStore,u);d=yield va(r.localStore,_),yield wh(r,Op(_),u,!1,d.resumeToken)}i.push(d)}return r.dc.nu(s),i}),Gh.apply(this,arguments)}function Op(n){return Eu(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Wg(n){const e=se(n);return se(se(e.localStore).persistence).$i()}function $g(n,e,t,r){return Kh.apply(this,arguments)}function Kh(){return Kh=(0,f.Z)(function*(n,e,t,r){const i=se(n);if(i.vc)return void Q("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const u=yield lp(i.localStore,ia(s[0])),d=o.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,jt.EMPTY_BYTE_STRING);yield wi(i,u,d);break}case"rejected":yield Ia(i.localStore,e,!0),xa(i,e,r);break;default:he()}}),Kh.apply(this,arguments)}function qg(n,e,t){return jh.apply(this,arguments)}function jh(){return jh=(0,f.Z)(function*(n,e,t){const r=Wh(n);if(r.vc){for(const i of e){if(r._c.has(i)){Q("SyncEngine","Adding an already active target "+i);continue}const s=yield cp(r.localStore,i),u=yield va(r.localStore,s);yield wh(r,Op(s),u.targetId,!1,u.resumeToken),wl(r.remoteStore,u)}for(const i of t)r._c.has(i)&&(yield Ia(r.localStore,i,!1).then(()=>{Hu(r.remoteStore,i),xa(r,i)}).catch(Lr))}}),jh.apply(this,arguments)}function Wh(n){const e=se(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bg.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Og.bind(null,e),e.dc.nu=Tg.bind(null,e.eventManager),e.dc.Pc=Ag.bind(null,e.eventManager),e}function $h(n){const e=se(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Pg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lg.bind(null,e),e}class Zu{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,f.Z)(function*(){t.serializer=$u(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return sp(this.persistence,new ip,e.initialUser,this.serializer)}createPersistence(e){return new Ld(ml.zs,this.serializer)}createSharedClientState(e){return new pp}terminate(){var e=this;return(0,f.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class qh extends Zu{constructor(e,t,r){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,f.Z)(function*(){yield t().call(r,e),yield r.Vc.initialize(r,e),yield $h(r.Vc.syncEngine),yield ba(r.Vc.remoteStore),yield r.persistence.Ii(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return sp(this.persistence,new ip,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new Zf(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new rd(t,this.persistence);return new nd(e.asyncQueue,r)}createPersistence(e){const t=Vd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Dn.withCacheSize(this.cacheSizeBytes):Dn.DEFAULT;return new Ud(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,gp(),bl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new pp}}class Pp extends qh{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,f.Z)(function*(){yield t().call(r,e);const i=r.Vc.syncEngine;r.sharedClientState instanceof Hd&&(r.sharedClientState.syncEngine={jr:Kg.bind(null,i),zr:$g.bind(null,i),Wr:qg.bind(null,i),$i:Wg.bind(null,i),Qr:Gg.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.Ii(function(){var s=(0,f.Z)(function*(u){yield function jg(n,e){return zh.apply(this,arguments)}(r.Vc.syncEngine,u),r.gcScheduler&&(u&&!r.gcScheduler.started?r.gcScheduler.start():u||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(u&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():u||r.indexBackfillerScheduler.stop())});return function(u){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=gp();if(!Hd.D(t))throw new $(L.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Vd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Hd(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ca{initialize(e,t){var r=this;return(0,f.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Rp(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Vg.bind(null,r.syncEngine),yield fh(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new wg}createDatastore(e){const t=$u(e.databaseInfo.databaseId),r=new og(e.databaseInfo);return new cg(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,s=d=>Rp(this.syncEngine,d,0),u=mp.D()?new mp:new rg,new hg(t,r,i,s,u);var t,r,i,s,u}createSyncEngine(e,t){return function(r,i,s,u,d,h,_){const I=new Dg(r,i,s,u,d,h);return _&&(I.vc=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,f.Z)(function*(t){const r=se(t);Q("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield Ea(r),r.Pu.shutdown(),r.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Lp(n,e=10240){let t=0;return{read:()=>(0,f.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,f.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Al{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Lt("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Qg{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new Kt,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,f.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,f.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,f.Z)(function*(){const t=yield e.kc();if(null===t)return null;const r=e.xc.decode(t),i=Number(r);isNaN(i)&&e.Mc(`length string (${r}) is not valid number`);const s=yield e.$c(i);return new Sg(JSON.parse(s),t.length+i)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,f.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}$c(e){var t=this;return(0,f.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const r=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,f.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class Yg{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,f.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new $(L.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,f.Z)(function*(s,u){const d=se(s),h=Ei(d.serializer)+"/documents",_={documents:u.map(z=>os(d.serializer,z))},I=yield d.vo("BatchGetDocuments",h,_,u.length),b=new Map;I.forEach(z=>{const X=function ym(n,e){return"found"in e?function(t,r){ve(!!r.found);const i=Wn(t,r.found.name),s=Dt(r.found.updateTime),u=r.found.createTime?Dt(r.found.createTime):Ee.min(),d=new on({mapValue:{fields:r.found.fields}});return mt.newFoundDocument(i,s,u,d)}(n,e):"missing"in e?function(t,r){ve(!!r.missing),ve(!!r.readTime);const i=Wn(t,r.missing),s=Dt(r.readTime);return mt.newNoDocument(i,s)}(n,e):he()}(d.serializer,z);b.set(X.key.toString(),X)});const N=[];return u.forEach(z=>{const X=b.get(z.toString());ve(!!X),N.push(X)}),N}),function(s,u){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new rs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,f.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=ne.fromPath(i);e.mutations.push(new Du(s,e.precondition(s)))}),yield(r=(0,f.Z)(function*(i,s){const u=se(i),d=Ei(u.serializer)+"/documents",h={writes:s.map(_=>Fu(u.serializer,_))};yield u.Io("Commit",d,h)}),function(i,s){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw he();t=Ee.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new $(L.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ee.min())?ft.exists(!1):ft.updateTime(t):ft.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ee.min()))throw new $(L.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ft.updateTime(t)}return ft.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Xg{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Bc=r.maxAttempts,this.qo=new Qd(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,f.Z)(function*(){const t=new Yg(e.datastore),r=e.qc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.Uc(s)}))}).catch(i=>{e.Uc(i)})}))}qc(e){try{const t=this.updateFunction(e);return!Gs(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!is(t)}return!1}}class Jg{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Pt.UNAUTHENTICATED,this.clientId=vc.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var u=(0,f.Z)(function*(d){Q("FirestoreClient","Received user=",d.uid),yield s.authCredentialListener(d),s.user=d});return function(d){return u.apply(this,arguments)}}()),this.appCheckCredentials.start(r,u=>(Q("FirestoreClient","Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}getConfiguration(){var e=this;return(0,f.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $(L.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,f.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Ta(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Sl(n,e){return Hh.apply(this,arguments)}function Hh(){return Hh=(0,f.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,f.Z)(function*(s){r.isEqual(s)||(yield op(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),Hh.apply(this,arguments)}function Zh(n,e){return Qh.apply(this,arguments)}function Qh(){return Qh=(0,f.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Yh(n);Q("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>wp(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>wp(e.remoteStore,s)),n._onlineComponents=e}),Qh.apply(this,arguments)}function Fp(n){return"FirebaseError"===n.name?n.code===L.FAILED_PRECONDITION||n.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Yh(n){return Xh.apply(this,arguments)}function Xh(){return Xh=(0,f.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Sl(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!Fp(t))throw t;jn("Error using user provided cache. Falling back to memory cache: "+t),yield Sl(n,new Zu)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),yield Sl(n,new Zu);return n._offlineComponents}),Xh.apply(this,arguments)}function xl(n){return Jh.apply(this,arguments)}function Jh(){return Jh=(0,f.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),yield Zh(n,n._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),yield Zh(n,new Ca))),n._onlineComponents}),Jh.apply(this,arguments)}function Up(n){return Yh(n).then(e=>e.persistence)}function Cl(n){return Yh(n).then(e=>e.localStore)}function Vp(n){return xl(n).then(e=>e.remoteStore)}function ef(n){return xl(n).then(e=>e.syncEngine)}function Bp(n){return xl(n).then(e=>e.datastore)}function ka(n){return tf.apply(this,arguments)}function tf(){return tf=(0,f.Z)(function*(n){const e=yield xl(n),t=e.eventManager;return t.onListen=Rg.bind(null,e.syncEngine),t.onUnlisten=Mg.bind(null,e.syncEngine),t}),tf.apply(this,arguments)}function zp(n,e,t={}){const r=new Kt;return n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return function(i,s,u,d,h){const _=new Al({next:b=>{s.enqueueAndForget(()=>yh(i,I));const N=b.docs.has(u);!N&&b.fromCache?h.reject(new $(L.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&b.fromCache&&d&&"server"===d.source?h.reject(new $(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(b)},error:b=>h.reject(b)}),I=new Eh(Yi(u.path),_,{includeMetadataChanges:!0,Ku:!0});return gh(i,I)}(yield ka(n),n.asyncQueue,e,t,r)})),r.promise}function Gp(n,e,t={}){const r=new Kt;return n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return function(i,s,u,d,h){const _=new Al({next:b=>{s.enqueueAndForget(()=>yh(i,I)),b.fromCache&&"server"===d.source?h.reject(new $(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(b)},error:b=>h.reject(b)}),I=new Eh(u,_,{includeMetadataChanges:!0,Ku:!0});return gh(i,I)}(yield ka(n),n.asyncQueue,e,t,r)})),r.promise}function Kp(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const jp=new Map;function nf(n,e,t){if(!t)throw new $(L.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Wp(n,e,t,r){if(!0===e&&!0===r)throw new $(L.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $p(n){if(!ne.isDocumentKey(n))throw new $(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function qp(n){if(ne.isDocumentKey(n))throw new $(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function kl(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":he()}function $e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new $(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=kl(n);throw new $(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Hp(n,e){if(e<=0)throw new $(L.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Zp{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new $(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new $(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Kp(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new $(L.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qu{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new $(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zp(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new yf;switch(t.type){case"firstParty":return new Jl(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new $(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=jp.get(e);t&&(Q("ComponentProvider","Removing Datastore"),jp.delete(e),t.terminate())}(this),Promise.resolve()}}function Qp(n,e,t,r={}){var i;const s=(n=$e(n,Qu))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&jn("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let u,d;if("string"==typeof r.mockUserToken)u=r.mockUserToken,d=Pt.MOCK_USER;else{u=(0,re.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new $(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Pt(h)}n._authCredentials=new Lo(new _c(u,d))}}class Vt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vt(this.firestore,e,this._key)}}class In{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new In(this.firestore,e,this._query)}}class Kr extends In{constructor(e,t,r){super(e,t,Yi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new ne(e))}withConverter(e){return new Kr(this.firestore,e,this._path)}}function u_(n,e,...t){if(n=(0,re.m9)(n),nf("collection","path",e),n instanceof Qu){const r=We.fromString(e,...t);return qp(r),new Kr(n,null,r)}{if(!(n instanceof Vt||n instanceof Kr))throw new $(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(We.fromString(e,...t));return qp(r),new Kr(n.firestore,null,r)}}function c_(n,e){if(n=$e(n,Qu),nf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new $(L.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new In(n,null,(t=e,new wr(We.emptyPath(),t)));var t}function Yp(n,e,...t){if(n=(0,re.m9)(n),1===arguments.length&&(e=vc.A()),nf("doc","path",e),n instanceof Qu){const r=We.fromString(e,...t);return $p(r),new Vt(n,null,new ne(r))}{if(!(n instanceof Vt||n instanceof Kr))throw new $(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(We.fromString(e,...t));return $p(r),new Vt(n.firestore,n instanceof Kr?n.converter:null,new ne(r))}}function l_(n,e){return n=(0,re.m9)(n),e=(0,re.m9)(e),(n instanceof Vt||n instanceof Kr)&&(e instanceof Vt||e instanceof Kr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function rf(n,e){return n=(0,re.m9)(n),e=(0,re.m9)(e),n instanceof In&&e instanceof In&&n.firestore===e.firestore&&Qs(n._query,e._query)&&n.converter===e.converter}class d_{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Qd(this,"async_queue_retry"),this.Xc=()=>{const t=bl();t&&Q("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=bl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=bl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new Kt;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,f.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!Fr(t))throw t;Q("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{throw this.Wc=r,this.Hc=!1,Lt("INTERNAL UNHANDLED ERROR: ",function(s){let u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),u}(r)),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=mh.createAndSchedule(this,e,t,r,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&he()}verifyOperationInProgress(){}sa(){var e=this;return(0,f.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function sf(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class h_{constructor(){this._progressObserver={},this._taskCompletionResolver=new Kt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const f_=-1;class Tt extends Qu{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new d_,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Xp(this),this._firestoreClient.terminate()}}function Wt(n){return n._firestoreClient||Xp(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Xp(n){var e,t,r;const i=n._freezeSettings(),s=(d=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Ho(n._databaseId,d,n._persistenceKey,(_=i).host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Kp(_.experimentalLongPollingOptions),_.useFetchStreams));var d,_;n._firestoreClient=new Jg(n._authCredentials,n._appCheckCredentials,n._queue,s),(null===(t=i.cache)||void 0===t?void 0:t._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function p_(n,e){em(n=$e(n,Tt));const t=Wt(n);if(t._uninitializedComponentsProvider)throw new $(L.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Ca;return Jp(t,i,new qh(i,r.cacheSizeBytes,e?.forceOwnership))}function m_(n){em(n=$e(n,Tt));const e=Wt(n);if(e._uninitializedComponentsProvider)throw new $(L.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Ca;return Jp(e,r,new Pp(r,t.cacheSizeBytes))}function Jp(n,e,t){const r=new Kt;return n.asyncQueue.enqueue((0,f.Z)(function*(){try{yield Sl(n,t),yield Zh(n,e),r.resolve()}catch(i){const s=i;if(!Fp(s))throw s;jn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function g_(n){if(n._initialized&&!n._terminated)throw new $(L.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Kt;return n._queue.enqueueAndForgetEvenWhileRestricted((0,f.Z)(function*(){try{yield(t=(0,f.Z)(function*(r){if(!Sn.D())return Promise.resolve();const i=r+"main";yield Sn.delete(i)}),function(r){return t.apply(this,arguments)})(Vd(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}function __(n){return function(e){const t=new Kt;return e.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return function Fg(n,e){return Rh.apply(this,arguments)}(yield ef(e),t)})),t.promise}(Wt(n=$e(n,Tt)))}function y_(n){return function e_(n){return n.asyncQueue.enqueue((0,f.Z)(function*(){const e=yield Up(n),t=yield Vp(n);return e.setNetworkEnabled(!0),function(r){const i=se(r);return i.vu.delete(0),qu(i)}(t)}))}(Wt(n=$e(n,Tt)))}function v_(n){return function t_(n){return n.asyncQueue.enqueue((0,f.Z)(function*(){const e=yield Up(n),t=yield Vp(n);return e.setNetworkEnabled(!1),(r=(0,f.Z)(function*(i){const s=se(i);s.vu.add(0),yield Ea(s),s.bu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Wt(n=$e(n,Tt)))}function I_(n,e){const t=Wt(n=$e(n,Tt)),r=new h_;return function s_(n,e,t,r){const i=function(s,u){let d;return d="string"==typeof s?fa().encode(s):s,h=function(h,_){if(h instanceof Uint8Array)return Lp(h,_);if(h instanceof ArrayBuffer)return Lp(new Uint8Array(h),_);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new Qg(h,u);var h}(t,$u(e));n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){!function Hg(n,e,t){const r=se(n);var i;(i=(0,f.Z)(function*(s,u,d){try{const h=yield u.getMetadata();if(yield function(N,z){const X=se(N),de=Dt(z.createTime);return X.persistence.runTransaction("hasNewerBundle","readonly",pe=>X.qs.getBundleMetadata(pe,z.id)).then(pe=>!!pe&&pe.createTime.compareTo(de)>=0)}(s.localStore,h))return yield u.close(),d._completeWith({taskState:"Success",documentsLoaded:(N=h).totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}),Promise.resolve(new Set);d._updateProgress(Sp(h));const _=new xg(h,s.localStore,u.serializer);let I=yield u.bc();for(;I;){const N=yield _.zu(I);N&&d._updateProgress(N),I=yield u.bc()}const b=yield _.complete();return yield wi(s,b.Ju,void 0),yield function(N,z){const X=se(N);return X.persistence.runTransaction("Save bundle","readwrite",de=>X.qs.saveBundleMetadata(de,z))}(s.localStore,h),d._completeWith(b.progress),Promise.resolve(b.Hu)}catch(h){return jn("SyncEngine",`Loading bundle failed with ${h}`),d._failWith(h),Promise.resolve(new Set)}var N}),function(s,u,d){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield ef(n),i,r)}))}(t,n._databaseId,e,r),r}function E_(n,e){return function o_(n,e){return n.asyncQueue.enqueue((0,f.Z)(function*(){return function(t,r){const i=se(t);return i.persistence.runTransaction("Get named query","readonly",s=>i.qs.getNamedQuery(s,r))}(yield Cl(n),e)}))}(Wt(n=$e(n,Tt)),e).then(t=>t?new In(n,null,t.query):null)}function em(n){if(n._initialized||n._terminated)throw new $(L.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Yu{constructor(e="count",t){this._aggregateType=e,this._internalFieldPath=t,this.type="AggregateField"}}class b_{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fs(jt.fromBase64String(e))}catch(t){throw new $(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fs(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ps{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new $(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ao{constructor(e){this._methodName=e}}class Dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}}const w_=/^__.*__$/;class T_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new hr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ns(e,this.data,t,this.fieldTransforms)}}class tm{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new hr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function nm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class Rl{constructor(e,t,r,i,s,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=u||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Rl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.fa(e),i}da(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Ol(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(nm(this.ca)&&w_.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class A_{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$u(e)}ya(e,t,r,i=!1){return new Rl({ca:e,methodName:t,ga:r,path:bt.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uo(n){const e=n._freezeSettings(),t=$u(n._databaseId);return new A_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ml(n,e,t,r,i,s={}){const u=n.ya(s.merge||s.mergeFields?2:0,e,t,i);cf("Data must be an object, but it was:",u,r);const d=sm(r,u);let h,_;if(s.merge)h=new Cn(u.fieldMask),_=u.fieldTransforms;else if(s.mergeFields){const I=[];for(const b of s.mergeFields){const N=Ju(e,b,t);if(!u.contains(N))throw new $(L.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);am(I,N)||I.push(N)}h=new Cn(I),_=u.fieldTransforms.filter(b=>h.covers(b.field))}else h=null,_=u.fieldTransforms;return new T_(new on(d),h,_)}class Xu extends ao{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xu}}function rm(n,e,t){return new Rl({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class of extends ao{_toFieldTransform(e){return new vi(e.path,new Ji)}isEqual(e){return e instanceof of}}class S_ extends ao{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=rm(this,e,!0),r=this.pa.map(s=>co(s,t)),i=new Gr(r);return new vi(e.path,i)}isEqual(e){return this===e}}class x_ extends ao{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=rm(this,e,!0),r=this.pa.map(s=>co(s,t)),i=new yi(r);return new vi(e.path,i)}isEqual(e){return this===e}}class C_ extends ao{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new es(e.serializer,Qc(e.serializer,this.Ia));return new vi(e.path,t)}isEqual(e){return this===e}}function af(n,e,t,r){const i=n.ya(1,e,t);cf("Data must be an object, but it was:",i,r);const s=[],u=on.empty();Ur(r,(h,_)=>{const I=Nl(e,h,t);_=(0,re.m9)(_);const b=i.da(I);if(_ instanceof Xu)s.push(I);else{const N=co(_,b);null!=N&&(s.push(I),u.set(I,N))}});const d=new Cn(s);return new tm(u,d,i.fieldTransforms)}function uf(n,e,t,r,i,s){const u=n.ya(1,e,t),d=[Ju(e,r,t)],h=[i];if(s.length%2!=0)throw new $(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let N=0;N<s.length;N+=2)d.push(Ju(e,s[N])),h.push(s[N+1]);const _=[],I=on.empty();for(let N=d.length-1;N>=0;--N)if(!am(_,d[N])){const z=d[N];let X=h[N];X=(0,re.m9)(X);const de=u.da(z);if(X instanceof Xu)_.push(z);else{const pe=co(X,de);null!=pe&&(_.push(z),I.set(z,pe))}}const b=new Cn(_);return new tm(I,b,u.fieldTransforms)}function im(n,e,t,r=!1){return co(t,n.ya(r?4:3,e))}function co(n,e){if(om(n=(0,re.m9)(n)))return cf("Unsupported field value:",e,n),sm(n,e);if(n instanceof ao)return function(t,r){if(!nm(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,r){const i=[];let s=0;for(const u of t){let d=co(u,r.wa(s));null==d&&(d={nullValue:"NULL_VALUE"}),i.push(d),s++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,re.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Qc(r.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=vt.fromDate(t);return{timestampValue:Ii(r.serializer,i)}}if(t instanceof vt){const i=new vt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ii(r.serializer,i)}}if(t instanceof Dl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof fs)return{bytesValue:pa(r.serializer,t._byteString)};if(t instanceof Vt){const i=r.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Js(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${kl(t)}`)}(n,e)}function sm(n,e){const t={};return $o(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ur(n,(r,i)=>{const s=co(i,e.ha(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function om(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof Dl||n instanceof fs||n instanceof Vt||n instanceof ao)}function cf(n,e,t){if(!om(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=kl(t);throw e._a("an object"===r?n+" a custom object":n+" "+r)}var r}function Ju(n,e,t){if((e=(0,re.m9)(e))instanceof ps)return e._internalPath;if("string"==typeof e)return Nl(n,e);throw Ol("Field path arguments must be of type string or ",n,!1,void 0,t)}const k_=new RegExp("[~\\*/\\[\\]]");function Nl(n,e,t){if(e.search(k_)>=0)throw Ol(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ps(...e.split("."))._internalPath}catch{throw Ol(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ol(n,e,t,r,i){const s=r&&!r.isEmpty(),u=void 0!==i;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(s||u)&&(h+=" (found",s&&(h+=` in field ${r}`),u&&(h+=` in document ${i}`),h+=")"),new $(L.INVALID_ARGUMENT,d+n+h)}function am(n,e){return n.some(t=>t.isEqual(e))}class ec{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new D_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class D_ extends ec{data(){return super.data()}}function Pl(n,e){return"string"==typeof e?Nl(n,e):e instanceof ps?e._internalPath:e._delegate._internalPath}function um(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new $(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lf{}class tc extends lf{}function R_(n,e,...t){let r=[];e instanceof lf&&r.push(e),r=r.concat(t),function(i){const s=i.filter(d=>d instanceof Da).length,u=i.filter(d=>d instanceof nc).length;if(s>1||s>0&&u>0)throw new $(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class nc extends tc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new nc(e,t,r)}_apply(e){const t=this._parse(e);return hm(e._query,t),new In(e.firestore,e.converter,Zs(e._query,t))}_parse(e){const t=uo(e.firestore);return function(i,s,u,d,h,_,I){let b;if(h.isKeyField()){if("array-contains"===_||"array-contains-any"===_)throw new $(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if("in"===_||"not-in"===_){dm(I,_);const N=[];for(const z of I)N.push(lm(d,i,z));b={arrayValue:{values:N}}}else b=lm(d,i,I)}else"in"!==_&&"not-in"!==_&&"array-contains-any"!==_||dm(I,_),b=im(u,"where",I,"in"===_||"not-in"===_);return Be.create(h,_,b)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function M_(n,e,t){const r=e,i=Pl("where",n);return nc._create(i,r,t)}class Da extends lf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Da(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:rt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,i){let s=r;const u=i.getFlattenedFilters();for(const d of u)hm(s,d),s=Zs(s,d)}(e._query,t),new In(e.firestore,e.converter,Zs(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class df extends tc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new df(e,t)}_apply(e){const t=function(r,i,s){if(null!==r.startAt)throw new $(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new $(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const u=new qi(i,s);return function(d,h){if(null===Tr(d)){const _=ta(d);null!==_&&fm(0,_,h.field)}}(r,u),u}(e._query,this._field,this._direction);return new In(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new wr(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function N_(n,e="asc"){const t=e,r=Pl("orderBy",n);return df._create(r,t)}class Ll extends tc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Ll(e,t,r)}_apply(e){return new In(e.firestore,e.converter,na(e._query,this._limit,this._limitType))}}function O_(n){return Hp("limit",n),Ll._create("limit",n,"F")}function P_(n){return Hp("limitToLast",n),Ll._create("limitToLast",n,"L")}class Fl extends tc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Fl(e,t,r)}_apply(e){const t=cm(e,this.type,this._docOrFields,this._inclusive);return new In(e.firestore,e.converter,(i=t,new wr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}function L_(...n){return Fl._create("startAt",n,!0)}function F_(...n){return Fl._create("startAfter",n,!1)}class Ul extends tc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ul(e,t,r)}_apply(e){const t=cm(e,this.type,this._docOrFields,this._inclusive);return new In(e.firestore,e.converter,(i=t,new wr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function U_(...n){return Ul._create("endBefore",n,!1)}function V_(...n){return Ul._create("endAt",n,!0)}function cm(n,e,t,r){if(t[0]=(0,re.m9)(t[0]),t[0]instanceof ec)return function(i,s,u,d,h){if(!d)throw new $(L.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const _=[];for(const I of Ar(i))if(I.field.isKeyField())_.push(pi(s,d.key));else{const b=d.data.field(I.field);if(ji(b))throw new $(L.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+I.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===b){const N=I.field.canonicalString();throw new $(L.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}_.push(b)}return new Br(_,h)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=uo(n.firestore);return function(s,u,d,h,_,I){const b=s.explicitOrderBy;if(_.length>b.length)throw new $(L.INVALID_ARGUMENT,`Too many arguments provided to ${h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let z=0;z<_.length;z++){const X=_[z];if(b[z].field.isKeyField()){if("string"!=typeof X)throw new $(L.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${h}(), but got a ${typeof X}`);if(!bu(s)&&-1!==X.indexOf("/"))throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${h}() must be a plain document ID, but '${X}' contains a slash.`);const de=s.path.child(We.fromString(X));if(!ne.isDocumentKey(de))throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${h}() must result in a valid document path, but '${de}' is not because it contains an odd number of segments.`);const pe=new ne(de);N.push(pi(u,pe))}else{const de=im(d,h,X);N.push(de)}}return new Br(N,I)}(n._query,n.firestore._databaseId,i,e,t,r)}}function lm(n,e,t){if("string"==typeof(t=(0,re.m9)(t))){if(""===t)throw new $(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bu(e)&&-1!==t.indexOf("/"))throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(We.fromString(t));if(!ne.isDocumentKey(r))throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pi(n,new ne(r))}if(t instanceof Vt)return pi(n,t._key);throw new $(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kl(t)}.`)}function dm(n,e){if(!Array.isArray(n)||0===n.length)throw new $(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hm(n,e){if(e.isInequality()){const r=ta(n),i=e.field;if(null!==r&&!r.isEqual(i))throw new $(L.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=Tr(n);null!==s&&fm(0,i,s)}const t=function(r,i){for(const s of r)for(const u of s.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new $(L.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function fm(n,e,t){if(!t.isEqual(e))throw new $(L.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class hf{convertValue(e,t="none"){switch(Vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw he()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ur(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Dl(kt(e.latitude),kt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=qo(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(hi(e));default:return null}}convertTimestamp(e){const t=cr(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=We.fromString(e);ve(Cf(r));const i=new lr(r.get(1),r.get(3)),s=new ne(r.popFirst(5));return i.isEqual(t)||Lt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Vl(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class B_ extends hf{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,t)}}class lo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ho extends ec{constructor(e,t,r,i,s,u){super(e,t,r,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new rc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Pl("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class rc extends ho{data(e={}){return super.data(e)}}class fo{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new lo(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new rc(this._firestore,this._userDataWriter,r.key,r,new lo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(u=>({type:"added",doc:new rc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new lo(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>i||3!==u.type).map(u=>{const d=new rc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new lo(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,_=-1;return 0!==u.type&&(h=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),1!==u.type&&(s=s.add(u.doc),_=s.indexOf(u.doc.key)),{type:G_(u.type),doc:d,oldIndex:h,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function G_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}function K_(n,e){return n instanceof ho&&e instanceof ho?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof fo&&e instanceof fo&&n._firestore===e._firestore&&rf(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function j_(n){n=$e(n,Vt);const e=$e(n.firestore,Tt);return zp(Wt(e),n._key).then(t=>ff(e,n,t))}class ms extends hf{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,t)}}function W_(n){n=$e(n,Vt);const e=$e(n.firestore,Tt),t=Wt(e),r=new ms(e);return function n_(n,e){const t=new Kt;return n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return(r=(0,f.Z)(function*(i,s,u){try{const d=yield function(h,_){const I=se(h);return I.persistence.runTransaction("read document","readonly",b=>I.localDocuments.getDocument(b,_))}(i,s);d.isFoundDocument()?u.resolve(d):d.isNoDocument()?u.resolve(null):u.reject(new $(L.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const h=Ta(d,`Failed to get document '${s} from cache`);u.reject(h)}}),function(i,s,u){return r.apply(this,arguments)})(yield Cl(n),e,t);var r})),t.promise}(t,n._key).then(i=>new ho(e,r,n._key,i,new lo(null!==i&&i.hasLocalMutations,!0),n.converter))}function $_(n){n=$e(n,Vt);const e=$e(n.firestore,Tt);return zp(Wt(e),n._key,{source:"server"}).then(t=>ff(e,n,t))}function q_(n){n=$e(n,In);const e=$e(n.firestore,Tt),t=Wt(e),r=new ms(e);return um(n._query),Gp(t,n._query).then(i=>new fo(e,r,n,i))}function H_(n){n=$e(n,In);const e=$e(n.firestore,Tt),t=Wt(e),r=new ms(e);return function r_(n,e){const t=new Kt;return n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return(r=(0,f.Z)(function*(i,s,u){try{const d=yield yl(i,s,!0),h=new kp(s,d.ir),_=h.sc(d.documents),I=h.applyChanges(_,!1);u.resolve(I.snapshot)}catch(d){const h=Ta(d,`Failed to execute query '${s} against cache`);u.reject(h)}}),function(i,s,u){return r.apply(this,arguments)})(yield Cl(n),e,t);var r})),t.promise}(t,n._query).then(i=>new fo(e,r,n,i))}function Z_(n){n=$e(n,In);const e=$e(n.firestore,Tt),t=Wt(e),r=new ms(e);return Gp(t,n._query,{source:"server"}).then(i=>new fo(e,r,n,i))}function Q_(n,e,t){n=$e(n,Vt);const r=$e(n.firestore,Tt),i=Vl(n.converter,e,t);return Ra(r,[Ml(uo(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,ft.none())])}function Y_(n,e,t,...r){n=$e(n,Vt);const i=$e(n.firestore,Tt),s=uo(i);let u;return u="string"==typeof(e=(0,re.m9)(e))||e instanceof ps?uf(s,"updateDoc",n._key,e,t,r):af(s,"updateDoc",n._key,e),Ra(i,[u.toMutation(n._key,ft.exists(!0))])}function X_(n){return Ra($e(n.firestore,Tt),[new rs(n._key,ft.none())])}function J_(n,e){const t=$e(n.firestore,Tt),r=Yp(n),i=Vl(n.converter,e);return Ra(t,[Ml(uo(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,ft.exists(!1))]).then(()=>r)}function ey(n,...e){var t,r,i;n=(0,re.m9)(n);let s={includeMetadataChanges:!1},u=0;"object"!=typeof e[u]||sf(e[u])||(s=e[u],u++);const d={includeMetadataChanges:s.includeMetadataChanges};if(sf(e[u])){const b=e[u];e[u]=null===(t=b.next)||void 0===t?void 0:t.bind(b),e[u+1]=null===(r=b.error)||void 0===r?void 0:r.bind(b),e[u+2]=null===(i=b.complete)||void 0===i?void 0:i.bind(b)}let h,_,I;if(n instanceof Vt)_=$e(n.firestore,Tt),I=Yi(n._key.path),h={next:b=>{e[u]&&e[u](ff(_,n,b))},error:e[u+1],complete:e[u+2]};else{const b=$e(n,In);_=$e(b.firestore,Tt),I=b._query;const N=new ms(_);h={next:z=>{e[u]&&e[u](new fo(_,N,b,z))},error:e[u+1],complete:e[u+2]},um(n._query)}return function(b,N,z,X){const de=new Al(X),pe=new Eh(N,de,z);return b.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return gh(yield ka(b),pe)})),()=>{de.Dc(),b.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return yh(yield ka(b),pe)}))}}(Wt(_),I,d,h)}function ty(n,e){return function i_(n,e){const t=new Al(e);return n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return r=yield ka(n),i=t,se(r).ku.add(i),void i.next();var r,i})),()=>{t.Dc(),n.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return r=yield ka(n),i=t,void se(r).ku.delete(i);var r,i}))}}(Wt(n=$e(n,Tt)),sf(e)?e:{next:e})}function Ra(n,e){return function(t,r){const i=new Kt;return t.asyncQueue.enqueueAndForget((0,f.Z)(function*(){return function Ng(n,e,t){return Sh.apply(this,arguments)}(yield ef(t),r,i)})),i.promise}(Wt(n),e)}function ff(n,e,t){const r=t.docs.get(e._key),i=new ms(n);return new ho(n,i,e._key,r,new lo(t.hasPendingWrites,t.fromCache),e.converter)}function ny(n){return function ry(n,e){const t=$e(n.firestore,Tt),r=Wt(t),i=function(s,u){const d=[];for(const h in s)Object.prototype.hasOwnProperty.call(s,h)&&d.push(u(s[h],h));return d}(e,(s,u)=>new Mu(u,s._aggregateType,s._internalFieldPath));return function(s,u,d){const h=new Kt;return s.asyncQueue.enqueueAndForget((0,f.Z)(function*(){try{const _=yield Bp(s);h.resolve(function lg(n,e,t){return Yd.apply(this,arguments)}(_,u,d))}catch(_){h.reject(_)}})),h.promise}(r,n._query,i).then(s=>function(u,d,h){const _=new ms(u);return new b_(d,_,h)}(t,n,s))}(n,{count:new Yu("count")})}const dy={maxAttempts:5};class mm{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=uo(e)}set(e,t,r){this._verifyNotCommitted();const i=gs(e,this._firestore),s=Vl(i.converter,t,r),u=Ml(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(u.toMutation(i._key,ft.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=gs(e,this._firestore);let u;return u="string"==typeof(t=(0,re.m9)(t))||t instanceof ps?uf(this._dataReader,"WriteBatch.update",s._key,t,r,i):af(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(u.toMutation(s._key,ft.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=gs(e,this._firestore);return this._mutations=this._mutations.concat(new rs(t._key,ft.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $(L.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function gs(n,e){if((n=(0,re.m9)(n)).firestore!==e)throw new $(L.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class hy extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=uo(e)}get(e){const t=gs(e,this._firestore),r=new B_(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return he();const s=i[0];if(s.isFoundDocument())return new ec(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new ec(this._firestore,r,t._key,null,t.converter);throw he()})}set(e,t,r){const i=gs(e,this._firestore),s=Vl(i.converter,t,r),u=Ml(this._dataReader,"Transaction.set",i._key,s,null!==i.converter,r);return this._transaction.set(i._key,u),this}update(e,t,r,...i){const s=gs(e,this._firestore);let u;return u="string"==typeof(t=(0,re.m9)(t))||t instanceof ps?uf(this._dataReader,"Transaction.update",s._key,t,r,i):af(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,u),this}delete(e){const t=gs(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=gs(e,this._firestore),r=new ms(this._firestore);return super.get(e).then(i=>new ho(this._firestore,r,t._key,i._document,new lo(!1,!1),t.converter))}}function fy(n,e,t){n=$e(n,Tt);const r=Object.assign(Object.assign({},dy),t);return function(i){if(i.maxAttempts<1)throw new $(L.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,u){const d=new Kt;return i.asyncQueue.enqueueAndForget((0,f.Z)(function*(){const h=yield Bp(i);new Xg(i.asyncQueue,h,u,s,d).run()})),d.promise}(Wt(n),i=>e(new hy(n,i)),r)}function py(){return new Xu("deleteField")}function my(){return new of("serverTimestamp")}function gy(...n){return new S_("arrayUnion",n)}function _y(...n){return new x_("arrayRemove",n)}function yy(n){return new C_("increment",n)}!function(n,e=!0){Kn=j.SDK_VERSION,(0,j._registerComponent)(new P.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const s=t.getProvider("app").getImmediate(),u=new Tt(new vf(t.getProvider("auth-internal")),new Bs(t.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lr(d.options.projectId,h)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),u._setSettings(i),u},"PUBLIC").setMultipleInstances(!0)),(0,j.registerVersion)(Ql,"3.12.0",n),(0,j.registerVersion)(Ql,"3.12.0","esm2017")}()},9378:(Bt,Ne,C)=>{C.d(Ne,{B:()=>V});var f=C(5577),j=C(9646),P=C(4004),me=C(8996),re=C(4650),_e=C(1205),ye=C(8179),U=C(7977);let ie=(()=>{class ae{constructor(H){this.fireStore=H,this._collectionName="users"}create(H){const{firstName:le,lastName:te}=H;return(0,me.D)(this.fireStore.doc(`${this._collectionName}/${H.id}`).set({firstName:le,lastName:te}))}get(H){return this.fireStore.collection(this._collectionName).doc(H).valueChanges()}getCount(){const H=(0,ye.hJ)(this.fireStore.firestore,this._collectionName);return(0,me.D)((0,ye.Yp)(H)).pipe((0,P.U)(le=>le.data().count))}}return ae.\u0275fac=function(H){return new(H||ae)(re.LFG(U.ST))},ae.\u0275prov=re.Yz7({token:ae,factory:ae.\u0275fac,providedIn:"root"}),ae})(),V=(()=>{class ae{constructor(H,le){this.fireAuth=H,this.usersService=le}get userInfo$(){let H;return this.fireAuth.authState.pipe((0,f.z)(le=>(H={email:le?le.email:null,id:le?le.uid:null,isAuthenticated:!!le},le?this.usersService.get(le?.uid):(0,j.of)(null))),(0,P.U)(le=>({...H,...le})))}login(H){return(0,me.D)(this.fireAuth.signInWithEmailAndPassword(H.email,H.password))}signUp(H){const{email:le,password:te}=H;let ue;return(0,me.D)(this.fireAuth.createUserWithEmailAndPassword(le,te)).pipe((0,f.z)(De=>(ue=De,H.id=De.user?.uid,this.usersService.create(H))),(0,P.U)(De=>ue))}signOut(){return(0,me.D)(this.fireAuth.signOut())}}return ae.\u0275fac=function(H){return new(H||ae)(re.LFG(_e.zQ),re.LFG(ie))},ae.\u0275prov=re.Yz7({token:ae,factory:ae.\u0275fac,providedIn:"root"}),ae})()},4128:(Bt,Ne,C)=>{C.d(Ne,{D:()=>U});var f=C(9751),j=C(4742),P=C(8421),me=C(3269),re=C(5403),_e=C(3268),ye=C(1810);function U(...ie){const V=(0,me.jO)(ie),{args:ae,keys:Z}=(0,j.D)(ie),H=new f.y(le=>{const{length:te}=ae;if(!te)return void le.complete();const ue=new Array(te);let De=te,it=te;for(let F=0;F<te;F++){let Ze=!1;(0,P.Xf)(ae[F]).subscribe((0,re.x)(le,we=>{Ze||(Ze=!0,it--),ue[F]=we},()=>De--,void 0,()=>{(!De||!Ze)&&(it||le.next(Z?(0,ye.n)(Z,ue):ue),le.complete())}))}});return V?H.pipe((0,_e.Z)(V)):H}},4968:(Bt,Ne,C)=>{C.d(Ne,{R:()=>V});var f=C(8421),j=C(9751),P=C(5577),me=C(1144),re=C(576),_e=C(3268);const ye=["addListener","removeListener"],U=["addEventListener","removeEventListener"],ie=["on","off"];function V(te,ue,De,it){if((0,re.m)(De)&&(it=De,De=void 0),it)return V(te,ue,De).pipe((0,_e.Z)(it));const[F,Ze]=function le(te){return(0,re.m)(te.addEventListener)&&(0,re.m)(te.removeEventListener)}(te)?U.map(we=>J=>te[we](ue,J,De)):function Z(te){return(0,re.m)(te.addListener)&&(0,re.m)(te.removeListener)}(te)?ye.map(ae(te,ue)):function H(te){return(0,re.m)(te.on)&&(0,re.m)(te.off)}(te)?ie.map(ae(te,ue)):[];if(!F&&(0,me.z)(te))return(0,P.z)(we=>V(we,ue,De))((0,f.Xf)(te));if(!F)throw new TypeError("Invalid event target");return new j.y(we=>{const J=(...oe)=>we.next(1<oe.length?oe:oe[0]);return F(J),()=>Ze(J)})}function ae(te,ue){return De=>it=>te[De](ue,it)}},8372:(Bt,Ne,C)=>{C.d(Ne,{b:()=>me});var f=C(4986),j=C(4482),P=C(5403);function me(re,_e=f.z){return(0,j.e)((ye,U)=>{let ie=null,V=null,ae=null;const Z=()=>{if(ie){ie.unsubscribe(),ie=null;const le=V;V=null,U.next(le)}};function H(){const le=ae+re,te=_e.now();if(te<le)return ie=this.schedule(void 0,le-te),void U.add(ie);Z()}ye.subscribe((0,P.x)(U,le=>{V=le,ae=_e.now(),ie||(ie=_e.schedule(H,re),U.add(ie))},()=>{Z(),U.complete()},void 0,()=>{V=ie=null}))})}},1884:(Bt,Ne,C)=>{C.d(Ne,{x:()=>me});var f=C(4671),j=C(4482),P=C(5403);function me(_e,ye=f.y){return _e=_e??re,(0,j.e)((U,ie)=>{let V,ae=!0;U.subscribe((0,P.x)(ie,Z=>{const H=ye(Z);(ae||!_e(V,H))&&(ae=!1,V=H,ie.next(Z))}))})}function re(_e,ye){return _e===ye}},5684:(Bt,Ne,C)=>{C.d(Ne,{T:()=>j});var f=C(9300);function j(P){return(0,f.h)((me,re)=>P<=re)}},2722:(Bt,Ne,C)=>{C.d(Ne,{R:()=>re});var f=C(4482),j=C(5403),P=C(8421),me=C(5032);function re(_e){return(0,f.e)((ye,U)=>{(0,P.Xf)(_e).subscribe((0,j.x)(U,()=>U.complete(),me.Z)),!U.closed&&ye.subscribe(U)})}},2687:(Bt,Ne,C)=>{C.d(Ne,{$s:()=>Qe,Em:()=>zt,Kd:()=>tn,X6:()=>pt,ic:()=>Re,qV:()=>st,qm:()=>A,rt:()=>T,s1:()=>gt,tE:()=>qn,yG:()=>fn});var f=C(6895),j=C(4650),P=C(3353),me=C(7579),re=C(727),_e=C(1135),ye=C(9646),U=C(9521),ie=C(8505),V=C(8372),ae=C(9300),Z=C(4004),H=C(5698),le=C(5684),te=C(1884),ue=C(2722),De=C(1281),it=C(9643),F=C(2289);function oe(p,g){return(p.getAttribute(g)||"").match(/\S+/g)||[]}const Se="cdk-describedby-message",Xe="cdk-describedby-host";let B=0,Qe=(()=>{class p{constructor(y,E){this._platform=E,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+B++,this._document=y,this._id=(0,j.f3M)(j.AFp)+"-"+B++}describe(y,E,D){if(!this._canBeDescribed(y,E))return;const W=be(E,D);"string"!=typeof E?(at(E,this._id),this._messageRegistry.set(W,{messageElement:E,referenceCount:0})):this._messageRegistry.has(W)||this._createMessageElement(E,D),this._isElementDescribedByMessage(y,W)||this._addMessageReference(y,W)}removeDescription(y,E,D){if(!E||!this._isElementNode(y))return;const W=be(E,D);if(this._isElementDescribedByMessage(y,W)&&this._removeMessageReference(y,W),"string"==typeof E){const ce=this._messageRegistry.get(W);ce&&0===ce.referenceCount&&this._deleteMessageElement(W)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const y=this._document.querySelectorAll(`[${Xe}="${this._id}"]`);for(let E=0;E<y.length;E++)this._removeCdkDescribedByReferenceIds(y[E]),y[E].removeAttribute(Xe);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(y,E){const D=this._document.createElement("div");at(D,this._id),D.textContent=y,E&&D.setAttribute("role",E),this._createMessagesContainer(),this._messagesContainer.appendChild(D),this._messageRegistry.set(be(y,E),{messageElement:D,referenceCount:0})}_deleteMessageElement(y){this._messageRegistry.get(y)?.messageElement?.remove(),this._messageRegistry.delete(y)}_createMessagesContainer(){if(this._messagesContainer)return;const y="cdk-describedby-message-container",E=this._document.querySelectorAll(`.${y}[platform="server"]`);for(let W=0;W<E.length;W++)E[W].remove();const D=this._document.createElement("div");D.style.visibility="hidden",D.classList.add(y),D.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&D.setAttribute("platform","server"),this._document.body.appendChild(D),this._messagesContainer=D}_removeCdkDescribedByReferenceIds(y){const E=oe(y,"aria-describedby").filter(D=>0!=D.indexOf(Se));y.setAttribute("aria-describedby",E.join(" "))}_addMessageReference(y,E){const D=this._messageRegistry.get(E);(function we(p,g,y){const E=oe(p,g);E.some(D=>D.trim()==y.trim())||(E.push(y.trim()),p.setAttribute(g,E.join(" ")))})(y,"aria-describedby",D.messageElement.id),y.setAttribute(Xe,this._id),D.referenceCount++}_removeMessageReference(y,E){const D=this._messageRegistry.get(E);D.referenceCount--,function J(p,g,y){const D=oe(p,g).filter(W=>W!=y.trim());D.length?p.setAttribute(g,D.join(" ")):p.removeAttribute(g)}(y,"aria-describedby",D.messageElement.id),y.removeAttribute(Xe)}_isElementDescribedByMessage(y,E){const D=oe(y,"aria-describedby"),W=this._messageRegistry.get(E),ce=W&&W.messageElement.id;return!!ce&&-1!=D.indexOf(ce)}_canBeDescribed(y,E){if(!this._isElementNode(y))return!1;if(E&&"object"==typeof E)return!0;const D=null==E?"":`${E}`.trim(),W=y.getAttribute("aria-label");return!(!D||W&&W.trim()===D)}_isElementNode(y){return y.nodeType===this._document.ELEMENT_NODE}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(f.K0),j.LFG(P.t4))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function be(p,g){return"string"==typeof p?`${g||""}/${p}`:p}function at(p,g){p.id||(p.id=`${Se}-${g}-${B++}`)}class dt{constructor(g){this._items=g,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new me.x,this._typeaheadSubscription=re.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=y=>y.disabled,this._pressedLetters=[],this.tabOut=new me.x,this.change=new me.x,g instanceof j.n_E&&g.changes.subscribe(y=>{if(this._activeItem){const D=y.toArray().indexOf(this._activeItem);D>-1&&D!==this._activeItemIndex&&(this._activeItemIndex=D)}})}skipPredicate(g){return this._skipPredicateFn=g,this}withWrap(g=!0){return this._wrap=g,this}withVerticalOrientation(g=!0){return this._vertical=g,this}withHorizontalOrientation(g){return this._horizontal=g,this}withAllowedModifierKeys(g){return this._allowedModifierKeys=g,this}withTypeAhead(g=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,ie.b)(y=>this._pressedLetters.push(y)),(0,V.b)(g),(0,ae.h)(()=>this._pressedLetters.length>0),(0,Z.U)(()=>this._pressedLetters.join(""))).subscribe(y=>{const E=this._getItemsArray();for(let D=1;D<E.length+1;D++){const W=(this._activeItemIndex+D)%E.length,ce=E[W];if(!this._skipPredicateFn(ce)&&0===ce.getLabel().toUpperCase().trim().indexOf(y)){this.setActiveItem(W);break}}this._pressedLetters=[]}),this}withHomeAndEnd(g=!0){return this._homeAndEnd=g,this}setActiveItem(g){const y=this._activeItem;this.updateActiveItem(g),this._activeItem!==y&&this.change.next(this._activeItemIndex)}onKeydown(g){const y=g.keyCode,D=["altKey","ctrlKey","metaKey","shiftKey"].every(W=>!g[W]||this._allowedModifierKeys.indexOf(W)>-1);switch(y){case U.Mf:return void this.tabOut.next();case U.JH:if(this._vertical&&D){this.setNextItemActive();break}return;case U.LH:if(this._vertical&&D){this.setPreviousItemActive();break}return;case U.SV:if(this._horizontal&&D){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case U.oh:if(this._horizontal&&D){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case U.Sd:if(this._homeAndEnd&&D){this.setFirstItemActive();break}return;case U.uR:if(this._homeAndEnd&&D){this.setLastItemActive();break}return;default:return void((D||(0,U.Vb)(g,"shiftKey"))&&(g.key&&1===g.key.length?this._letterKeyStream.next(g.key.toLocaleUpperCase()):(y>=U.A&&y<=U.Z||y>=U.xE&&y<=U.aO)&&this._letterKeyStream.next(String.fromCharCode(y))))}this._pressedLetters=[],g.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(g){const y=this._getItemsArray(),E="number"==typeof g?g:y.indexOf(g);this._activeItem=y[E]??null,this._activeItemIndex=E}_setActiveItemByDelta(g){this._wrap?this._setActiveInWrapMode(g):this._setActiveInDefaultMode(g)}_setActiveInWrapMode(g){const y=this._getItemsArray();for(let E=1;E<=y.length;E++){const D=(this._activeItemIndex+g*E+y.length)%y.length;if(!this._skipPredicateFn(y[D]))return void this.setActiveItem(D)}}_setActiveInDefaultMode(g){this._setActiveItemByIndex(this._activeItemIndex+g,g)}_setActiveItemByIndex(g,y){const E=this._getItemsArray();if(E[g]){for(;this._skipPredicateFn(E[g]);)if(!E[g+=y])return;this.setActiveItem(g)}}_getItemsArray(){return this._items instanceof j.n_E?this._items.toArray():this._items}}class gt extends dt{setActiveItem(g){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(g),this.activeItem&&this.activeItem.setActiveStyles()}}class zt extends dt{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(g){return this._origin=g,this}setActiveItem(g){super.setActiveItem(g),this.activeItem&&this.activeItem.focus(this._origin)}}let Re=(()=>{class p{constructor(y){this._platform=y}isDisabled(y){return y.hasAttribute("disabled")}isVisible(y){return function xe(p){return!!(p.offsetWidth||p.offsetHeight||"function"==typeof p.getClientRects&&p.getClientRects().length)}(y)&&"visible"===getComputedStyle(y).visibility}isTabbable(y){if(!this._platform.isBrowser)return!1;const E=function Pe(p){try{return p.frameElement}catch{return null}}(function Nt(p){return p.ownerDocument&&p.ownerDocument.defaultView||window}(y));if(E&&(-1===Mt(E)||!this.isVisible(E)))return!1;let D=y.nodeName.toLowerCase(),W=Mt(y);return y.hasAttribute("contenteditable")?-1!==W:!("iframe"===D||"object"===D||this._platform.WEBKIT&&this._platform.IOS&&!function et(p){let g=p.nodeName.toLowerCase(),y="input"===g&&p.type;return"text"===y||"password"===y||"select"===g||"textarea"===g}(y))&&("audio"===D?!!y.hasAttribute("controls")&&-1!==W:"video"===D?-1!==W&&(null!==W||this._platform.FIREFOX||y.hasAttribute("controls")):y.tabIndex>=0)}isFocusable(y,E){return function It(p){return!function Je(p){return function Ie(p){return"input"==p.nodeName.toLowerCase()}(p)&&"hidden"==p.type}(p)&&(function Fe(p){let g=p.nodeName.toLowerCase();return"input"===g||"select"===g||"button"===g||"textarea"===g}(p)||function Te(p){return function Ge(p){return"a"==p.nodeName.toLowerCase()}(p)&&p.hasAttribute("href")}(p)||p.hasAttribute("contenteditable")||Ke(p))}(y)&&!this.isDisabled(y)&&(E?.ignoreVisibility||this.isVisible(y))}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(P.t4))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function Ke(p){if(!p.hasAttribute("tabindex")||void 0===p.tabIndex)return!1;let g=p.getAttribute("tabindex");return!(!g||isNaN(parseInt(g,10)))}function Mt(p){if(!Ke(p))return null;const g=parseInt(p.getAttribute("tabindex")||"",10);return isNaN(g)?-1:g}class un{constructor(g,y,E,D,W=!1){this._element=g,this._checker=y,this._ngZone=E,this._document=D,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,W||this.attachAnchors()}get enabled(){return this._enabled}set enabled(g){this._enabled=g,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(g,this._startAnchor),this._toggleAnchorTabIndex(g,this._endAnchor))}destroy(){const g=this._startAnchor,y=this._endAnchor;g&&(g.removeEventListener("focus",this.startAnchorListener),g.remove()),y&&(y.removeEventListener("focus",this.endAnchorListener),y.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(g){return new Promise(y=>{this._executeOnStable(()=>y(this.focusInitialElement(g)))})}focusFirstTabbableElementWhenReady(g){return new Promise(y=>{this._executeOnStable(()=>y(this.focusFirstTabbableElement(g)))})}focusLastTabbableElementWhenReady(g){return new Promise(y=>{this._executeOnStable(()=>y(this.focusLastTabbableElement(g)))})}_getRegionBoundary(g){const y=this._element.querySelectorAll(`[cdk-focus-region-${g}], [cdkFocusRegion${g}], [cdk-focus-${g}]`);return"start"==g?y.length?y[0]:this._getFirstTabbableElement(this._element):y.length?y[y.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(g){const y=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(y){if(!this._checker.isFocusable(y)){const E=this._getFirstTabbableElement(y);return E?.focus(g),!!E}return y.focus(g),!0}return this.focusFirstTabbableElement(g)}focusFirstTabbableElement(g){const y=this._getRegionBoundary("start");return y&&y.focus(g),!!y}focusLastTabbableElement(g){const y=this._getRegionBoundary("end");return y&&y.focus(g),!!y}hasAttached(){return this._hasAttached}_getFirstTabbableElement(g){if(this._checker.isFocusable(g)&&this._checker.isTabbable(g))return g;const y=g.children;for(let E=0;E<y.length;E++){const D=y[E].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(y[E]):null;if(D)return D}return null}_getLastTabbableElement(g){if(this._checker.isFocusable(g)&&this._checker.isTabbable(g))return g;const y=g.children;for(let E=y.length-1;E>=0;E--){const D=y[E].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(y[E]):null;if(D)return D}return null}_createAnchor(){const g=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,g),g.classList.add("cdk-visually-hidden"),g.classList.add("cdk-focus-trap-anchor"),g.setAttribute("aria-hidden","true"),g}_toggleAnchorTabIndex(g,y){g?y.setAttribute("tabindex","0"):y.removeAttribute("tabindex")}toggleAnchors(g){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(g,this._startAnchor),this._toggleAnchorTabIndex(g,this._endAnchor))}_executeOnStable(g){this._ngZone.isStable?g():this._ngZone.onStable.pipe((0,H.q)(1)).subscribe(g)}}let st=(()=>{class p{constructor(y,E,D){this._checker=y,this._ngZone=E,this._document=D}create(y,E=!1){return new un(y,this._checker,this._ngZone,this._document,E)}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(Re),j.LFG(j.R0b),j.LFG(f.K0))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function pt(p){return 0===p.buttons||0===p.offsetX&&0===p.offsetY}function fn(p){const g=p.touches&&p.touches[0]||p.changedTouches&&p.changedTouches[0];return!(!g||-1!==g.identifier||null!=g.radiusX&&1!==g.radiusX||null!=g.radiusY&&1!==g.radiusY)}const Fn=new j.OlP("cdk-input-modality-detector-options"),pn={ignoreKeys:[U.zL,U.jx,U.b2,U.MW,U.JU]},Ot=(0,P.i$)({passive:!0,capture:!0});let En=(()=>{class p{constructor(y,E,D,W){this._platform=y,this._mostRecentTarget=null,this._modality=new _e.X(null),this._lastTouchMs=0,this._onKeydown=ce=>{this._options?.ignoreKeys?.some(Ue=>Ue===ce.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,P.sA)(ce))},this._onMousedown=ce=>{Date.now()-this._lastTouchMs<650||(this._modality.next(pt(ce)?"keyboard":"mouse"),this._mostRecentTarget=(0,P.sA)(ce))},this._onTouchstart=ce=>{fn(ce)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,P.sA)(ce))},this._options={...pn,...W},this.modalityDetected=this._modality.pipe((0,le.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,te.x)()),y.isBrowser&&E.runOutsideAngular(()=>{D.addEventListener("keydown",this._onKeydown,Ot),D.addEventListener("mousedown",this._onMousedown,Ot),D.addEventListener("touchstart",this._onTouchstart,Ot)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Ot),document.removeEventListener("mousedown",this._onMousedown,Ot),document.removeEventListener("touchstart",this._onTouchstart,Ot))}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(P.t4),j.LFG(j.R0b),j.LFG(f.K0),j.LFG(Fn,8))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const St=new j.OlP("liveAnnouncerElement",{providedIn:"root",factory:function Ht(){return null}}),bn=new j.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let tn=(()=>{class p{constructor(y,E,D,W){this._ngZone=E,this._defaultOptions=W,this._document=D,this._liveElement=y||this._createLiveElement()}announce(y,...E){const D=this._defaultOptions;let W,ce;return 1===E.length&&"number"==typeof E[0]?ce=E[0]:[W,ce]=E,this.clear(),clearTimeout(this._previousTimeout),W||(W=D&&D.politeness?D.politeness:"polite"),null==ce&&D&&(ce=D.duration),this._liveElement.setAttribute("aria-live",W),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(Ue=>this._currentResolve=Ue)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=y,"number"==typeof ce&&(this._previousTimeout=setTimeout(()=>this.clear(),ce)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const y="cdk-live-announcer-element",E=this._document.getElementsByClassName(y),D=this._document.createElement("div");for(let W=0;W<E.length;W++)E[W].remove();return D.classList.add(y),D.classList.add("cdk-visually-hidden"),D.setAttribute("aria-atomic","true"),D.setAttribute("aria-live","polite"),this._document.body.appendChild(D),D}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(St,8),j.LFG(j.R0b),j.LFG(f.K0),j.LFG(bn,8))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const nn=new j.OlP("cdk-focus-monitor-default-options"),rn=(0,P.i$)({passive:!0,capture:!0});let qn=(()=>{class p{constructor(y,E,D,W,ce){this._ngZone=y,this._platform=E,this._inputModalityDetector=D,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new me.x,this._rootNodeFocusAndBlurListener=Ue=>{for(let Rt=(0,P.sA)(Ue);Rt;Rt=Rt.parentElement)"focus"===Ue.type?this._onFocus(Ue,Rt):this._onBlur(Ue,Rt)},this._document=W,this._detectionMode=ce?.detectionMode||0}monitor(y,E=!1){const D=(0,De.fI)(y);if(!this._platform.isBrowser||1!==D.nodeType)return(0,ye.of)(null);const W=(0,P.kV)(D)||this._getDocument(),ce=this._elementInfo.get(D);if(ce)return E&&(ce.checkChildren=!0),ce.subject;const Ue={checkChildren:E,subject:new me.x,rootNode:W};return this._elementInfo.set(D,Ue),this._registerGlobalListeners(Ue),Ue.subject}stopMonitoring(y){const E=(0,De.fI)(y),D=this._elementInfo.get(E);D&&(D.subject.complete(),this._setClasses(E),this._elementInfo.delete(E),this._removeGlobalListeners(D))}focusVia(y,E,D){const W=(0,De.fI)(y);W===this._getDocument().activeElement?this._getClosestElementsInfo(W).forEach(([Ue,cn])=>this._originChanged(Ue,E,cn)):(this._setOrigin(E),"function"==typeof W.focus&&W.focus(D))}ngOnDestroy(){this._elementInfo.forEach((y,E)=>this.stopMonitoring(E))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(y){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(y)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:y&&this._isLastInteractionFromInputLabel(y)?"mouse":"program"}_shouldBeAttributedToTouch(y){return 1===this._detectionMode||!!y?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(y,E){y.classList.toggle("cdk-focused",!!E),y.classList.toggle("cdk-touch-focused","touch"===E),y.classList.toggle("cdk-keyboard-focused","keyboard"===E),y.classList.toggle("cdk-mouse-focused","mouse"===E),y.classList.toggle("cdk-program-focused","program"===E)}_setOrigin(y,E=!1){this._ngZone.runOutsideAngular(()=>{this._origin=y,this._originFromTouchInteraction="touch"===y&&E,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(y,E){const D=this._elementInfo.get(E),W=(0,P.sA)(y);!D||!D.checkChildren&&E!==W||this._originChanged(E,this._getFocusOrigin(W),D)}_onBlur(y,E){const D=this._elementInfo.get(E);!D||D.checkChildren&&y.relatedTarget instanceof Node&&E.contains(y.relatedTarget)||(this._setClasses(E),this._emitOrigin(D,null))}_emitOrigin(y,E){y.subject.observers.length&&this._ngZone.run(()=>y.subject.next(E))}_registerGlobalListeners(y){if(!this._platform.isBrowser)return;const E=y.rootNode,D=this._rootNodeFocusListenerCount.get(E)||0;D||this._ngZone.runOutsideAngular(()=>{E.addEventListener("focus",this._rootNodeFocusAndBlurListener,rn),E.addEventListener("blur",this._rootNodeFocusAndBlurListener,rn)}),this._rootNodeFocusListenerCount.set(E,D+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,ue.R)(this._stopInputModalityDetector)).subscribe(W=>{this._setOrigin(W,!0)}))}_removeGlobalListeners(y){const E=y.rootNode;if(this._rootNodeFocusListenerCount.has(E)){const D=this._rootNodeFocusListenerCount.get(E);D>1?this._rootNodeFocusListenerCount.set(E,D-1):(E.removeEventListener("focus",this._rootNodeFocusAndBlurListener,rn),E.removeEventListener("blur",this._rootNodeFocusAndBlurListener,rn),this._rootNodeFocusListenerCount.delete(E))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(y,E,D){this._setClasses(y,E),this._emitOrigin(D,E),this._lastFocusOrigin=E}_getClosestElementsInfo(y){const E=[];return this._elementInfo.forEach((D,W)=>{(W===y||D.checkChildren&&W.contains(y))&&E.push([W,D])}),E}_isLastInteractionFromInputLabel(y){const{_mostRecentTarget:E,mostRecentModality:D}=this._inputModalityDetector;if("mouse"!==D||!E||E===y||"INPUT"!==y.nodeName&&"TEXTAREA"!==y.nodeName||y.disabled)return!1;const W=y.labels;if(W)for(let ce=0;ce<W.length;ce++)if(W[ce].contains(E))return!0;return!1}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(j.R0b),j.LFG(P.t4),j.LFG(En),j.LFG(f.K0,8),j.LFG(nn,8))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const mn="cdk-high-contrast-black-on-white",G="cdk-high-contrast-white-on-black",x="cdk-high-contrast-active";let A=(()=>{class p{constructor(y,E){this._platform=y,this._document=E,this._breakpointSubscription=(0,j.f3M)(F.Yg).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const y=this._document.createElement("div");y.style.backgroundColor="rgb(1,2,3)",y.style.position="absolute",this._document.body.appendChild(y);const E=this._document.defaultView||window,D=E&&E.getComputedStyle?E.getComputedStyle(y):null,W=(D&&D.backgroundColor||"").replace(/ /g,"");switch(y.remove(),W){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const y=this._document.body.classList;y.remove(x,mn,G),this._hasCheckedHighContrastMode=!0;const E=this.getHighContrastMode();1===E?y.add(x,mn):2===E&&y.add(x,G)}}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(P.t4),j.LFG(f.K0))},p.\u0275prov=j.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),T=(()=>{class p{constructor(y){y._applyBodyHighContrastModeCssClasses()}}return p.\u0275fac=function(y){return new(y||p)(j.LFG(A))},p.\u0275mod=j.oAB({type:p}),p.\u0275inj=j.cJS({imports:[it.Q8]}),p})()},445:(Bt,Ne,C)=>{C.d(Ne,{Is:()=>ye,vT:()=>ie});var f=C(4650),j=C(6895);const P=new f.OlP("cdk-dir-doc",{providedIn:"root",factory:function me(){return(0,f.f3M)(j.K0)}}),re=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let ye=(()=>{class V{constructor(Z){if(this.value="ltr",this.change=new f.vpe,Z){const le=Z.documentElement?Z.documentElement.dir:null;this.value=function _e(V){const ae=V?.toLowerCase()||"";return"auto"===ae&&typeof navigator<"u"&&navigator?.language?re.test(navigator.language)?"rtl":"ltr":"rtl"===ae?"rtl":"ltr"}((Z.body?Z.body.dir:null)||le||"ltr")}}ngOnDestroy(){this.change.complete()}}return V.\u0275fac=function(Z){return new(Z||V)(f.LFG(P,8))},V.\u0275prov=f.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),V})(),ie=(()=>{class V{}return V.\u0275fac=function(Z){return new(Z||V)},V.\u0275mod=f.oAB({type:V}),V.\u0275inj=f.cJS({}),V})()},1281:(Bt,Ne,C)=>{C.d(Ne,{Eq:()=>re,HM:()=>_e,Ig:()=>j,fI:()=>ye,su:()=>P});var f=C(4650);function j(ie){return null!=ie&&"false"!=`${ie}`}function P(ie,V=0){return function me(ie){return!isNaN(parseFloat(ie))&&!isNaN(Number(ie))}(ie)?Number(ie):V}function re(ie){return Array.isArray(ie)?ie:[ie]}function _e(ie){return null==ie?"":"string"==typeof ie?ie:`${ie}px`}function ye(ie){return ie instanceof f.SBq?ie.nativeElement:ie}},9521:(Bt,Ne,C)=>{C.d(Ne,{A:()=>Je,JH:()=>Ze,JU:()=>_e,K5:()=>re,LH:()=>it,L_:()=>Z,MW:()=>bn,Mf:()=>P,SV:()=>F,Sd:()=>ue,Vb:()=>Qr,Z:()=>Ht,aO:()=>ze,b2:()=>kr,hY:()=>ae,jx:()=>ye,oh:()=>De,uR:()=>te,xE:()=>Se,zL:()=>U});const P=9,re=13,_e=16,ye=17,U=18,ae=27,Z=32,te=35,ue=36,De=37,it=38,F=39,Ze=40,Se=48,ze=57,Je=65,Ht=90,bn=91,kr=224;function Qr(Vn,...Bn){return Bn.length?Bn.some(Yr=>Vn[Yr]):Vn.altKey||Vn.shiftKey||Vn.ctrlKey||Vn.metaKey}},2289:(Bt,Ne,C)=>{C.d(Ne,{Yg:()=>Ze,u3:()=>J});var f=C(4650),j=C(1281),P=C(7579),me=C(9841),re=C(7272),_e=C(9751),ye=C(5698),U=C(5684),ie=C(8372),V=C(4004),ae=C(8675),Z=C(2722),H=C(3353);const te=new Set;let ue,De=(()=>{class oe{constructor(Se){this._platform=Se,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):F}matchMedia(Se){return(this._platform.WEBKIT||this._platform.BLINK)&&function it(oe){if(!te.has(oe))try{ue||(ue=document.createElement("style"),ue.setAttribute("type","text/css"),document.head.appendChild(ue)),ue.sheet&&(ue.sheet.insertRule(`@media ${oe} {body{ }}`,0),te.add(oe))}catch(Oe){console.error(Oe)}}(Se),this._matchMedia(Se)}}return oe.\u0275fac=function(Se){return new(Se||oe)(f.LFG(H.t4))},oe.\u0275prov=f.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe})();function F(oe){return{matches:"all"===oe||""===oe,media:oe,addListener:()=>{},removeListener:()=>{}}}let Ze=(()=>{class oe{constructor(Se,Xe){this._mediaMatcher=Se,this._zone=Xe,this._queries=new Map,this._destroySubject=new P.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(Se){return we((0,j.Eq)(Se)).some(B=>this._registerQuery(B).mql.matches)}observe(Se){const B=we((0,j.Eq)(Se)).map(be=>this._registerQuery(be).observable);let Qe=(0,me.a)(B);return Qe=(0,re.z)(Qe.pipe((0,ye.q)(1)),Qe.pipe((0,U.T)(1),(0,ie.b)(0))),Qe.pipe((0,V.U)(be=>{const at={matches:!1,breakpoints:{}};return be.forEach(({matches:dt,query:gt})=>{at.matches=at.matches||dt,at.breakpoints[gt]=dt}),at}))}_registerQuery(Se){if(this._queries.has(Se))return this._queries.get(Se);const Xe=this._mediaMatcher.matchMedia(Se),Qe={observable:new _e.y(be=>{const at=dt=>this._zone.run(()=>be.next(dt));return Xe.addListener(at),()=>{Xe.removeListener(at)}}).pipe((0,ae.O)(Xe),(0,V.U)(({matches:be})=>({query:Se,matches:be})),(0,Z.R)(this._destroySubject)),mql:Xe};return this._queries.set(Se,Qe),Qe}}return oe.\u0275fac=function(Se){return new(Se||oe)(f.LFG(De),f.LFG(f.R0b))},oe.\u0275prov=f.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe})();function we(oe){return oe.map(Oe=>Oe.split(",")).reduce((Oe,Se)=>Oe.concat(Se)).map(Oe=>Oe.trim())}const J={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"}},9643:(Bt,Ne,C)=>{C.d(Ne,{Q8:()=>ie,wD:()=>U});var f=C(1281),j=C(4650),P=C(9751),me=C(7579),re=C(8372);let _e=(()=>{class V{create(Z){return typeof MutationObserver>"u"?null:new MutationObserver(Z)}}return V.\u0275fac=function(Z){return new(Z||V)},V.\u0275prov=j.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),V})(),ye=(()=>{class V{constructor(Z){this._mutationObserverFactory=Z,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((Z,H)=>this._cleanupObserver(H))}observe(Z){const H=(0,f.fI)(Z);return new P.y(le=>{const ue=this._observeElement(H).subscribe(le);return()=>{ue.unsubscribe(),this._unobserveElement(H)}})}_observeElement(Z){if(this._observedElements.has(Z))this._observedElements.get(Z).count++;else{const H=new me.x,le=this._mutationObserverFactory.create(te=>H.next(te));le&&le.observe(Z,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(Z,{observer:le,stream:H,count:1})}return this._observedElements.get(Z).stream}_unobserveElement(Z){this._observedElements.has(Z)&&(this._observedElements.get(Z).count--,this._observedElements.get(Z).count||this._cleanupObserver(Z))}_cleanupObserver(Z){if(this._observedElements.has(Z)){const{observer:H,stream:le}=this._observedElements.get(Z);H&&H.disconnect(),le.complete(),this._observedElements.delete(Z)}}}return V.\u0275fac=function(Z){return new(Z||V)(j.LFG(_e))},V.\u0275prov=j.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),V})(),U=(()=>{class V{constructor(Z,H,le){this._contentObserver=Z,this._elementRef=H,this._ngZone=le,this.event=new j.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(Z){this._disabled=(0,f.Ig)(Z),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(Z){this._debounce=(0,f.su)(Z),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const Z=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?Z.pipe((0,re.b)(this.debounce)):Z).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return V.\u0275fac=function(Z){return new(Z||V)(j.Y36(ye),j.Y36(j.SBq),j.Y36(j.R0b))},V.\u0275dir=j.lG2({type:V,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),V})(),ie=(()=>{class V{}return V.\u0275fac=function(Z){return new(Z||V)},V.\u0275mod=j.oAB({type:V}),V.\u0275inj=j.cJS({providers:[_e]}),V})()},3353:(Bt,Ne,C)=>{C.d(Ne,{Mq:()=>le,Oy:()=>we,ht:()=>F,i$:()=>ae,kV:()=>it,qK:()=>U,sA:()=>Ze,t4:()=>me});var f=C(4650),j=C(6895);let P;try{P=typeof Intl<"u"&&Intl.v8BreakIterator}catch{P=!1}let _e,me=(()=>{class J{constructor(Oe){this._platformId=Oe,this.isBrowser=this._platformId?(0,j.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!P)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return J.\u0275fac=function(Oe){return new(Oe||J)(f.LFG(f.Lbi))},J.\u0275prov=f.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"}),J})();const ye=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function U(){if(_e)return _e;if("object"!=typeof document||!document)return _e=new Set(ye),_e;let J=document.createElement("input");return _e=new Set(ye.filter(oe=>(J.setAttribute("type",oe),J.type===oe))),_e}let ie,H,ue;function ae(J){return function V(){if(null==ie&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ie=!0}))}finally{ie=ie||!1}return ie}()?J:!!J.capture}function le(){if(null==H){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return H=!1,H;if("scrollBehavior"in document.documentElement.style)H=!0;else{const J=Element.prototype.scrollTo;H=!!J&&!/\{\s*\[native code\]\s*\}/.test(J.toString())}}return H}function it(J){if(function De(){if(null==ue){const J=typeof document<"u"?document.head:null;ue=!(!J||!J.createShadowRoot&&!J.attachShadow)}return ue}()){const oe=J.getRootNode?J.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&oe instanceof ShadowRoot)return oe}return null}function F(){let J=typeof document<"u"&&document?document.activeElement:null;for(;J&&J.shadowRoot;){const oe=J.shadowRoot.activeElement;if(oe===J)break;J=oe}return J}function Ze(J){return J.composedPath?J.composedPath()[0]:J.target}function we(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},9101:(Bt,Ne,C)=>{C.d(Ne,{lW:()=>V,ot:()=>Z,zs:()=>ae});var f=C(4650),j=C(3238),P=C(2687);const me=["mat-button",""],re=["*"],U=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],ie=(0,j.pj)((0,j.Id)((0,j.Kr)(class{constructor(H){this._elementRef=H}})));let V=(()=>{class H extends ie{constructor(te,ue,De){super(te),this._focusMonitor=ue,this._animationMode=De,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const it of U)this._hasHostAttributes(it)&&this._getHostElement().classList.add(it);te.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(te,ue){te?this._focusMonitor.focusVia(this._getHostElement(),te,ue):this._getHostElement().focus(ue)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...te){return te.some(ue=>this._getHostElement().hasAttribute(ue))}}return H.\u0275fac=function(te){return new(te||H)(f.Y36(f.SBq),f.Y36(P.tE),f.Y36(f.QbO,8))},H.\u0275cmp=f.Xpm({type:H,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(te,ue){if(1&te&&f.Gf(j.wG,5),2&te){let De;f.iGM(De=f.CRH())&&(ue.ripple=De.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(te,ue){2&te&&(f.uIk("disabled",ue.disabled||null),f.ekj("_mat-animation-noopable","NoopAnimations"===ue._animationMode)("mat-button-disabled",ue.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[f.qOj],attrs:me,ngContentSelectors:re,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(te,ue){1&te&&(f.F$t(),f.TgZ(0,"span",0),f.Hsn(1),f.qZA(),f._UZ(2,"span",1)(3,"span",2)),2&te&&(f.xp6(2),f.ekj("mat-button-ripple-round",ue.isRoundButton||ue.isIconButton),f.Q6J("matRippleDisabled",ue._isRippleDisabled())("matRippleCentered",ue.isIconButton)("matRippleTrigger",ue._getHostElement()))},dependencies:[j.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),H})(),ae=(()=>{class H extends V{constructor(te,ue,De,it){super(ue,te,De),this._ngZone=it,this._haltDisabledEvents=F=>{this.disabled&&(F.preventDefault(),F.stopImmediatePropagation())}}ngAfterViewInit(){super.ngAfterViewInit(),this._ngZone?this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}):this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}}return H.\u0275fac=function(te){return new(te||H)(f.Y36(P.tE),f.Y36(f.SBq),f.Y36(f.QbO,8),f.Y36(f.R0b,8))},H.\u0275cmp=f.Xpm({type:H,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(te,ue){2&te&&(f.uIk("tabindex",ue.disabled?-1:ue.tabIndex)("disabled",ue.disabled||null)("aria-disabled",ue.disabled.toString()),f.ekj("_mat-animation-noopable","NoopAnimations"===ue._animationMode)("mat-button-disabled",ue.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[f.qOj],attrs:me,ngContentSelectors:re,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(te,ue){1&te&&(f.F$t(),f.TgZ(0,"span",0),f.Hsn(1),f.qZA(),f._UZ(2,"span",1)(3,"span",2)),2&te&&(f.xp6(2),f.ekj("mat-button-ripple-round",ue.isRoundButton||ue.isIconButton),f.Q6J("matRippleDisabled",ue._isRippleDisabled())("matRippleCentered",ue.isIconButton)("matRippleTrigger",ue._getHostElement()))},dependencies:[j.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),H})(),Z=(()=>{class H{}return H.\u0275fac=function(te){return new(te||H)},H.\u0275mod=f.oAB({type:H}),H.\u0275inj=f.cJS({imports:[j.si,j.BQ,j.BQ]}),H})()},3238:(Bt,Ne,C)=>{C.d(Ne,{rD:()=>Ge,K7:()=>Ht,HF:()=>qt,BQ:()=>we,ey:()=>rn,Ng:()=>mn,wG:()=>pt,si:()=>fn,CB:()=>qn,jH:()=>wn,pj:()=>Xe,Kr:()=>B,Id:()=>Se,FD:()=>be,dB:()=>at,sb:()=>Qe});var f=C(4650),j=C(2687),P=C(445),re=C(6895),_e=C(3353),ye=C(1281),U=C(9751),ie=C(7579),V=C(9521);function H(G,x){if(1&G&&f._UZ(0,"mat-pseudo-checkbox",4),2&G){const A=f.oxw();f.Q6J("state",A.selected?"checked":"unchecked")("disabled",A.disabled)}}function le(G,x){if(1&G&&(f.TgZ(0,"span",5),f._uU(1),f.qZA()),2&G){const A=f.oxw();f.xp6(1),f.hij("(",A.group.label,")")}}const te=["*"],Ze=new f.OlP("mat-sanity-checks",{providedIn:"root",factory:function F(){return!0}});let we=(()=>{class G{constructor(A,T,p){this._sanityChecks=T,this._document=p,this._hasDoneGlobalChecks=!1,A._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(A){return!(0,_e.Oy)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[A])}}return G.\u0275fac=function(A){return new(A||G)(f.LFG(j.qm),f.LFG(Ze,8),f.LFG(re.K0))},G.\u0275mod=f.oAB({type:G}),G.\u0275inj=f.cJS({imports:[P.vT,P.vT]}),G})();function Se(G){return class extends G{constructor(...x){super(...x),this._disabled=!1}get disabled(){return this._disabled}set disabled(x){this._disabled=(0,ye.Ig)(x)}}}function Xe(G,x){return class extends G{constructor(...A){super(...A),this.defaultColor=x,this.color=x}get color(){return this._color}set color(A){const T=A||this.defaultColor;T!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),T&&this._elementRef.nativeElement.classList.add(`mat-${T}`),this._color=T)}}}function B(G){return class extends G{constructor(...x){super(...x),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(x){this._disableRipple=(0,ye.Ig)(x)}}}function Qe(G,x=0){return class extends G{constructor(...A){super(...A),this._tabIndex=x,this.defaultTabIndex=x}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(A){this._tabIndex=null!=A?(0,ye.su)(A):this.defaultTabIndex}}}function be(G){return class extends G{constructor(...x){super(...x),this.errorState=!1}updateErrorState(){const x=this.errorState,g=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);g!==x&&(this.errorState=g,this.stateChanges.next())}}}function at(G){return class extends G{constructor(...x){super(...x),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new U.y(A=>{this._isInitialized?this._notifySubscriber(A):this._pendingSubscribers.push(A)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(x){x.next(),x.complete()}}}let Ge=(()=>{class G{isErrorState(A,T){return!!(A&&A.invalid&&(A.touched||T&&T.submitted))}}return G.\u0275fac=function(A){return new(A||G)},G.\u0275prov=f.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})();class Nt{constructor(x,A,T,p=!1){this._renderer=x,this.element=A,this.config=T,this._animationForciblyDisabledThroughCss=p,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const un={enterDuration:225,exitDuration:150},Gt=(0,_e.i$)({passive:!0}),en=["mousedown","touchstart"],$t=["mouseup","mouseleave","touchend","touchcancel"];class ht{constructor(x,A,T,p){this._target=x,this._ngZone=A,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,p.isBrowser&&(this._containerElement=(0,ye.fI)(T))}fadeInRipple(x,A,T={}){const p=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),g={...un,...T.animation};T.centered&&(x=p.left+p.width/2,A=p.top+p.height/2);const y=T.radius||function qe(G,x,A){const T=Math.max(Math.abs(G-A.left),Math.abs(G-A.right)),p=Math.max(Math.abs(x-A.top),Math.abs(x-A.bottom));return Math.sqrt(T*T+p*p)}(x,A,p),E=x-p.left,D=A-p.top,W=g.enterDuration,ce=document.createElement("div");ce.classList.add("mat-ripple-element"),ce.style.left=E-y+"px",ce.style.top=D-y+"px",ce.style.height=2*y+"px",ce.style.width=2*y+"px",null!=T.color&&(ce.style.backgroundColor=T.color),ce.style.transitionDuration=`${W}ms`,this._containerElement.appendChild(ce);const Ue=window.getComputedStyle(ce),Rt=Ue.transitionDuration,Zt="none"===Ue.transitionProperty||"0s"===Rt||"0s, 0s"===Rt,Qt=new Nt(this,ce,T,Zt);ce.style.transform="scale3d(1, 1, 1)",Qt.state=0,T.persistent||(this._mostRecentTransientRipple=Qt);let nr=null;return!Zt&&(W||g.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const gn=()=>this._finishRippleTransition(Qt),Hn=()=>this._destroyRipple(Qt);ce.addEventListener("transitionend",gn),ce.addEventListener("transitioncancel",Hn),nr={onTransitionEnd:gn,onTransitionCancel:Hn}}),this._activeRipples.set(Qt,nr),(Zt||!W)&&this._finishRippleTransition(Qt),Qt}fadeOutRipple(x){if(2===x.state||3===x.state)return;const A=x.element,T={...un,...x.config.animation};A.style.transitionDuration=`${T.exitDuration}ms`,A.style.opacity="0",x.state=2,(x._animationForciblyDisabledThroughCss||!T.exitDuration)&&this._finishRippleTransition(x)}fadeOutAll(){this._getActiveRipples().forEach(x=>x.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(x=>{x.config.persistent||x.fadeOut()})}setupTriggerEvents(x){const A=(0,ye.fI)(x);!A||A===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=A,this._registerEvents(en))}handleEvent(x){"mousedown"===x.type?this._onMousedown(x):"touchstart"===x.type?this._onTouchStart(x):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents($t),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(x){0===x.state?this._startFadeOutTransition(x):2===x.state&&this._destroyRipple(x)}_startFadeOutTransition(x){const A=x===this._mostRecentTransientRipple,{persistent:T}=x.config;x.state=1,!T&&(!A||!this._isPointerDown)&&x.fadeOut()}_destroyRipple(x){const A=this._activeRipples.get(x)??null;this._activeRipples.delete(x),this._activeRipples.size||(this._containerRect=null),x===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),x.state=3,null!==A&&(x.element.removeEventListener("transitionend",A.onTransitionEnd),x.element.removeEventListener("transitioncancel",A.onTransitionCancel)),x.element.remove()}_onMousedown(x){const A=(0,j.X6)(x),T=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!A&&!T&&(this._isPointerDown=!0,this.fadeInRipple(x.clientX,x.clientY,this._target.rippleConfig))}_onTouchStart(x){if(!this._target.rippleDisabled&&!(0,j.yG)(x)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const A=x.changedTouches;for(let T=0;T<A.length;T++)this.fadeInRipple(A[T].clientX,A[T].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(x=>{!x.config.persistent&&(1===x.state||x.config.terminateOnPointerUp&&0===x.state)&&x.fadeOut()}))}_registerEvents(x){this._ngZone.runOutsideAngular(()=>{x.forEach(A=>{this._triggerElement.addEventListener(A,this,Gt)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(en.forEach(x=>{this._triggerElement.removeEventListener(x,this,Gt)}),this._pointerUpEventsRegistered&&$t.forEach(x=>{this._triggerElement.removeEventListener(x,this,Gt)}))}}const Et=new f.OlP("mat-ripple-global-options");let pt=(()=>{class G{constructor(A,T,p,g,y){this._elementRef=A,this._animationMode=y,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=g||{},this._rippleRenderer=new ht(this,T,A,p)}get disabled(){return this._disabled}set disabled(A){A&&this.fadeOutAllNonPersistent(),this._disabled=A,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(A){this._trigger=A,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(A,T=0,p){return"number"==typeof A?this._rippleRenderer.fadeInRipple(A,T,{...this.rippleConfig,...p}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...A})}}return G.\u0275fac=function(A){return new(A||G)(f.Y36(f.SBq),f.Y36(f.R0b),f.Y36(_e.t4),f.Y36(Et,8),f.Y36(f.QbO,8))},G.\u0275dir=f.lG2({type:G,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(A,T){2&A&&f.ekj("mat-ripple-unbounded",T.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),G})(),fn=(()=>{class G{}return G.\u0275fac=function(A){return new(A||G)},G.\u0275mod=f.oAB({type:G}),G.\u0275inj=f.cJS({imports:[we,we]}),G})(),Fn=(()=>{class G{constructor(A){this._animationMode=A,this.state="unchecked",this.disabled=!1}}return G.\u0275fac=function(A){return new(A||G)(f.Y36(f.QbO,8))},G.\u0275cmp=f.Xpm({type:G,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(A,T){2&A&&f.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===T.state)("mat-pseudo-checkbox-checked","checked"===T.state)("mat-pseudo-checkbox-disabled",T.disabled)("_mat-animation-noopable","NoopAnimations"===T._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(A,T){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}'],encapsulation:2,changeDetection:0}),G})(),pn=(()=>{class G{}return G.\u0275fac=function(A){return new(A||G)},G.\u0275mod=f.oAB({type:G}),G.\u0275inj=f.cJS({imports:[we]}),G})();const qt=new f.OlP("MAT_OPTION_PARENT_COMPONENT"),Ht=new f.OlP("MatOptgroup");let tn=0;class Un{constructor(x,A=!1){this.source=x,this.isUserInput=A}}let nn=(()=>{class G{constructor(A,T,p,g){this._element=A,this._changeDetectorRef=T,this._parent=p,this.group=g,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+tn++,this.onSelectionChange=new f.vpe,this._stateChanges=new ie.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(A){this._disabled=(0,ye.Ig)(A)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(A,T){const p=this._getHostElement();"function"==typeof p.focus&&p.focus(T)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(A){(A.keyCode===V.K5||A.keyCode===V.L_)&&!(0,V.Vb)(A)&&(this._selectViaInteraction(),A.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const A=this.viewValue;A!==this._mostRecentViewValue&&(this._mostRecentViewValue=A,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(A=!1){this.onSelectionChange.emit(new Un(this,A))}}return G.\u0275fac=function(A){f.$Z()},G.\u0275dir=f.lG2({type:G,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),G})(),rn=(()=>{class G extends nn{constructor(A,T,p,g){super(A,T,p,g)}}return G.\u0275fac=function(A){return new(A||G)(f.Y36(f.SBq),f.Y36(f.sBO),f.Y36(qt,8),f.Y36(Ht,8))},G.\u0275cmp=f.Xpm({type:G,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(A,T){1&A&&f.NdJ("click",function(){return T._selectViaInteraction()})("keydown",function(g){return T._handleKeydown(g)}),2&A&&(f.Ikx("id",T.id),f.uIk("tabindex",T._getTabIndex())("aria-selected",T._getAriaSelected())("aria-disabled",T.disabled.toString()),f.ekj("mat-selected",T.selected)("mat-option-multiple",T.multiple)("mat-active",T.active)("mat-option-disabled",T.disabled))},exportAs:["matOption"],features:[f.qOj],ngContentSelectors:te,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(A,T){1&A&&(f.F$t(),f.YNc(0,H,1,2,"mat-pseudo-checkbox",0),f.TgZ(1,"span",1),f.Hsn(2),f.qZA(),f.YNc(3,le,2,1,"span",2),f._UZ(4,"div",3)),2&A&&(f.Q6J("ngIf",T.multiple),f.xp6(3),f.Q6J("ngIf",T.group&&T.group._inert),f.xp6(1),f.Q6J("matRippleTrigger",T._getHostElement())("matRippleDisabled",T.disabled||T.disableRipple))},dependencies:[pt,re.O5,Fn],styles:['.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.mat-option.mat-active::before{content:""}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{right:auto;left:16px}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}'],encapsulation:2,changeDetection:0}),G})();function qn(G,x,A){if(A.length){let T=x.toArray(),p=A.toArray(),g=0;for(let y=0;y<G+1;y++)T[y].group&&T[y].group===p[g]&&g++;return g}return 0}function wn(G,x,A,T){return G<A?G:G+x>A+T?Math.max(0,G-T+x):A}let mn=(()=>{class G{}return G.\u0275fac=function(A){return new(A||G)},G.\u0275mod=f.oAB({type:G}),G.\u0275inj=f.cJS({imports:[fn,re.ez,we,pn]}),G})()},2644:(Bt,Ne,C)=>{C.r(Ne);var f=C(5861),j=C(3942),P=C(2090),me=C(6881),re=C(655),_e=C(1877),ye=C(4859);const te=function H(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},ue=function le(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},De=new P.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),F=new _e.Yd("@firebase/auth");function we(c,...o){F.logLevel<=_e.in.ERROR&&F.error(`Auth (${me.SDK_VERSION}): ${c}`,...o)}function J(c,...o){throw Xe(c,...o)}function oe(c,...o){return Xe(c,...o)}function Oe(c,o,a){const l=Object.assign(Object.assign({},ue()),{[o]:a});return new P.LL("auth","Firebase",l).create(o,{appName:c.name})}function Se(c,o,a){if(!(o instanceof a))throw a.name!==o.constructor.name&&J(c,"argument-error"),Oe(c,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xe(c,...o){if("string"!=typeof c){const a=o[0],l=[...o.slice(1)];return l[0]&&(l[0].appName=c.name),c._errorFactory.create(a,...l)}return De.create(c,...o)}function B(c,o,...a){if(!c)throw Xe(o,...a)}function Qe(c){const o="INTERNAL ASSERTION FAILED: "+c;throw we(o),new Error(o)}function be(c,o){c||Qe(o)}function at(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.href)||""}function dt(){return"http:"===gt()||"https:"===gt()}function gt(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.protocol)||null}class Re{constructor(o,a){this.shortDelay=o,this.longDelay=a,be(a>o,"Short delay should be less than long delay!"),this.isMobile=(0,P.uI)()||(0,P.b$)()}get(){return function zt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(dt()||(0,P.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Pe(c,o){be(c.emulator,"Emulator should always be set here");const{url:a}=c.emulator;return o?`${a}${o.startsWith("/")?o.slice(1):o}`:a}class xe{static initialize(o,a,l){this.fetchImpl=o,a&&(this.headersImpl=a),l&&(this.responseImpl=l)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Qe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Qe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Qe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Fe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Je=new Re(3e4,6e4);function Te(c,o){return c.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:c.tenantId}):o}function Ie(c,o,a,l){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,f.Z)(function*(c,o,a,l,m={}){return Ke(c,m,(0,f.Z)(function*(){let v={},w={};l&&("GET"===o?w=l:v={body:JSON.stringify(l)});const R=(0,P.xO)(Object.assign({key:c.config.apiKey},w)).slice(1),q=yield c._getAdditionalHeaders();return q["Content-Type"]="application/json",c.languageCode&&(q["X-Firebase-Locale"]=c.languageCode),xe.fetch()(Nt(c,c.config.apiHost,a,R),Object.assign({method:o,headers:q,referrerPolicy:"no-referrer"},v))}))})).apply(this,arguments)}function Ke(c,o,a){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,f.Z)(function*(c,o,a){c._canInitEmulator=!1;const l=Object.assign(Object.assign({},Fe),o);try{const m=new un(c),v=yield Promise.race([a(),m.promise]);m.clearNetworkTimeout();const w=yield v.json();if("needConfirmation"in w)throw st(c,"account-exists-with-different-credential",w);if(v.ok&&!("errorMessage"in w))return w;{const R=v.ok?w.errorMessage:w.error.message,[q,ee]=R.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===q)throw st(c,"credential-already-in-use",w);if("EMAIL_EXISTS"===q)throw st(c,"email-already-in-use",w);if("USER_DISABLED"===q)throw st(c,"user-disabled",w);const fe=l[q]||q.toLowerCase().replace(/[_\s]+/g,"-");if(ee)throw Oe(c,fe,ee);J(c,fe)}}catch(m){if(m instanceof P.ZR)throw m;J(c,"network-request-failed",{message:String(m)})}})).apply(this,arguments)}function et(c,o,a,l){return It.apply(this,arguments)}function It(){return(It=(0,f.Z)(function*(c,o,a,l,m={}){const v=yield Ie(c,o,a,l,m);return"mfaPendingCredential"in v&&J(c,"multi-factor-auth-required",{_serverResponse:v}),v})).apply(this,arguments)}function Nt(c,o,a,l){const m=`${o}${a}?${l}`;return c.config.emulator?Pe(c.config,m):`${c.config.apiScheme}://${m}`}class un{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((a,l)=>{this.timer=setTimeout(()=>l(oe(this.auth,"network-request-failed")),Je.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function st(c,o,a){const l={appName:c.name};a.email&&(l.email=a.email),a.phoneNumber&&(l.phoneNumber=a.phoneNumber);const m=oe(c,o,l);return m.customData._tokenResponse=a,m}function en(){return(en=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function $t(c,o){return ht.apply(this,arguments)}function ht(){return(ht=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function qe(c,o){return Et.apply(this,arguments)}function Et(){return(Et=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function pt(c){if(c)try{const o=new Date(Number(c));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function pn(){return(pn=(0,f.Z)(function*(c,o=!1){const a=(0,P.m9)(c),l=yield a.getIdToken(o),m=Ot(l);B(m&&m.exp&&m.auth_time&&m.iat,a.auth,"internal-error");const v="object"==typeof m.firebase?m.firebase:void 0,w=v?.sign_in_provider;return{claims:m,token:l,authTime:pt(qt(m.auth_time)),issuedAtTime:pt(qt(m.iat)),expirationTime:pt(qt(m.exp)),signInProvider:w||null,signInSecondFactor:v?.sign_in_second_factor||null}})).apply(this,arguments)}function qt(c){return 1e3*Number(c)}function Ot(c){const[o,a,l]=c.split(".");if(void 0===o||void 0===a||void 0===l)return we("JWT malformed, contained fewer than 3 sections"),null;try{const m=(0,P.tV)(a);return m?JSON.parse(m):(we("Failed to decode base64 JWT payload"),null)}catch(m){return we("Caught error parsing JWT payload as JSON",m?.toString()),null}}function St(c,o){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,f.Z)(function*(c,o,a=!1){if(a)return o;try{return yield o}catch(l){throw l instanceof P.ZR&&bn(l)&&c.auth.currentUser===c&&(yield c.auth.signOut()),l}})).apply(this,arguments)}function bn({code:c}){return"auth/user-disabled"===c||"auth/user-token-expired"===c}class tn{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var a;if(o){const l=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),l}{this.errorBackoff=3e4;const m=(null!==(a=this.user.stsTokenManager.expirationTime)&&void 0!==a?a:0)-Date.now()-3e5;return Math.max(0,m)}}schedule(o=!1){var a=this;if(!this.isRunning)return;const l=this.getInterval(o);this.timerId=setTimeout((0,f.Z)(function*(){yield a.iteration()}),l)}iteration(){var o=this;return(0,f.Z)(function*(){try{yield o.user.getIdToken(!0)}catch(a){return void("auth/network-request-failed"===a?.code&&o.schedule(!0))}o.schedule()})()}}class Un{constructor(o,a){this.createdAt=o,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=pt(this.lastLoginAt),this.creationTime=pt(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function nn(c){return rn.apply(this,arguments)}function rn(){return(rn=(0,f.Z)(function*(c){var o;const a=c.auth,l=yield c.getIdToken(),m=yield St(c,qe(a,{idToken:l}));B(m?.users.length,a,"internal-error");const v=m.users[0];c._notifyReloadListener(v);const w=null!==(o=v.providerUserInfo)&&void 0!==o&&o.length?G(v.providerUserInfo):[],R=mn(c.providerData,w),fe=!!c.isAnonymous&&!(c.email&&v.passwordHash||R?.length),ge={uid:v.localId,displayName:v.displayName||null,photoURL:v.photoUrl||null,email:v.email||null,emailVerified:v.emailVerified||!1,phoneNumber:v.phoneNumber||null,tenantId:v.tenantId||null,providerData:R,metadata:new Un(v.createdAt,v.lastLoginAt),isAnonymous:fe};Object.assign(c,ge)})).apply(this,arguments)}function wn(){return(wn=(0,f.Z)(function*(c){const o=(0,P.m9)(c);yield nn(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function mn(c,o){return[...c.filter(l=>!o.some(m=>m.providerId===l.providerId)),...o]}function G(c){return c.map(o=>{var{providerId:a}=o,l=(0,re._T)(o,["providerId"]);return{providerId:a,uid:l.rawId||"",displayName:l.displayName||null,email:l.email||null,phoneNumber:l.phoneNumber||null,photoURL:l.photoUrl||null}})}function A(){return(A=(0,f.Z)(function*(c,o){const a=yield Ke(c,{},(0,f.Z)(function*(){const l=(0,P.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:m,apiKey:v}=c.config,w=Nt(c,m,"/v1/token",`key=${v}`),R=yield c._getAdditionalHeaders();return R["Content-Type"]="application/x-www-form-urlencoded",xe.fetch()(w,{method:"POST",headers:R,body:l})}));return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}})).apply(this,arguments)}class T{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){B(o.idToken,"internal-error"),B(typeof o.idToken<"u","internal-error"),B(typeof o.refreshToken<"u","internal-error");const a="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function En(c){const o=Ot(c);return B(o,"internal-error"),B(typeof o.exp<"u","internal-error"),B(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,a)}getToken(o,a=!1){var l=this;return(0,f.Z)(function*(){return B(!l.accessToken||l.refreshToken,o,"user-token-expired"),a||!l.accessToken||l.isExpired?l.refreshToken?(yield l.refresh(o,l.refreshToken),l.accessToken):null:l.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,a){var l=this;return(0,f.Z)(function*(){const{accessToken:m,refreshToken:v,expiresIn:w}=yield function x(c,o){return A.apply(this,arguments)}(o,a);l.updateTokensAndExpiration(m,v,Number(w))})()}updateTokensAndExpiration(o,a,l){this.refreshToken=a||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*l}static fromJSON(o,a){const{refreshToken:l,accessToken:m,expirationTime:v}=a,w=new T;return l&&(B("string"==typeof l,"internal-error",{appName:o}),w.refreshToken=l),m&&(B("string"==typeof m,"internal-error",{appName:o}),w.accessToken=m),v&&(B("number"==typeof v,"internal-error",{appName:o}),w.expirationTime=v),w}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new T,this.toJSON())}_performRefresh(){return Qe("not implemented")}}function p(c,o){B("string"==typeof c||typeof c>"u","internal-error",{appName:o})}class g{constructor(o){var{uid:a,auth:l,stsTokenManager:m}=o,v=(0,re._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=l,this.stsTokenManager=m,this.accessToken=m.accessToken,this.displayName=v.displayName||null,this.email=v.email||null,this.emailVerified=v.emailVerified||!1,this.phoneNumber=v.phoneNumber||null,this.photoURL=v.photoURL||null,this.isAnonymous=v.isAnonymous||!1,this.tenantId=v.tenantId||null,this.providerData=v.providerData?[...v.providerData]:[],this.metadata=new Un(v.createdAt||void 0,v.lastLoginAt||void 0)}getIdToken(o){var a=this;return(0,f.Z)(function*(){const l=yield St(a,a.stsTokenManager.getToken(a.auth,o));return B(l,a.auth,"internal-error"),a.accessToken!==l&&(a.accessToken=l,yield a.auth._persistUserIfCurrent(a),a.auth._notifyListenersIfCurrent(a)),l})()}getIdTokenResult(o){return function Fn(c){return pn.apply(this,arguments)}(this,o)}reload(){return function qn(c){return wn.apply(this,arguments)}(this)}_assign(o){this!==o&&(B(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(a=>Object.assign({},a)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const a=new g(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return a.metadata._copy(this.metadata),a}_onReload(o){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,a=!1){var l=this;return(0,f.Z)(function*(){let m=!1;o.idToken&&o.idToken!==l.stsTokenManager.accessToken&&(l.stsTokenManager.updateFromServerResponse(o),m=!0),a&&(yield nn(l)),yield l.auth._persistUserIfCurrent(l),m&&l.auth._notifyListenersIfCurrent(l)})()}delete(){var o=this;return(0,f.Z)(function*(){const a=yield o.getIdToken();return yield St(o,function Gt(c,o){return en.apply(this,arguments)}(o.auth,{idToken:a})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,a){var l,m,v,w,R,q,ee,fe;const ge=null!==(l=a.displayName)&&void 0!==l?l:void 0,wt=null!==(m=a.email)&&void 0!==m?m:void 0,tr=null!==(v=a.phoneNumber)&&void 0!==v?v:void 0,ss=null!==(w=a.photoURL)&&void 0!==w?w:void 0,Ii=null!==(R=a.tenantId)&&void 0!==R?R:void 0,pa=null!==(q=a._redirectEventId)&&void 0!==q?q:void 0,il=null!==(ee=a.createdAt)&&void 0!==ee?ee:void 0,Dt=null!==(fe=a.lastLoginAt)&&void 0!==fe?fe:void 0,{uid:Js,emailVerified:Lu,isAnonymous:os,providerData:Wn,stsTokenManager:ma}=a;B(Js&&ma,o,"internal-error");const sl=T.fromJSON(this.name,ma);B("string"==typeof Js,o,"internal-error"),p(ge,o.name),p(wt,o.name),B("boolean"==typeof Lu,o,"internal-error"),B("boolean"==typeof os,o,"internal-error"),p(tr,o.name),p(ss,o.name),p(Ii,o.name),p(pa,o.name),p(il,o.name),p(Dt,o.name);const Ei=new g({uid:Js,auth:o,email:wt,emailVerified:Lu,displayName:ge,isAnonymous:os,photoURL:ss,phoneNumber:tr,tenantId:Ii,stsTokenManager:sl,createdAt:il,lastLoginAt:Dt});return Wn&&Array.isArray(Wn)&&(Ei.providerData=Wn.map(ol=>Object.assign({},ol))),pa&&(Ei._redirectEventId=pa),Ei}static _fromIdTokenResponse(o,a,l=!1){return(0,f.Z)(function*(){const m=new T;m.updateFromServerResponse(a);const v=new g({uid:a.localId,auth:o,stsTokenManager:m,isAnonymous:l});return yield nn(v),v})()}}const y=new Map;function E(c){be(c instanceof Function,"Expected a class definition");let o=y.get(c);return o?(be(o instanceof c,"Instance stored in cache mismatched with class"),o):(o=new c,y.set(c,o),o)}const W=(()=>{class c{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(a,l){var m=this;return(0,f.Z)(function*(){m.storage[a]=l})()}_get(a){var l=this;return(0,f.Z)(function*(){const m=l.storage[a];return void 0===m?null:m})()}_remove(a){var l=this;return(0,f.Z)(function*(){delete l.storage[a]})()}_addListener(a,l){}_removeListener(a,l){}}return c.type="NONE",c})();function ce(c,o,a){return`firebase:${c}:${o}:${a}`}class Ue{constructor(o,a,l){this.persistence=o,this.auth=a,this.userKey=l;const{config:m,name:v}=this.auth;this.fullUserKey=ce(this.userKey,m.apiKey,v),this.fullPersistenceKey=ce("persistence",m.apiKey,v),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,f.Z)(function*(){const a=yield o.persistence._get(o.fullUserKey);return a?g._fromJSON(o.auth,a):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var a=this;return(0,f.Z)(function*(){if(a.persistence===o)return;const l=yield a.getCurrentUser();return yield a.removeCurrentUser(),a.persistence=o,l?a.setCurrentUser(l):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,a,l="authUser"){return(0,f.Z)(function*(){if(!a.length)return new Ue(E(W),o,l);const m=(yield Promise.all(a.map(function(){var ee=(0,f.Z)(function*(fe){if(yield fe._isAvailable())return fe});return function(fe){return ee.apply(this,arguments)}}()))).filter(ee=>ee);let v=m[0]||E(W);const w=ce(l,o.config.apiKey,o.name);let R=null;for(const ee of a)try{const fe=yield ee._get(w);if(fe){const ge=g._fromJSON(o,fe);ee!==v&&(R=ge),v=ee;break}}catch{}const q=m.filter(ee=>ee._shouldAllowMigration);return v._shouldAllowMigration&&q.length?(v=q[0],R&&(yield v._set(w,R.toJSON())),yield Promise.all(a.map(function(){var ee=(0,f.Z)(function*(fe){if(fe!==v)try{yield fe._remove(w)}catch{}});return function(fe){return ee.apply(this,arguments)}}())),new Ue(v,o,l)):new Ue(v,o,l)})()}}function cn(c){const o=c.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(nr(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(Rt(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(Hn(o))return"Blackberry";if(jr(o))return"Webos";if(Zt(o))return"Safari";if((o.includes("chrome/")||Qt(o))&&!o.includes("edge/"))return"Chrome";if(gn(o))return"Android";{const l=c.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===l?.length)return l[1]}return"Other"}function Rt(c=(0,P.z$)()){return/firefox\//i.test(c)}function Zt(c=(0,P.z$)()){const o=c.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function Qt(c=(0,P.z$)()){return/crios\//i.test(c)}function nr(c=(0,P.z$)()){return/iemobile/i.test(c)}function gn(c=(0,P.z$)()){return/android/i.test(c)}function Hn(c=(0,P.z$)()){return/blackberry/i.test(c)}function jr(c=(0,P.z$)()){return/webos/i.test(c)}function Tn(c=(0,P.z$)()){return/iphone|ipad|ipod/i.test(c)||/macintosh/i.test(c)&&/mobile/i.test(c)}function Qn(c=(0,P.z$)()){return Tn(c)||gn(c)||jr(c)||Hn(c)||/windows phone/i.test(c)||nr(c)}function pr(c,o=[]){let a;switch(c){case"Browser":a=cn((0,P.z$)());break;case"Worker":a=`${cn((0,P.z$)())}-${c}`;break;default:a=c}const l=o.length?o.join(","):"FirebaseCore-web";return`${a}/JsCore/${me.SDK_VERSION}/${l}`}function mr(){return(mr=(0,f.Z)(function*(c){return(yield Ie(c,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Cr(c,o){return Ai.apply(this,arguments)}function Ai(){return(Ai=(0,f.Z)(function*(c,o){return Ie(c,"GET","/v2/recaptchaConfig",Te(c,o))})).apply(this,arguments)}function _s(c){return void 0!==c&&void 0!==c.getResponse}function Yn(c){return void 0!==c&&void 0!==c.enterprise}class Si{constructor(o){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.emailPasswordEnabled=o.recaptchaEnforcementState.some(a=>"EMAIL_PASSWORD_PROVIDER"===a.provider&&"OFF"!==a.enforcementState)}}function Nn(c){return new Promise((o,a)=>{const l=document.createElement("script");l.setAttribute("src",c),l.onload=o,l.onerror=m=>{const v=oe("internal-error");v.customData=m,a(v)},l.type="text/javascript",l.charset="UTF-8",function ys(){var c,o;return null!==(o=null===(c=document.getElementsByTagName("head"))||void 0===c?void 0:c[0])&&void 0!==o?o:document}().appendChild(l)})}function $r(c){return`__${c}${Math.floor(1e6*Math.random())}`}class Is{constructor(o){this.type="recaptcha-enterprise",this.auth=ct(o)}verify(o="verify",a=!1){var l=this;return(0,f.Z)(function*(){function v(){return v=(0,f.Z)(function*(R){if(!a){if(null==R.tenantId&&null!=R._agentRecaptchaConfig)return R._agentRecaptchaConfig.siteKey;if(null!=R.tenantId&&void 0!==R._tenantRecaptchaConfigs[R.tenantId])return R._tenantRecaptchaConfigs[R.tenantId].siteKey}return new Promise(function(){var q=(0,f.Z)(function*(ee,fe){Cr(R,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ge=>{if(void 0!==ge.recaptchaKey){const wt=new Si(ge);return null==R.tenantId?R._agentRecaptchaConfig=wt:R._tenantRecaptchaConfigs[R.tenantId]=wt,ee(wt.siteKey)}fe(new Error("recaptcha Enterprise site key undefined"))}).catch(ge=>{fe(ge)})});return function(ee,fe){return q.apply(this,arguments)}}())}),v.apply(this,arguments)}function w(R,q,ee){const fe=window.grecaptcha;Yn(fe)?fe.enterprise.ready(()=>{fe.enterprise.execute(R,{action:o}).then(ge=>{q(ge)}).catch(()=>{q("NO_RECAPTCHA")})}):ee(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((R,q)=>{(function m(R){return v.apply(this,arguments)})(l.auth).then(ee=>{if(!a&&Yn(window.grecaptcha))w(ee,R,q);else{if(typeof window>"u")return void q(new Error("RecaptchaVerifier is only supported in browser"));Nn("https://www.google.com/recaptcha/enterprise.js?render="+ee).then(()=>{w(ee,R,q)}).catch(fe=>{q(fe)})}}).catch(ee=>{q(ee)})})})()}}function ut(c,o,a){return Ci.apply(this,arguments)}function Ci(){return(Ci=(0,f.Z)(function*(c,o,a,l=!1){const m=new Is(c);let v;try{v=yield m.verify(a)}catch{v=yield m.verify(a,!0)}const w=Object.assign({},o);return Object.assign(w,l?{captchaResp:v}:{captchaResponse:v}),Object.assign(w,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(w,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),w})).apply(this,arguments)}class Hr{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,a){const l=v=>new Promise((w,R)=>{try{w(o(v))}catch(q){R(q)}});l.onAbort=a,this.queue.push(l);const m=this.queue.length-1;return()=>{this.queue[m]=()=>Promise.resolve()}}runMiddleware(o){var a=this;return(0,f.Z)(function*(){if(a.auth.currentUser===o)return;const l=[];try{for(const m of a.queue)yield m(o),m.onAbort&&l.push(m.onAbort)}catch(m){l.reverse();for(const v of l)try{v()}catch{}throw a.auth._errorFactory.create("login-blocked",{originalMessage:m?.message})}})()}}class Zr{constructor(o,a,l,m){this.app=o,this.heartbeatServiceProvider=a,this.appCheckServiceProvider=l,this.config=m,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kr(this),this.idTokenSubscription=new kr(this),this.beforeStateQueue=new Hr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=De,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=m.sdkClientVersion}_initializeWithPersistence(o,a){var l=this;return a&&(this._popupRedirectResolver=E(a)),this._initializationPromise=this.queue((0,f.Z)(function*(){var m,v;if(!l._deleted&&(l.persistenceManager=yield Ue.create(l,o),!l._deleted)){if(null!==(m=l._popupRedirectResolver)&&void 0!==m&&m._shouldInitProactively)try{yield l._popupRedirectResolver._initialize(l)}catch{}yield l.initializeCurrentUser(a),l.lastNotifiedUid=(null===(v=l.currentUser)||void 0===v?void 0:v.uid)||null,!l._deleted&&(l._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,f.Z)(function*(){if(o._deleted)return;const a=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||a){if(o.currentUser&&a&&o.currentUser.uid===a.uid)return o._currentUser._assign(a),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(a,!0)}})()}initializeCurrentUser(o){var a=this;return(0,f.Z)(function*(){var l;const m=yield a.assertedPersistence.getCurrentUser();let v=m,w=!1;if(o&&a.config.authDomain){yield a.getOrInitRedirectPersistenceManager();const R=null===(l=a.redirectUser)||void 0===l?void 0:l._redirectEventId,q=v?._redirectEventId,ee=yield a.tryRedirectSignIn(o);(!R||R===q)&&ee?.user&&(v=ee.user,w=!0)}if(!v)return a.directlySetCurrentUser(null);if(!v._redirectEventId){if(w)try{yield a.beforeStateQueue.runMiddleware(v)}catch(R){v=m,a._popupRedirectResolver._overrideRedirectResult(a,()=>Promise.reject(R))}return v?a.reloadAndSetCurrentUserOrClear(v):a.directlySetCurrentUser(null)}return B(a._popupRedirectResolver,a,"argument-error"),yield a.getOrInitRedirectPersistenceManager(),a.redirectUser&&a.redirectUser._redirectEventId===v._redirectEventId?a.directlySetCurrentUser(v):a.reloadAndSetCurrentUserOrClear(v)})()}tryRedirectSignIn(o){var a=this;return(0,f.Z)(function*(){let l=null;try{l=yield a._popupRedirectResolver._completeRedirectFn(a,o,!0)}catch{yield a._setRedirectUser(null)}return l})()}reloadAndSetCurrentUserOrClear(o){var a=this;return(0,f.Z)(function*(){try{yield nn(o)}catch(l){if("auth/network-request-failed"!==l?.code)return a.directlySetCurrentUser(null)}return a.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function ze(){if(typeof navigator>"u")return null;const c=navigator;return c.languages&&c.languages[0]||c.language||null}()}_delete(){var o=this;return(0,f.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var a=this;return(0,f.Z)(function*(){const l=o?(0,P.m9)(o):null;return l&&B(l.auth.config.apiKey===a.config.apiKey,a,"invalid-user-token"),a._updateCurrentUser(l&&l._clone(a))})()}_updateCurrentUser(o,a=!1){var l=this;return(0,f.Z)(function*(){if(!l._deleted)return o&&B(l.tenantId===o.tenantId,l,"tenant-id-mismatch"),a||(yield l.beforeStateQueue.runMiddleware(o)),l.queue((0,f.Z)(function*(){yield l.directlySetCurrentUser(o),l.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,f.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var a=this;return this.queue((0,f.Z)(function*(){yield a.assertedPersistence.setPersistence(E(o))}))}initializeRecaptchaConfig(){var o=this;return(0,f.Z)(function*(){const a=yield Cr(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),l=new Si(a);null==o.tenantId?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,l.emailPasswordEnabled&&new Is(o).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new P.LL("auth","Firebase",o())}onAuthStateChanged(o,a,l){return this.registerStateListener(this.authStateSubscription,o,a,l)}beforeAuthStateChanged(o,a){return this.beforeStateQueue.pushCallback(o,a)}onIdTokenChanged(o,a,l){return this.registerStateListener(this.idTokenSubscription,o,a,l)}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,a){var l=this;return(0,f.Z)(function*(){const m=yield l.getOrInitRedirectPersistenceManager(a);return null===o?m.removeCurrentUser():m.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var a=this;return(0,f.Z)(function*(){if(!a.redirectPersistenceManager){const l=o&&E(o)||a._popupRedirectResolver;B(l,a,"argument-error"),a.redirectPersistenceManager=yield Ue.create(a,[E(l._redirectPersistence)],"redirectUser"),a.redirectUser=yield a.redirectPersistenceManager.getCurrentUser()}return a.redirectPersistenceManager})()}_redirectUserForId(o){var a=this;return(0,f.Z)(function*(){var l,m;return a._isInitialized&&(yield a.queue((0,f.Z)(function*(){}))),(null===(l=a._currentUser)||void 0===l?void 0:l._redirectEventId)===o?a._currentUser:(null===(m=a.redirectUser)||void 0===m?void 0:m._redirectEventId)===o?a.redirectUser:null})()}_persistUserIfCurrent(o){var a=this;return(0,f.Z)(function*(){if(o===a.currentUser)return a.queue((0,f.Z)(function*(){return a.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const l=null!==(a=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==a?a:null;this.lastNotifiedUid!==l&&(this.lastNotifiedUid=l,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,a,l,m){if(this._deleted)return()=>{};const v="function"==typeof a?a:a.next.bind(a),w=this._isInitialized?Promise.resolve():this._initializationPromise;return B(w,this,"internal-error"),w.then(()=>v(this.currentUser)),"function"==typeof a?o.addObserver(a,l,m):o.addObserver(a)}directlySetCurrentUser(o){var a=this;return(0,f.Z)(function*(){a.currentUser&&a.currentUser!==o&&a._currentUser._stopProactiveRefresh(),o&&a.isProactiveRefreshEnabled&&o._startProactiveRefresh(),a.currentUser=o,o?yield a.assertedPersistence.setCurrentUser(o):yield a.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=pr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,f.Z)(function*(){var a;const l={"X-Client-Version":o.clientVersion};o.app.options.appId&&(l["X-Firebase-gmpid"]=o.app.options.appId);const m=yield null===(a=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getHeartbeatsHeader();m&&(l["X-Firebase-Client"]=m);const v=yield o._getAppCheckToken();return v&&(l["X-Firebase-AppCheck"]=v),l})()}_getAppCheckToken(){var o=this;return(0,f.Z)(function*(){var a;const l=yield null===(a=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getToken();return l?.error&&function Ze(c,...o){F.logLevel<=_e.in.WARN&&F.warn(`Auth (${me.SDK_VERSION}): ${c}`,...o)}(`Error while retrieving App Check token: ${l.error}`),l?.token})()}}function ct(c){return(0,P.m9)(c)}class kr{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,P.ne)(a=>this.observer=a)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Yr(c){const o=c.indexOf(":");return o<0?"":c.substr(0,o+1)}function Es(c){if(!c)return null;const o=Number(c);return isNaN(o)?null:o}class Xn{constructor(o,a){this.providerId=o,this.signInMethod=a}toJSON(){return Qe("not implemented")}_getIdTokenResponse(o){return Qe("not implemented")}_linkToIdToken(o,a){return Qe("not implemented")}_getReauthenticationResolver(o){return Qe("not implemented")}}function bs(c,o){return ws.apply(this,arguments)}function ws(){return(ws=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:resetPassword",Te(c,o))})).apply(this,arguments)}function Ts(c,o){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function As(c,o){return Ss.apply(this,arguments)}function Ss(){return(Ss=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:update",Te(c,o))})).apply(this,arguments)}function xs(c,o){return Cs.apply(this,arguments)}function Cs(){return(Cs=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithPassword",Te(c,o))})).apply(this,arguments)}function ks(c,o){return Dr.apply(this,arguments)}function Dr(){return(Dr=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:sendOobCode",Te(c,o))})).apply(this,arguments)}function k(c,o){return S.apply(this,arguments)}function S(){return(S=(0,f.Z)(function*(c,o){return ks(c,o)})).apply(this,arguments)}function M(c,o){return K.apply(this,arguments)}function K(){return(K=(0,f.Z)(function*(c,o){return ks(c,o)})).apply(this,arguments)}function Y(c,o){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,f.Z)(function*(c,o){return ks(c,o)})).apply(this,arguments)}function He(c,o){return je.apply(this,arguments)}function je(){return(je=(0,f.Z)(function*(c,o){return ks(c,o)})).apply(this,arguments)}function gr(){return(gr=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithEmailLink",Te(c,o))})).apply(this,arguments)}function xt(){return(xt=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithEmailLink",Te(c,o))})).apply(this,arguments)}class Rr extends Xn{constructor(o,a,l,m=null){super("password",l),this._email=o,this._password=a,this._tenantId=m}static _fromEmailAndPassword(o,a){return new Rr(o,a,"password")}static _fromEmailAndCode(o,a,l=null){return new Rr(o,a,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o;if(a?.email&&a?.password){if("password"===a.signInMethod)return this._fromEmailAndPassword(a.email,a.password);if("emailLink"===a.signInMethod)return this._fromEmailAndCode(a.email,a.password,a.tenantId)}return null}_getIdTokenResponse(o){var a=this;return(0,f.Z)(function*(){var l;switch(a.signInMethod){case"password":const m={returnSecureToken:!0,email:a._email,password:a._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(l=o._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const v=yield ut(o,m,"signInWithPassword");return xs(o,v)}return xs(o,m).catch(function(){var v=(0,f.Z)(function*(w){if("auth/missing-recaptcha-token"===w.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const R=yield ut(o,m,"signInWithPassword");return xs(o,R)}return Promise.reject(w)});return function(w){return v.apply(this,arguments)}}());case"emailLink":return function nt(c,o){return gr.apply(this,arguments)}(o,{email:a._email,oobCode:a._password});default:J(o,"internal-error")}})()}_linkToIdToken(o,a){var l=this;return(0,f.Z)(function*(){switch(l.signInMethod){case"password":return Ts(o,{idToken:a,returnSecureToken:!0,email:l._email,password:l._password});case"emailLink":return function rr(c,o){return xt.apply(this,arguments)}(o,{idToken:a,email:l._email,oobCode:l._password});default:J(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function zn(c,o){return mo.apply(this,arguments)}function mo(){return(mo=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithIdp",Te(c,o))})).apply(this,arguments)}class On extends Xn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const a=new On(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(a.idToken=o.idToken),o.accessToken&&(a.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(a.nonce=o.nonce),o.pendingToken&&(a.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(a.accessToken=o.oauthToken,a.secret=o.oauthTokenSecret):J("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:m}=a,v=(0,re._T)(a,["providerId","signInMethod"]);if(!l||!m)return null;const w=new On(l,m);return w.idToken=v.idToken||void 0,w.accessToken=v.accessToken||void 0,w.secret=v.secret,w.nonce=v.nonce,w.pendingToken=v.pendingToken||null,w}_getIdTokenResponse(o){return zn(o,this.buildRequest())}_linkToIdToken(o,a){const l=this.buildRequest();return l.idToken=a,zn(o,l)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,zn(o,a)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),o.postBody=(0,P.xO)(a)}return o}}function Ds(c,o){return ei.apply(this,arguments)}function ei(){return(ei=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:sendVerificationCode",Te(c,o))})).apply(this,arguments)}function go(){return(go=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithPhoneNumber",Te(c,o))})).apply(this,arguments)}function Ma(){return(Ma=(0,f.Z)(function*(c,o){const a=yield et(c,"POST","/v1/accounts:signInWithPhoneNumber",Te(c,o));if(a.temporaryProof)throw st(c,"account-exists-with-different-credential",a);return a})).apply(this,arguments)}const Gl={USER_NOT_FOUND:"user-not-found"};function ti(){return(ti=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithPhoneNumber",Te(c,Object.assign(Object.assign({},o),{operation:"REAUTH"})),Gl)})).apply(this,arguments)}class An extends Xn{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,a){return new An({verificationId:o,verificationCode:a})}static _fromTokenResponse(o,a){return new An({phoneNumber:o,temporaryProof:a})}_getIdTokenResponse(o){return function Bl(c,o){return go.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,a){return function zl(c,o){return Ma.apply(this,arguments)}(o,Object.assign({idToken:a},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function Kl(c,o){return ti.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:a,verificationId:l,verificationCode:m}=this.params;return o&&a?{temporaryProof:o,phoneNumber:a}:{sessionInfo:l,code:m}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:a,verificationCode:l,phoneNumber:m,temporaryProof:v}=o;return l||a||m||v?new An({verificationId:a,verificationCode:l,phoneNumber:m,temporaryProof:v}):null}}class Di{constructor(o){var a,l,m,v,w,R;const q=(0,P.zd)((0,P.pd)(o)),ee=null!==(a=q.apiKey)&&void 0!==a?a:null,fe=null!==(l=q.oobCode)&&void 0!==l?l:null,ge=function ic(c){switch(c){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(m=q.mode)&&void 0!==m?m:null);B(ee&&fe&&ge,"argument-error"),this.apiKey=ee,this.operation=ge,this.code=fe,this.continueUrl=null!==(v=q.continueUrl)&&void 0!==v?v:null,this.languageCode=null!==(w=q.languageCode)&&void 0!==w?w:null,this.tenantId=null!==(R=q.tenantId)&&void 0!==R?R:null}static parseLink(o){const a=function sc(c){const o=(0,P.zd)((0,P.pd)(c)).link,a=o?(0,P.zd)((0,P.pd)(o)).deep_link_id:null,l=(0,P.zd)((0,P.pd)(c)).deep_link_id;return(l?(0,P.zd)((0,P.pd)(l)).link:null)||l||a||o||c}(o);try{return new Di(a)}catch{return null}}}let Na=(()=>{class c{constructor(){this.providerId=c.PROVIDER_ID}static credential(a,l){return Rr._fromEmailAndPassword(a,l)}static credentialWithLink(a,l){const m=Di.parseLink(l);return B(m,"argument-error"),Rr._fromEmailAndCode(a,m.code,m.tenantId)}}return c.PROVIDER_ID="password",c.EMAIL_PASSWORD_SIGN_IN_METHOD="password",c.EMAIL_LINK_SIGN_IN_METHOD="emailLink",c})();class _r{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class ni extends _r{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class Ri extends ni{static credentialFromJSON(o){const a="string"==typeof o?JSON.parse(o):o;return B("providerId"in a&&"signInMethod"in a,"argument-error"),On._fromParams(a)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return B(o.idToken||o.accessToken,"argument-error"),On._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return Ri.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return Ri.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:m,pendingToken:v,nonce:w,providerId:R}=o;if(!l&&!m&&!a&&!v||!R)return null;try{return new Ri(R)._credential({idToken:a,accessToken:l,nonce:w,pendingToken:v})}catch{return null}}}let Oa=(()=>{class c extends ni{constructor(){super("facebook.com")}static credential(a){return On._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.FACEBOOK_SIGN_IN_METHOD="facebook.com",c.PROVIDER_ID="facebook.com",c})(),Pa=(()=>{class c extends ni{constructor(){super("google.com"),this.addScope("profile")}static credential(a,l){return On._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthIdToken:l,oauthAccessToken:m}=a;if(!l&&!m)return null;try{return c.credential(l,m)}catch{return null}}}return c.GOOGLE_SIGN_IN_METHOD="google.com",c.PROVIDER_ID="google.com",c})(),_o=(()=>{class c extends ni{constructor(){super("github.com")}static credential(a){return On._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.GITHUB_SIGN_IN_METHOD="github.com",c.PROVIDER_ID="github.com",c})();class ri extends Xn{constructor(o,a){super(o,o),this.pendingToken=a}_getIdTokenResponse(o){return zn(o,this.buildRequest())}_linkToIdToken(o,a){const l=this.buildRequest();return l.idToken=a,zn(o,l)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,zn(o,a)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:m,pendingToken:v}=a;return l&&m&&v&&l===m?new ri(l,v):null}static _create(o,a){return new ri(o,a)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Mi extends _r{constructor(o){B(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return Mi.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return Mi.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const a=ri.fromJSON(o);return B(a,"argument-error"),a}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:a,providerId:l}=o;if(!a||!l)return null;try{return ri._create(l,a)}catch{return null}}}let ac=(()=>{class c extends ni{constructor(){super("twitter.com")}static credential(a,l){return On._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthAccessToken:l,oauthTokenSecret:m}=a;if(!l||!m)return null;try{return c.credential(l,m)}catch{return null}}}return c.TWITTER_SIGN_IN_METHOD="twitter.com",c.PROVIDER_ID="twitter.com",c})();function yo(c,o){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signUp",Te(c,o))})).apply(this,arguments)}class _n{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,a,l,m=!1){return(0,f.Z)(function*(){const v=yield g._fromIdTokenResponse(o,l,m),w=Ni(l);return new _n({user:v,providerId:w,_tokenResponse:l,operationType:a})})()}static _forOperation(o,a,l){return(0,f.Z)(function*(){yield o._updateTokensIfNecessary(l,!0);const m=Ni(l);return new _n({user:o,providerId:m,_tokenResponse:l,operationType:a})})()}}function Ni(c){return c.providerId?c.providerId:"phoneNumber"in c?"phone":null}function Ms(){return(Ms=(0,f.Z)(function*(c){var o;const a=ct(c);if(yield a._initializationPromise,null!==(o=a.currentUser)&&void 0!==o&&o.isAnonymous)return new _n({user:a.currentUser,providerId:null,operationType:"signIn"});const l=yield yo(a,{returnSecureToken:!0}),m=yield _n._fromIdTokenResponse(a,"signIn",l,!0);return yield a._updateCurrentUser(m.user),m})).apply(this,arguments)}class Ns extends P.ZR{constructor(o,a,l,m){var v;super(a.code,a.message),this.operationType=l,this.user=m,Object.setPrototypeOf(this,Ns.prototype),this.customData={appName:o.name,tenantId:null!==(v=o.tenantId)&&void 0!==v?v:void 0,_serverResponse:a.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(o,a,l,m){return new Ns(o,a,l,m)}}function Oi(c,o,a,l){return("reauthenticate"===o?a._getReauthenticationResolver(c):a._getIdTokenResponse(c)).catch(v=>{throw"auth/multi-factor-auth-required"===v.code?Ns._fromErrorAndOperation(c,v,o,l):v})}function Pi(c){return new Set(c.map(({providerId:o})=>o).filter(o=>!!o))}function yt(){return(yt=(0,f.Z)(function*(c,o){const a=(0,P.m9)(c);yield Eo(!0,a,o);const{providerUserInfo:l}=yield $t(a.auth,{idToken:yield a.getIdToken(),deleteProvider:[o]}),m=Pi(l||[]);return a.providerData=a.providerData.filter(v=>m.has(v.providerId)),m.has("phone")||(a.phoneNumber=null),yield a.auth._persistUserIfCurrent(a),a})).apply(this,arguments)}function Io(c,o){return Ua.apply(this,arguments)}function Ua(){return(Ua=(0,f.Z)(function*(c,o,a=!1){const l=yield St(c,o._linkToIdToken(c.auth,yield c.getIdToken()),a);return _n._forOperation(c,"link",l)})).apply(this,arguments)}function Eo(c,o,a){return Va.apply(this,arguments)}function Va(){return(Va=(0,f.Z)(function*(c,o,a){yield nn(o);const m=!1===c?"provider-already-linked":"no-such-provider";B(Pi(o.providerData).has(a)===c,o.auth,m)})).apply(this,arguments)}function Ba(c,o){return bo.apply(this,arguments)}function bo(){return(bo=(0,f.Z)(function*(c,o,a=!1){const{auth:l}=c,m="reauthenticate";try{const v=yield St(c,Oi(l,m,o,c),a);B(v.idToken,l,"internal-error");const w=Ot(v.idToken);B(w,l,"internal-error");const{sub:R}=w;return B(c.uid===R,l,"user-mismatch"),_n._forOperation(c,m,v)}catch(v){throw"auth/user-not-found"===v?.code&&J(l,"user-mismatch"),v}})).apply(this,arguments)}function za(c,o){return Li.apply(this,arguments)}function Li(){return(Li=(0,f.Z)(function*(c,o,a=!1){const l="signIn",m=yield Oi(c,l,o),v=yield _n._fromIdTokenResponse(c,l,m);return a||(yield c._updateCurrentUser(v.user)),v})).apply(this,arguments)}function Os(c,o){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,f.Z)(function*(c,o){return za(ct(c),o)})).apply(this,arguments)}function Ga(c,o){return wo.apply(this,arguments)}function wo(){return(wo=(0,f.Z)(function*(c,o){const a=(0,P.m9)(c);return yield Eo(!1,a,o.providerId),Io(a,o)})).apply(this,arguments)}function To(c,o){return ii.apply(this,arguments)}function ii(){return(ii=(0,f.Z)(function*(c,o){return Ba((0,P.m9)(c),o)})).apply(this,arguments)}function uc(c,o){return Ps.apply(this,arguments)}function Ps(){return(Ps=(0,f.Z)(function*(c,o){return et(c,"POST","/v1/accounts:signInWithCustomToken",Te(c,o))})).apply(this,arguments)}function So(){return(So=(0,f.Z)(function*(c,o){const a=ct(c),l=yield uc(a,{token:o,returnSecureToken:!0}),m=yield _n._fromIdTokenResponse(a,"signIn",l);return yield a._updateCurrentUser(m.user),m})).apply(this,arguments)}class Mr{constructor(o,a){this.factorId=o,this.uid=a.mfaEnrollmentId,this.enrollmentTime=new Date(a.enrolledAt).toUTCString(),this.displayName=a.displayName}static _fromServerResponse(o,a){return"phoneInfo"in a?Ka._fromServerResponse(o,a):"totpInfo"in a?xo._fromServerResponse(o,a):J(o,"internal-error")}}class Ka extends Mr{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,a){return new Ka(a)}}class xo extends Mr{constructor(o){super("totp",o)}static _fromServerResponse(o,a){return new xo(a)}}function ir(c,o,a){var l;B((null===(l=a.url)||void 0===l?void 0:l.length)>0,c,"invalid-continue-uri"),B(typeof a.dynamicLinkDomain>"u"||a.dynamicLinkDomain.length>0,c,"invalid-dynamic-link-domain"),o.continueUrl=a.url,o.dynamicLinkDomain=a.dynamicLinkDomain,o.canHandleCodeInApp=a.handleCodeInApp,a.iOS&&(B(a.iOS.bundleId.length>0,c,"missing-ios-bundle-id"),o.iOSBundleId=a.iOS.bundleId),a.android&&(B(a.android.packageName.length>0,c,"missing-android-pkg-name"),o.androidInstallApp=a.android.installApp,o.androidMinimumVersionCode=a.android.minimumVersion,o.androidPackageName=a.android.packageName)}function Co(){return Co=(0,f.Z)(function*(c,o,a){var l;const m=ct(c),v={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};if(null!==(l=m._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const w=yield ut(m,v,"getOobCode",!0);a&&ir(m,w,a),yield M(m,w)}else a&&ir(m,v,a),yield M(m,v).catch(function(){var w=(0,f.Z)(function*(R){if("auth/missing-recaptcha-token"!==R.code)return Promise.reject(R);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const q=yield ut(m,v,"getOobCode",!0);a&&ir(m,q,a),yield M(m,q)}});return function(R){return w.apply(this,arguments)}}())}),Co.apply(this,arguments)}function Ls(){return(Ls=(0,f.Z)(function*(c,o,a){yield bs((0,P.m9)(c),{oobCode:o,newPassword:a})})).apply(this,arguments)}function Fi(){return(Fi=(0,f.Z)(function*(c,o){yield As((0,P.m9)(c),{oobCode:o})})).apply(this,arguments)}function Wa(c,o){return ko.apply(this,arguments)}function ko(){return(ko=(0,f.Z)(function*(c,o){const a=(0,P.m9)(c),l=yield bs(a,{oobCode:o}),m=l.requestType;switch(B(m,a,"internal-error"),m){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":B(l.newEmail,a,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":B(l.mfaInfo,a,"internal-error");default:B(l.email,a,"internal-error")}let v=null;return l.mfaInfo&&(v=Mr._fromServerResponse(ct(a),l.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.newEmail:l.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.email:l.newEmail)||null,multiFactorInfo:v},operation:m}})).apply(this,arguments)}function Do(){return(Do=(0,f.Z)(function*(c,o){const{data:a}=yield Wa((0,P.m9)(c),o);return a.email})).apply(this,arguments)}function Ro(){return Ro=(0,f.Z)(function*(c,o,a){var l;const m=ct(c),v={returnSecureToken:!0,email:o,password:a,clientType:"CLIENT_TYPE_WEB"};let w;if(null!==(l=m._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const ee=yield ut(m,v,"signUpPassword");w=yo(m,ee)}else w=yo(m,v).catch(function(){var ee=(0,f.Z)(function*(fe){if("auth/missing-recaptcha-token"===fe.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const ge=yield ut(m,v,"signUpPassword");return yo(m,ge)}return Promise.reject(fe)});return function(fe){return ee.apply(this,arguments)}}());const R=yield w.catch(ee=>Promise.reject(ee)),q=yield _n._fromIdTokenResponse(m,"signIn",R);return yield m._updateCurrentUser(q.user),q}),Ro.apply(this,arguments)}function yn(){return yn=(0,f.Z)(function*(c,o,a){var l;const m=ct(c),v={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};function w(R,q){B(q.handleCodeInApp,m,"argument-error"),q&&ir(m,R,q)}if(null!==(l=m._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const R=yield ut(m,v,"getOobCode",!0);w(R,a),yield Y(m,R)}else w(v,a),yield Y(m,v).catch(function(){var R=(0,f.Z)(function*(q){if("auth/missing-recaptcha-token"!==q.code)return Promise.reject(q);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const ee=yield ut(m,v,"getOobCode",!0);w(ee,a),yield Y(m,ee)}});return function(q){return R.apply(this,arguments)}}())}),yn.apply(this,arguments)}function Nr(){return(Nr=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c),m=Na.credentialWithLink(o,a||at());return B(m._tenantId===(l.tenantId||null),l,"tenant-id-mismatch"),Os(l,m)})).apply(this,arguments)}function Wl(c,o){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:createAuthUri",Te(c,o))})).apply(this,arguments)}function tt(){return(tt=(0,f.Z)(function*(c,o){const l={identifier:o,continueUri:dt()?at():"http://localhost"},{signinMethods:m}=yield Wl((0,P.m9)(c),l);return m||[]})).apply(this,arguments)}function Fs(){return(Fs=(0,f.Z)(function*(c,o){const a=(0,P.m9)(c),m={requestType:"VERIFY_EMAIL",idToken:yield c.getIdToken()};o&&ir(a.auth,m,o);const{email:v}=yield k(a.auth,m);v!==c.email&&(yield c.reload())})).apply(this,arguments)}function No(){return(No=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c),v={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield c.getIdToken(),newEmail:o};a&&ir(l.auth,v,a);const{email:w}=yield He(l.auth,v);w!==c.email&&(yield c.reload())})).apply(this,arguments)}function qa(c,o){return Or.apply(this,arguments)}function Or(){return(Or=(0,f.Z)(function*(c,o){return Ie(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Oo(){return(Oo=(0,f.Z)(function*(c,{displayName:o,photoURL:a}){if(void 0===o&&void 0===a)return;const l=(0,P.m9)(c),v={idToken:yield l.getIdToken(),displayName:o,photoUrl:a,returnSecureToken:!0},w=yield St(l,qa(l.auth,v));l.displayName=w.displayName||null,l.photoURL=w.photoUrl||null;const R=l.providerData.find(({providerId:q})=>"password"===q);R&&(R.displayName=l.displayName,R.photoURL=l.photoURL),yield l._updateTokensIfNecessary(w)})).apply(this,arguments)}function Yt(c,o,a){return Ui.apply(this,arguments)}function Ui(){return(Ui=(0,f.Z)(function*(c,o,a){const{auth:l}=c,v={idToken:yield c.getIdToken(),returnSecureToken:!0};o&&(v.email=o),a&&(v.password=a);const w=yield St(c,Ts(l,v));yield c._updateTokensIfNecessary(w,!0)})).apply(this,arguments)}class or{constructor(o,a,l={}){this.isNewUser=o,this.providerId=a,this.profile=l}}class Us extends or{constructor(o,a,l,m){super(o,a,l),this.username=m}}class mc extends or{constructor(o,a){super(o,"facebook.com",a)}}class Vi extends Us{constructor(o,a){super(o,"github.com",a,"string"==typeof a?.login?a?.login:null)}}class ql extends or{constructor(o,a){super(o,"google.com",a)}}class Hl extends Us{constructor(o,a,l){super(o,"twitter.com",a,l)}}function Za(c){const{user:o,_tokenResponse:a}=c;return o.isAnonymous&&!a?{providerId:null,isNewUser:!1,profile:null}:function Po(c){var o,a;if(!c)return null;const{providerId:l}=c,m=c.rawUserInfo?JSON.parse(c.rawUserInfo):{},v=c.isNewUser||"identitytoolkit#SignupNewUserResponse"===c.kind;if(!l&&c?.idToken){const w=null===(a=null===(o=Ot(c.idToken))||void 0===o?void 0:o.firebase)||void 0===a?void 0:a.sign_in_provider;if(w)return new or(v,"anonymous"!==w&&"custom"!==w?w:null)}if(!l)return null;switch(l){case"facebook.com":return new mc(v,m);case"github.com":return new Vi(v,m);case"google.com":return new ql(v,m);case"twitter.com":return new Hl(v,m,c.screenName||null);case"custom":case"anonymous":return new or(v,null);default:return new or(v,l,m)}}(a)}class Kn{constructor(o,a,l){this.type=o,this.credential=a,this.auth=l}static _fromIdtoken(o,a){return new Kn("enroll",o,a)}static _fromMfaPendingCredential(o){return new Kn("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var a,l;if(o?.multiFactorSession){if(null!==(a=o.multiFactorSession)&&void 0!==a&&a.pendingCredential)return Kn._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(l=o.multiFactorSession)&&void 0!==l&&l.idToken)return Kn._fromIdtoken(o.multiFactorSession.idToken)}return null}}class ar{constructor(o,a,l){this.session=o,this.hints=a,this.signInResolver=l}static _fromError(o,a){const l=ct(o),m=a.customData._serverResponse,v=(m.mfaInfo||[]).map(R=>Mr._fromServerResponse(l,R));B(m.mfaPendingCredential,l,"internal-error");const w=Kn._fromMfaPendingCredential(m.mfaPendingCredential);return new ar(w,v,function(){var R=(0,f.Z)(function*(q){const ee=yield q._process(l,w);delete m.mfaInfo,delete m.mfaPendingCredential;const fe=Object.assign(Object.assign({},m),{idToken:ee.idToken,refreshToken:ee.refreshToken});switch(a.operationType){case"signIn":const ge=yield _n._fromIdTokenResponse(l,a.operationType,fe);return yield l._updateCurrentUser(ge.user),ge;case"reauthenticate":return B(a.user,l,"internal-error"),_n._forOperation(a.user,a.operationType,fe);default:J(l,"internal-error")}});return function(q){return R.apply(this,arguments)}}())}resolveSignIn(o){var a=this;return(0,f.Z)(function*(){return a.signInResolver(o)})()}}function Yl(c,o){return Ie(c,"POST","/v2/accounts/mfaEnrollment:start",Te(c,o))}class he{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(l=>Mr._fromServerResponse(o.auth,l)))})}static _fromUser(o){return new he(o)}getSession(){var o=this;return(0,f.Z)(function*(){return Kn._fromIdtoken(yield o.user.getIdToken(),o.user.auth)})()}enroll(o,a){var l=this;return(0,f.Z)(function*(){const m=o,v=yield l.getSession(),w=yield St(l.user,m._process(l.user.auth,v,a));return yield l.user._updateTokensIfNecessary(w),l.user.reload()})()}unenroll(o){var a=this;return(0,f.Z)(function*(){const l="string"==typeof o?o:o.uid,m=yield a.user.getIdToken();try{const v=yield St(a.user,function Xa(c,o){return Ie(c,"POST","/v2/accounts/mfaEnrollment:withdraw",Te(c,o))}(a.user.auth,{idToken:m,mfaEnrollmentId:l}));a.enrolledFactors=a.enrolledFactors.filter(({uid:w})=>w!==l),yield a.user._updateTokensIfNecessary(v),yield a.user.reload()}catch(v){throw v}})()}}const ve=new WeakMap,se="__sak";class L{constructor(o,a){this.storageRetriever=o,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(se,"1"),this.storage.removeItem(se),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,a){return this.storage.setItem(o,JSON.stringify(a)),Promise.resolve()}_get(o){const a=this.storage.getItem(o);return Promise.resolve(a?JSON.parse(a):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const Lo=(()=>{class c extends L{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,l)=>this.onStorageEvent(a,l),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function $(){const c=(0,P.z$)();return Zt(c)||Tn(c)}()&&function Mn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Qn(),this._shouldAllowMigration=!0}forAllChangedKeys(a){for(const l of Object.keys(this.listeners)){const m=this.storage.getItem(l),v=this.localCache[l];m!==v&&a(l,v,m)}}onStorageEvent(a,l=!1){if(!a.key)return void this.forAllChangedKeys((R,q,ee)=>{this.notifyListeners(R,ee)});const m=a.key;if(l?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const R=this.storage.getItem(m);if(a.newValue!==R)null!==a.newValue?this.storage.setItem(m,a.newValue):this.storage.removeItem(m);else if(this.localCache[m]===a.newValue&&!l)return}const v=()=>{const R=this.storage.getItem(m);!l&&this.localCache[m]===R||this.notifyListeners(m,R)},w=this.storage.getItem(m);!function fr(){return(0,P.w1)()&&10===document.documentMode}()||w===a.newValue||a.newValue===a.oldValue?v():setTimeout(v,10)}notifyListeners(a,l){this.localCache[a]=l;const m=this.listeners[a];if(m)for(const v of Array.from(m))v(l&&JSON.parse(l))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,l,m)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:l,newValue:m}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(a,l){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[a]||(this.listeners[a]=new Set,this.localCache[a]=this.storage.getItem(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(a,l){var m=()=>super._set,v=this;return(0,f.Z)(function*(){yield m().call(v,a,l),v.localCache[a]=JSON.stringify(l)})()}_get(a){var l=()=>super._get,m=this;return(0,f.Z)(function*(){const v=yield l().call(m,a);return m.localCache[a]=JSON.stringify(v),v})()}_remove(a){var l=()=>super._remove,m=this;return(0,f.Z)(function*(){yield l().call(m,a),delete m.localCache[a]})()}}return c.type="LOCAL",c})(),Pr=(()=>{class c extends L{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(a,l){}_removeListener(a,l){}}return c.type="SESSION",c})();let yc=(()=>{class c{constructor(a){this.eventTarget=a,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(a){const l=this.receivers.find(v=>v.isListeningto(a));if(l)return l;const m=new c(a);return this.receivers.push(m),m}isListeningto(a){return this.eventTarget===a}handleEvent(a){var l=this;return(0,f.Z)(function*(){const m=a,{eventId:v,eventType:w,data:R}=m.data,q=l.handlersMap[w];if(!q?.size)return;m.ports[0].postMessage({status:"ack",eventId:v,eventType:w});const ee=Array.from(q).map(function(){var ge=(0,f.Z)(function*(wt){return wt(m.origin,R)});return function(wt){return ge.apply(this,arguments)}}()),fe=yield function Jl(c){return Promise.all(c.map(function(){var o=(0,f.Z)(function*(a){try{return{fulfilled:!0,value:yield a}}catch(l){return{fulfilled:!1,reason:l}}});return function(a){return o.apply(this,arguments)}}()))}(ee);m.ports[0].postMessage({status:"done",eventId:v,eventType:w,response:fe})})()}_subscribe(a,l){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[a]||(this.handlersMap[a]=new Set),this.handlersMap[a].add(l)}_unsubscribe(a,l){this.handlersMap[a]&&l&&this.handlersMap[a].delete(l),(!l||0===this.handlersMap[a].size)&&delete this.handlersMap[a],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return c.receivers=[],c})();function Bs(c="",o=10){let a="";for(let l=0;l<o;l++)a+=Math.floor(10*Math.random());return c+a}class If{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,a,l=50){var m=this;return(0,f.Z)(function*(){const v=typeof MessageChannel<"u"?new MessageChannel:null;if(!v)throw new Error("connection_unavailable");let w,R;return new Promise((q,ee)=>{const fe=Bs("",20);v.port1.start();const ge=setTimeout(()=>{ee(new Error("unsupported_event"))},l);R={messageChannel:v,onMessage(wt){const tr=wt;if(tr.data.eventId===fe)switch(tr.data.status){case"ack":clearTimeout(ge),w=setTimeout(()=>{ee(new Error("timeout"))},3e3);break;case"done":clearTimeout(w),q(tr.data.response);break;default:clearTimeout(ge),clearTimeout(w),ee(new Error("invalid_response"))}}},m.handlers.add(R),v.port1.addEventListener("message",R.onMessage),m.target.postMessage({eventType:o,eventId:fe,data:a},[v.port2])}).finally(()=>{R&&m.removeMessageHandler(R)})})()}}function Ft(){return window}function Ce(){return typeof Ft().WorkerGlobalScope<"u"&&"function"==typeof Ft().importScripts}function Fo(){return(Fo=(0,f.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const zi="firebaseLocalStorageDb",Uo="firebaseLocalStorage",bt="fbase_key";class ne{constructor(o){this.request=o}toPromise(){return new Promise((o,a)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function oi(c,o){return c.transaction([Uo],o?"readwrite":"readonly").objectStore(Uo)}function vr(){const c=indexedDB.open(zi,1);return new Promise((o,a)=>{c.addEventListener("error",()=>{a(c.error)}),c.addEventListener("upgradeneeded",()=>{const l=c.result;try{l.createObjectStore(Uo,{keyPath:bt})}catch(m){a(m)}}),c.addEventListener("success",(0,f.Z)(function*(){const l=c.result;l.objectStoreNames.contains(Uo)?o(l):(l.close(),yield function Ja(){const c=indexedDB.deleteDatabase(zi);return new ne(c).toPromise()}(),o(yield vr()))}))})}function Ic(c,o,a){return Gi.apply(this,arguments)}function Gi(){return(Gi=(0,f.Z)(function*(c,o,a){const l=oi(c,!0).put({[bt]:o,value:a});return new ne(l).toPromise()})).apply(this,arguments)}function ai(){return(ai=(0,f.Z)(function*(c,o){const a=oi(c,!1).get(o),l=yield new ne(a).toPromise();return void 0===l?null:l.value})).apply(this,arguments)}function eu(c,o){const a=oi(c,!0).delete(o);return new ne(a).toPromise()}const ui=(()=>{class c{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var a=this;return(0,f.Z)(function*(){return a.db||(a.db=yield vr()),a.db})()}_withRetries(a){var l=this;return(0,f.Z)(function*(){let m=0;for(;;)try{const v=yield l._openDb();return yield a(v)}catch(v){if(m++>3)throw v;l.db&&(l.db.close(),l.db=void 0)}})()}initializeServiceWorkerMessaging(){var a=this;return(0,f.Z)(function*(){return Ce()?a.initializeReceiver():a.initializeSender()})()}initializeReceiver(){var a=this;return(0,f.Z)(function*(){a.receiver=yc._getInstance(function Ee(){return Ce()?self:null}()),a.receiver._subscribe("keyChanged",function(){var l=(0,f.Z)(function*(m,v){return{keyProcessed:(yield a._poll()).includes(v.key)}});return function(m,v){return l.apply(this,arguments)}}()),a.receiver._subscribe("ping",function(){var l=(0,f.Z)(function*(m,v){return["keyChanged"]});return function(m,v){return l.apply(this,arguments)}}())})()}initializeSender(){var a=this;return(0,f.Z)(function*(){var l,m;if(a.activeServiceWorker=yield function Bi(){return Fo.apply(this,arguments)}(),!a.activeServiceWorker)return;a.sender=new If(a.activeServiceWorker);const v=yield a.sender._send("ping",{},800);!v||(null===(l=v[0])||void 0===l?void 0:l.fulfilled)&&(null===(m=v[0])||void 0===m?void 0:m.value.includes("keyChanged"))&&(a.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(a){var l=this;return(0,f.Z)(function*(){if(l.sender&&l.activeServiceWorker&&function vt(){var c;return(null===(c=navigator?.serviceWorker)||void 0===c?void 0:c.controller)||null}()===l.activeServiceWorker)try{yield l.sender._send("keyChanged",{key:a},l.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const a=yield vr();return yield Ic(a,se,"1"),yield eu(a,se),!0}catch{}return!1})()}_withPendingWrite(a){var l=this;return(0,f.Z)(function*(){l.pendingWrites++;try{yield a()}finally{l.pendingWrites--}})()}_set(a,l){var m=this;return(0,f.Z)(function*(){return m._withPendingWrite((0,f.Z)(function*(){return yield m._withRetries(v=>Ic(v,a,l)),m.localCache[a]=l,m.notifyServiceWorker(a)}))})()}_get(a){var l=this;return(0,f.Z)(function*(){const m=yield l._withRetries(v=>function ed(c,o){return ai.apply(this,arguments)}(v,a));return l.localCache[a]=m,m})()}_remove(a){var l=this;return(0,f.Z)(function*(){return l._withPendingWrite((0,f.Z)(function*(){return yield l._withRetries(m=>eu(m,a)),delete l.localCache[a],l.notifyServiceWorker(a)}))})()}_poll(){var a=this;return(0,f.Z)(function*(){const l=yield a._withRetries(w=>{const R=oi(w,!1).getAll();return new ne(R).toPromise()});if(!l)return[];if(0!==a.pendingWrites)return[];const m=[],v=new Set;for(const{fbase_key:w,value:R}of l)v.add(w),JSON.stringify(a.localCache[w])!==JSON.stringify(R)&&(a.notifyListeners(w,R),m.push(w));for(const w of Object.keys(a.localCache))a.localCache[w]&&!v.has(w)&&(a.notifyListeners(w,null),m.push(w));return m})()}notifyListeners(a,l){this.localCache[a]=l;const m=this.listeners[a];if(m)for(const v of Array.from(m))v(l)}startPolling(){var a=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return a._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(a,l){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[a]||(this.listeners[a]=new Set,this._get(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return c.type="LOCAL",c})();function wc(c,o){return Ie(c,"POST","/v2/accounts/mfaSignIn:start",Te(c,o))}const Sn=1e12;class td{constructor(o){this.auth=o,this.counter=Sn,this._widgets=new Map}render(o,a){const l=this.counter;return this._widgets.set(l,new zs(o,this.auth.name,a||{})),this.counter++,l}reset(o){var a;const l=o||Sn;null===(a=this._widgets.get(l))||void 0===a||a.delete(),this._widgets.delete(l)}getResponse(o){var a;return(null===(a=this._widgets.get(o||Sn))||void 0===a?void 0:a.getResponse())||""}execute(o){var a=this;return(0,f.Z)(function*(){var l;return null===(l=a._widgets.get(o||Sn))||void 0===l||l.execute(),""})()}}class zs{constructor(o,a,l){this.params=l,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const m="string"==typeof o?document.getElementById(o):o;B(m,"argument-error",{appName:a}),this.container=m,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Fr(c){const o=[],a="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let l=0;l<c;l++)o.push(a.charAt(Math.floor(Math.random()*a.length)));return o.join("")}(50);const{callback:o,"expired-callback":a}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,a)try{a()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const nu=$r("rcb"),ci=new Re(3e4,6e4);class ru{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=Ft().grecaptcha)||void 0===o||!o.render)}load(o,a=""){return B(function nd(c){return c.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(c)}(a),o,"argument-error"),this.shouldResolveImmediately(a)&&_s(Ft().grecaptcha)?Promise.resolve(Ft().grecaptcha):new Promise((l,m)=>{const v=Ft().setTimeout(()=>{m(oe(o,"network-request-failed"))},ci.get());Ft()[nu]=()=>{Ft().clearTimeout(v),delete Ft()[nu];const R=Ft().grecaptcha;if(!R||!_s(R))return void m(oe(o,"internal-error"));const q=R.render;R.render=(ee,fe)=>{const ge=q(ee,fe);return this.counter++,ge},this.hostLanguage=a,l(R)},Nn(`https://www.google.com/recaptcha/api.js??${(0,P.xO)({onload:nu,render:"explicit",hl:a})}`).catch(()=>{clearTimeout(v),m(oe(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var a;return!(null===(a=Ft().grecaptcha)||void 0===a||!a.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class rd{load(o){return(0,f.Z)(function*(){return new td(o)})()}clearedOneInstance(){}}const xn="recaptcha",Gs={theme:"light",type:"image"};class Ks{constructor(o,a=Object.assign({},Gs),l){this.parameters=a,this.type=xn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ct(l),this.isInvisible="invisible"===this.parameters.size,B(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const m="string"==typeof o?document.getElementById(o):o;B(m,this.auth,"argument-error"),this.container=m,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new rd:new ru,this.validateStartingState()}verify(){var o=this;return(0,f.Z)(function*(){o.assertNotDestroyed();const a=yield o.render(),l=o.getAssertedRecaptcha();return l.getResponse(a)||new Promise(v=>{const w=R=>{!R||(o.tokenChangeListeners.delete(w),v(R))};o.tokenChangeListeners.add(w),o.isInvisible&&l.execute(a)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){B(!this.parameters.sitekey,this.auth,"argument-error"),B(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),B(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return a=>{if(this.tokenChangeListeners.forEach(l=>l(a)),"function"==typeof o)o(a);else if("string"==typeof o){const l=Ft()[o];"function"==typeof l&&l(a)}}}assertNotDestroyed(){B(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,f.Z)(function*(){if(yield o.init(),!o.widgetId){let a=o.container;if(!o.isInvisible){const l=document.createElement("div");a.appendChild(l),a=l}o.widgetId=o.getAssertedRecaptcha().render(a,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,f.Z)(function*(){B(dt()&&!Ce(),o.auth,"internal-error"),yield function Ac(){let c=null;return new Promise(o=>{"complete"!==document.readyState?(c=()=>o(),window.addEventListener("load",c)):o()}).catch(o=>{throw c&&window.removeEventListener("load",c),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const a=yield function Ti(c){return mr.apply(this,arguments)}(o.auth);B(a,o.auth,"internal-error"),o.parameters.sitekey=a})()}getAssertedRecaptcha(){return B(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Xt{constructor(o,a){this.verificationId=o,this.onConfirmation=a}confirm(o){const a=An._fromVerification(this.verificationId,o);return this.onConfirmation(a)}}function Bo(){return(Bo=(0,f.Z)(function*(c,o,a){const l=ct(c),m=yield jo(l,o,(0,P.m9)(a));return new Xt(m,v=>Os(l,v))})).apply(this,arguments)}function zo(){return(zo=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c);yield Eo(!1,l,"phone");const m=yield jo(l.auth,o,(0,P.m9)(a));return new Xt(m,v=>Ga(l,v))})).apply(this,arguments)}function Ko(){return(Ko=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c),m=yield jo(l.auth,o,(0,P.m9)(a));return new Xt(m,v=>To(l,v))})).apply(this,arguments)}function jo(c,o,a){return iu.apply(this,arguments)}function iu(){return(iu=(0,f.Z)(function*(c,o,a){var l;const m=yield a.verify();try{let v;if(B("string"==typeof m,c,"argument-error"),B(a.type===xn,c,"argument-error"),v="string"==typeof o?{phoneNumber:o}:o,"session"in v){const w=v.session;if("phoneNumber"in v)return B("enroll"===w.type,c,"internal-error"),(yield Yl(c,{idToken:w.credential,phoneEnrollmentInfo:{phoneNumber:v.phoneNumber,recaptchaToken:m}})).phoneSessionInfo.sessionInfo;{B("signin"===w.type,c,"internal-error");const R=(null===(l=v.multiFactorHint)||void 0===l?void 0:l.uid)||v.multiFactorUid;return B(R,c,"missing-multi-factor-info"),(yield wc(c,{mfaPendingCredential:w.credential,mfaEnrollmentId:R,phoneSignInInfo:{recaptchaToken:m}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:w}=yield Ds(c,{phoneNumber:v.phoneNumber,recaptchaToken:m});return w}}finally{a._reset()}})).apply(this,arguments)}function su(){return(su=(0,f.Z)(function*(c,o){yield Io((0,P.m9)(c),o)})).apply(this,arguments)}let js=(()=>{class c{constructor(a){this.providerId=c.PROVIDER_ID,this.auth=ct(a)}verifyPhoneNumber(a,l){return jo(this.auth,a,(0,P.m9)(l))}static credential(a,l){return An._fromVerification(a,l)}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{phoneNumber:l,temporaryProof:m}=a;return l&&m?An._fromTokenResponse(l,m):null}}return c.PROVIDER_ID="phone",c.PHONE_SIGN_IN_METHOD="phone",c})();function li(c,o){return o?E(o):(B(c._popupRedirectResolver,c,"argument-error"),c._popupRedirectResolver)}class ou extends Xn{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return zn(o,this._buildIdpRequest())}_linkToIdToken(o,a){return zn(o,this._buildIdpRequest(a))}_getReauthenticationResolver(o){return zn(o,this._buildIdpRequest())}_buildIdpRequest(o){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(a.idToken=o),a}}function od(c){return za(c.auth,new ou(c),c.bypassAuthState)}function ad(c){const{auth:o,user:a}=c;return B(a,o,"internal-error"),Ba(a,new ou(c),c.bypassAuthState)}function ud(c){return au.apply(this,arguments)}function au(){return(au=(0,f.Z)(function*(c){const{auth:o,user:a}=c;return B(a,o,"internal-error"),Io(a,new ou(c),c.bypassAuthState)})).apply(this,arguments)}class Sc{constructor(o,a,l,m,v=!1){this.auth=o,this.resolver=l,this.user=m,this.bypassAuthState=v,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){var o=this;return new Promise(function(){var a=(0,f.Z)(function*(l,m){o.pendingPromise={resolve:l,reject:m};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(v){o.reject(v)}});return function(l,m){return a.apply(this,arguments)}}())}onAuthEvent(o){var a=this;return(0,f.Z)(function*(){const{urlResponse:l,sessionId:m,postBody:v,tenantId:w,error:R,type:q}=o;if(R)return void a.reject(R);const ee={auth:a.auth,requestUri:l,sessionId:m,tenantId:w||void 0,postBody:v||void 0,user:a.user,bypassAuthState:a.bypassAuthState};try{a.resolve(yield a.getIdpTask(q)(ee))}catch(fe){a.reject(fe)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return od;case"linkViaPopup":case"linkViaRedirect":return ud;case"reauthViaPopup":case"reauthViaRedirect":return ad;default:J(this.auth,"internal-error")}}resolve(o){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cd=new Re(2e3,1e4);function uu(){return(uu=(0,f.Z)(function*(c,o,a){const l=ct(c);Se(c,o,_r);const m=li(l,a);return new lu(l,"signInViaPopup",o,m).executeNotNull()})).apply(this,arguments)}function cu(){return(cu=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c);Se(l.auth,o,_r);const m=li(l.auth,a);return new lu(l.auth,"reauthViaPopup",o,m,l).executeNotNull()})).apply(this,arguments)}function Wo(){return(Wo=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c);Se(l.auth,o,_r);const m=li(l.auth,a);return new lu(l.auth,"linkViaPopup",o,m,l).executeNotNull()})).apply(this,arguments)}let lu=(()=>{class c extends Sc{constructor(a,l,m,v,w){super(a,l,v,w),this.provider=m,this.authWindow=null,this.pollId=null,c.currentPopupAction&&c.currentPopupAction.cancel(),c.currentPopupAction=this}executeNotNull(){var a=this;return(0,f.Z)(function*(){const l=yield a.execute();return B(l,a.auth,"internal-error"),l})()}onExecution(){var a=this;return(0,f.Z)(function*(){be(1===a.filter.length,"Popup operations only handle one event");const l=Bs();a.authWindow=yield a.resolver._openPopup(a.auth,a.provider,a.filter[0],l),a.authWindow.associatedEvent=l,a.resolver._originValidation(a.auth).catch(m=>{a.reject(m)}),a.resolver._isIframeWebStorageSupported(a.auth,m=>{m||a.reject(oe(a.auth,"web-storage-unsupported"))}),a.pollUserCancellation()})()}get eventId(){var a;return(null===(a=this.authWindow)||void 0===a?void 0:a.associatedEvent)||null}cancel(){this.reject(oe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,c.currentPopupAction=null}pollUserCancellation(){const a=()=>{var l,m;this.pollId=null!==(m=null===(l=this.authWindow)||void 0===l?void 0:l.window)&&void 0!==m&&m.closed?window.setTimeout(()=>{this.pollId=null,this.reject(oe(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(a,cd.get())};a()}}return c.currentPopupAction=null,c})();const Ct=new Map;class kc extends Sc{constructor(o,a,l=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,l),this.eventId=null}execute(){var o=()=>super.execute,a=this;return(0,f.Z)(function*(){let l=Ct.get(a.auth._key());if(!l){try{const v=(yield function Ur(c,o){return $o.apply(this,arguments)}(a.resolver,a.auth))?yield o().call(a):null;l=()=>Promise.resolve(v)}catch(m){l=()=>Promise.reject(m)}Ct.set(a.auth._key(),l)}return a.bypassAuthState||Ct.set(a.auth._key(),()=>Promise.resolve(null)),l()})()}onAuthEvent(o){var a=()=>super.onAuthEvent,l=this;return(0,f.Z)(function*(){if("signInViaRedirect"===o.type)return a().call(l,o);if("unknown"!==o.type){if(o.eventId){const m=yield l.auth._redirectUserForId(o.eventId);if(m)return l.user=m,a().call(l,o);l.resolve(null)}}else l.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function $o(){return($o=(0,f.Z)(function*(c,o){const a=di(o),l=hu(c);if(!(yield l._isAvailable()))return!1;const m="true"===(yield l._get(a));return yield l._remove(a),m})).apply(this,arguments)}function ot(c,o){return Ki.apply(this,arguments)}function Ki(){return(Ki=(0,f.Z)(function*(c,o){return hu(c)._set(di(o),"true")})).apply(this,arguments)}function lt(c,o){Ct.set(c._key(),o)}function hu(c){return E(c._redirectPersistence)}function di(c){return ce("pendingRedirect",c.config.apiKey,c.name)}function fu(){return(fu=(0,f.Z)(function*(c,o,a){const l=ct(c);Se(c,o,_r),yield l._initializationPromise;const m=li(l,a);return yield ot(m,l),m._openRedirect(l,o,"signInViaRedirect")})).apply(this,arguments)}function cr(){return(cr=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c);Se(l.auth,o,_r),yield l.auth._initializationPromise;const m=li(l.auth,a);yield ot(m,l.auth);const v=yield Er(l);return m._openRedirect(l.auth,o,"reauthViaRedirect",v)})).apply(this,arguments)}function ji(){return(ji=(0,f.Z)(function*(c,o,a){const l=(0,P.m9)(c);Se(l.auth,o,_r),yield l.auth._initializationPromise;const m=li(l.auth,a);yield Eo(!1,l,o.providerId),yield ot(m,l.auth);const v=yield Er(l);return m._openRedirect(l.auth,o,"linkViaRedirect",v)})).apply(this,arguments)}function hi(){return(hi=(0,f.Z)(function*(c,o){return yield ct(c)._initializationPromise,Ho(c,o,!1)})).apply(this,arguments)}function Ho(c,o){return lr.apply(this,arguments)}function lr(){return(lr=(0,f.Z)(function*(c,o,a=!1){const l=ct(c),m=li(l,o),w=yield new kc(l,m,a).execute();return w&&!a&&(delete w.user._redirectEventId,yield l._persistUserIfCurrent(w.user),yield l._setRedirectUser(null,o)),w})).apply(this,arguments)}function Er(c){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,f.Z)(function*(c){const o=Bs(`${c.uid}:::`);return c._redirectEventId=o,yield c.auth._setRedirectUser(c),yield c.auth._persistUserIfCurrent(c),o})).apply(this,arguments)}class er{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let a=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(o,l)&&(a=!0,this.sendToConsumer(o,l),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function Rc(c){switch(c.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return br(c);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=o,a=!0)),a}sendToConsumer(o,a){var l;if(o.error&&!br(o)){const m=(null===(l=o.error.code)||void 0===l?void 0:l.split("auth/")[1])||"internal-error";a.onError(oe(this.auth,m))}else a.onAuthEvent(o)}isEventForConsumer(o,a){const l=null===a.eventId||!!o.eventId&&o.eventId===a.eventId;return a.filter.includes(o.type)&&l}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has($i(o))}saveEventToCache(o){this.cachedEventUids.add($i(o)),this.lastProcessedEventTime=Date.now()}}function $i(c){return[c.type,c.eventId,c.sessionId,c.tenantId].filter(o=>o).join("-")}function br({type:c,error:o}){return"unknown"===c&&"auth/no-auth-event"===o?.code}function fi(c){return Ws.apply(this,arguments)}function Ws(){return(Ws=(0,f.Z)(function*(c,o={}){return Ie(c,"GET","/v1/projects",o)})).apply(this,arguments)}const Zo=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pi=/^https?/;function mi(){return(mi=(0,f.Z)(function*(c){if(c.config.emulator)return;const{authorizedDomains:o}=yield fi(c);for(const a of o)try{if(Mc(a))return}catch{}J(c,"unauthorized-domain")})).apply(this,arguments)}function Mc(c){const o=at(),{protocol:a,hostname:l}=new URL(o);if(c.startsWith("chrome-extension://")){const w=new URL(c);return""===w.hostname&&""===l?"chrome-extension:"===a&&c.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===a&&w.hostname===l}if(!pi.test(a))return!1;if(Zo.test(c))return l===c;const m=c.replace(/\./g,"\\.");return new RegExp("^(.+\\."+m+"|"+m+")$","i").test(l)}const Nc=new Re(3e4,6e4);function $s(){const c=Ft().___jsl;if(c?.H)for(const o of Object.keys(c.H))if(c.H[o].r=c.H[o].r||[],c.H[o].L=c.H[o].L||[],c.H[o].r=[...c.H[o].L],c.CP)for(let a=0;a<c.CP.length;a++)c.CP[a]=null}let Hs=null;function hd(c){return Hs=Hs||function qs(c){return new Promise((o,a)=>{var l,m,v;function w(){$s(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{$s(),a(oe(c,"network-request-failed"))},timeout:Nc.get()})}if(null!==(m=null===(l=Ft().gapi)||void 0===l?void 0:l.iframes)&&void 0!==m&&m.Iframe)o(gapi.iframes.getContext());else{if(null===(v=Ft().gapi)||void 0===v||!v.load){const R=$r("iframefcb");return Ft()[R]=()=>{gapi.load?w():a(oe(c,"network-request-failed"))},Nn(`https://apis.google.com/js/api.js?onload=${R}`).catch(q=>a(q))}w()}}).catch(o=>{throw Hs=null,o})}(c),Hs}const fd=new Re(5e3,15e3),on={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lc=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mt(c){const o=c.config;B(o.authDomain,c,"auth-domain-config-required");const a=o.emulator?Pe(o,"emulator/auth/iframe"):`https://${c.config.authDomain}/__/auth/iframe`,l={apiKey:o.apiKey,appName:c.name,v:me.SDK_VERSION},m=Lc.get(c.config.apiHost);m&&(l.eid=m);const v=c._getFrameworks();return v.length&&(l.fw=v.join(",")),`${a}?${(0,P.xO)(l).slice(1)}`}function Qo(){return Qo=(0,f.Z)(function*(c){const o=yield hd(c),a=Ft().gapi;return B(a,c,"internal-error"),o.open({where:document.body,url:mt(c),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:on,dontclear:!0},l=>new Promise(function(){var m=(0,f.Z)(function*(v,w){yield l.restyle({setHideOnLeave:!1});const R=oe(c,"network-request-failed"),q=Ft().setTimeout(()=>{w(R)},fd.get());function ee(){Ft().clearTimeout(q),v(l)}l.ping(ee).then(ee,()=>{w(R)})});return function(v,w){return m.apply(this,arguments)}}()))}),Qo.apply(this,arguments)}const Fc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class rt{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const _u=encodeURIComponent("fac");function Yo(c,o,a,l,m,v){return Xo.apply(this,arguments)}function Xo(){return(Xo=(0,f.Z)(function*(c,o,a,l,m,v){B(c.config.authDomain,c,"auth-domain-config-required"),B(c.config.apiKey,c,"invalid-api-key");const w={apiKey:c.config.apiKey,appName:c.name,authType:a,redirectUrl:l,v:me.SDK_VERSION,eventId:m};if(o instanceof _r){o.setDefaultLanguage(c.languageCode),w.providerId=o.providerId||"",(0,P.xb)(o.getCustomParameters())||(w.customParameters=JSON.stringify(o.getCustomParameters()));for(const[fe,ge]of Object.entries(v||{}))w[fe]=ge}if(o instanceof ni){const fe=o.getScopes().filter(ge=>""!==ge);fe.length>0&&(w.scopes=fe.join(","))}c.tenantId&&(w.tid=c.tenantId);const R=w;for(const fe of Object.keys(R))void 0===R[fe]&&delete R[fe];const q=yield c._getAppCheckToken(),ee=q?`#${_u}=${encodeURIComponent(q)}`:"";return`${Bc(c)}?${(0,P.xO)(R).slice(1)}${ee}`})).apply(this,arguments)}function Bc({config:c}){return c.emulator?Pe(c,"emulator/auth/handler"):`https://${c.authDomain}/__/auth/handler`}const yu="webStorageSupport";class vu extends class Gc{constructor(o){this.factorId=o}_process(o,a,l){switch(a.type){case"enroll":return this._finalizeEnroll(o,a.credential,l);case"signin":return this._finalizeSignIn(o,a.credential);default:return Qe("unexpected MultiFactorSessionType")}}}{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new vu(o)}_finalizeEnroll(o,a,l){return function Q(c,o){return Ie(c,"POST","/v2/accounts/mfaEnrollment:finalize",Te(c,o))}(o,{idToken:a,displayName:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,a){return function Lr(c,o){return Ie(c,"POST","/v2/accounts/mfaSignIn:finalize",Te(c,o))}(o,{mfaPendingCredential:a,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Kc=(()=>{class c{constructor(){}static assertion(a){return vu._fromCredential(a)}}return c.FACTOR_ID="phone",c})();var zr="@firebase/auth";class Jo{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var a=this;return(0,f.Z)(function*(){return a.assertAuthConfigured(),yield a.auth._initializationPromise,a.auth.currentUser?{accessToken:yield a.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const a=this.auth.onIdTokenChanged(l=>{o(l?.stsTokenManager.accessToken||null)});this.internalListeners.set(o,a),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const a=this.internalListeners.get(o);!a||(this.internalListeners.delete(o),a(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Tr(){return window}function Ar(){return(Ar=(0,f.Z)(function*(c,o,a){var l;const{BuildInfo:m}=Tr();be(o.sessionId,"AuthEvent did not contain a session ID");const v=yield Ys(o.sessionId),w={};return Tn()?w.ibi=m.packageName:gn()?w.apn=m.packageName:J(c,"operation-not-supported-in-this-environment"),m.displayName&&(w.appDisplayName=m.displayName),w.sessionId=v,Yo(c,a,o.type,void 0,null!==(l=o.eventId)&&void 0!==l?l:void 0,w)})).apply(this,arguments)}function Zs(){return(Zs=(0,f.Z)(function*(c){const{BuildInfo:o}=Tr(),a={};Tn()?a.iosBundleId=o.packageName:gn()?a.androidPackageName=o.packageName:J(c,"operation-not-supported-in-this-environment"),yield fi(c,a)})).apply(this,arguments)}function ra(){return(ra=(0,f.Z)(function*(c,o,a){const{cordova:l}=Tr();let m=()=>{};try{yield new Promise((v,w)=>{let R=null;function q(){var ge;v();const wt=null===(ge=l.plugins.browsertab)||void 0===ge?void 0:ge.close;"function"==typeof wt&&wt(),"function"==typeof a?.close&&a.close()}function ee(){R||(R=window.setTimeout(()=>{w(oe(c,"redirect-cancelled-by-user"))},2e3))}function fe(){"visible"===document?.visibilityState&&ee()}o.addPassiveListener(q),document.addEventListener("resume",ee,!1),gn()&&document.addEventListener("visibilitychange",fe,!1),m=()=>{o.removePassiveListener(q),document.removeEventListener("resume",ee,!1),document.removeEventListener("visibilitychange",fe,!1),R&&window.clearTimeout(R)}})}finally{m()}})).apply(this,arguments)}function Ys(c){return ia.apply(this,arguments)}function ia(){return(ia=(0,f.Z)(function*(c){const o=qc(c),a=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(a)).map(m=>m.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function qc(c){if(be(/[0-9a-zA-Z]+/.test(c),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(c);const o=new ArrayBuffer(c.length),a=new Uint8Array(o);for(let l=0;l<c.length;l++)a[l]=c.charCodeAt(l);return a}(0,P.Pz)("authIdTokenMaxAge"),function Wc(c){(0,me._registerComponent)(new ye.wA("auth",(o,{options:a})=>{const l=o.getProvider("app").getImmediate(),m=o.getProvider("heartbeat"),v=o.getProvider("app-check-internal"),{apiKey:w,authDomain:R}=l.options;B(w&&!w.includes(":"),"invalid-api-key",{appName:l.name});const q={apiKey:w,authDomain:R,clientPlatform:c,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pr(c)},ee=new Zr(l,m,v,q);return function Vn(c,o){const a=o?.persistence||[],l=(Array.isArray(a)?a:[a]).map(E);o?.errorMap&&c._updateErrorMap(o.errorMap),c._initializeWithPersistence(l,o?.popupRedirectResolver)}(ee,a),ee},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,a,l)=>{o.getProvider("auth-internal").initialize()})),(0,me._registerComponent)(new ye.wA("auth-internal",o=>{const a=ct(o.getProvider("auth").getImmediate());return new Jo(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,me.registerVersion)(zr,"0.23.2",function ea(c){switch(c){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(c)),(0,me.registerVersion)(zr,"0.23.2","esm2017")}("Browser");class Sr extends er{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(o)),super.onEvent(o)}initialized(){var o=this;return(0,f.Z)(function*(){yield o.initPromise})()}}function Tu(c){return gi.apply(this,arguments)}function gi(){return(gi=(0,f.Z)(function*(c){const o=yield sa()._get(_i(c));return o&&(yield sa()._remove(_i(c))),o})).apply(this,arguments)}function dr(){const c=[],o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=0;a<20;a++){const l=Math.floor(Math.random()*o.length);c.push(o.charAt(l))}return c.join("")}function sa(){return E(Lo)}function _i(c){return ce("authEvent",c.config.apiKey,c.name)}function ke(c){if(!c?.includes("?"))return{};const[o,...a]=c.split("?");return(0,P.zd)(a.join("?"))}function Su(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:oe("no-auth-event")}}function Xi(){var c;return(null===(c=self?.location)||void 0===c?void 0:c.protocol)||null}function Gr(c=(0,P.z$)()){return!("file:"!==Xi()&&"ionic:"!==Xi()&&"capacitor:"!==Xi()||!c.toLowerCase().match(/iphone|ipad|ipod|android/))}function xu(){try{const c=self.localStorage,o=Bs();if(c)return c.setItem(o,"1"),c.removeItem(o),!function es(c=(0,P.z$)()){return function yi(){return(0,P.w1)()&&11===document?.documentMode}()||function Xc(c=(0,P.z$)()){return/Edge\/\d+/.test(c)}(c)}()||(0,P.hl)()}catch{return aa()&&(0,P.hl)()}return!1}function aa(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function vi(){return(function Ji(){return"http:"===Xi()||"https:"===Xi()}()||(0,P.ru)()||Gr())&&!function Yc(){return(0,P.b$)()||(0,P.UG)()}()&&xu()&&!aa()}function Jc(){return Gr()&&typeof document<"u"}function ft(){return(ft=(0,f.Z)(function*(){return!!Jc()&&new Promise(c=>{const o=setTimeout(()=>{c(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),c(!0)})})})).apply(this,arguments)}const ln={LOCAL:"local",NONE:"none",SESSION:"session"},ts=B,el="persistence";function Cu(c){return ca.apply(this,arguments)}function ca(){return(ca=(0,f.Z)(function*(c){yield c._initializationPromise;const o=hr(),a=ce(el,c.config.apiKey,c.name);o&&o.setItem(a,c._getPersistence())})).apply(this,arguments)}function hr(){var c;try{return(null===(c=function ua(){return typeof window<"u"?window:null}())||void 0===c?void 0:c.sessionStorage)||null}catch{return null}}const tl=B;class xr{constructor(){this.browserResolver=E(class md{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pr,this._completeRedirectFn=Ho,this._overrideRedirectResult=lt}_openPopup(o,a,l,m){var v=this;return(0,f.Z)(function*(){var w;be(null===(w=v.eventManagers[o._key()])||void 0===w?void 0:w.manager,"_initialize() not called before _openPopup()");const R=yield Yo(o,a,l,at(),m);return function Hi(c,o,a,l=500,m=600){const v=Math.max((window.screen.availHeight-m)/2,0).toString(),w=Math.max((window.screen.availWidth-l)/2,0).toString();let R="";const q=Object.assign(Object.assign({},Fc),{width:l.toString(),height:m.toString(),top:v,left:w}),ee=(0,P.z$)().toLowerCase();a&&(R=Qt(ee)?"_blank":a),Rt(ee)&&(o=o||"http://localhost",q.scrollbars="yes");const fe=Object.entries(q).reduce((wt,[tr,ss])=>`${wt}${tr}=${ss},`,"");if(function Zn(c=(0,P.z$)()){var o;return Tn(c)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(ee)&&"_self"!==R)return function mu(c,o){const a=document.createElement("a");a.href=c,a.target=o;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(l)}(o||"",R),new rt(null);const ge=window.open(o||"",R,fe);B(ge,c,"popup-blocked");try{ge.focus()}catch{}return new rt(ge)}(o,R,Bs())})()}_openRedirect(o,a,l,m){var v=this;return(0,f.Z)(function*(){return yield v._originValidation(o),function vc(c){Ft().location.href=c}(yield Yo(o,a,l,at(),m)),new Promise(()=>{})})()}_initialize(o){const a=o._key();if(this.eventManagers[a]){const{manager:m,promise:v}=this.eventManagers[a];return m?Promise.resolve(m):(be(v,"If manager is not set, promise should be"),v)}const l=this.initAndGetManager(o);return this.eventManagers[a]={promise:l},l.catch(()=>{delete this.eventManagers[a]}),l}initAndGetManager(o){var a=this;return(0,f.Z)(function*(){const l=yield function Br(c){return Qo.apply(this,arguments)}(o),m=new er(o);return l.register("authEvent",v=>(B(v?.authEvent,o,"invalid-auth-event"),{status:m.onEvent(v.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),a.eventManagers[o._key()]={manager:m},a.iframes[o._key()]=l,m})()}_isIframeWebStorageSupported(o,a){this.iframes[o._key()].send(yu,{type:yu},m=>{var v;const w=null===(v=m?.[0])||void 0===v?void 0:v[yu];void 0!==w&&a(!!w),J(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function pu(c){return mi.apply(this,arguments)}(o)),this.originValidationPromises[a]}get _shouldInitProactively(){return Qn()||Zt()||Tn()}}),this.cordovaResolver=E(class Au{constructor(){this._redirectPersistence=Pr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ho,this._overrideRedirectResult=lt}_initialize(o){var a=this;return(0,f.Z)(function*(){const l=o._key();let m=a.eventManagers.get(l);return m||(m=new Sr(o),a.eventManagers.set(l,m),a.attachCallbackListeners(o,m)),m})()}_openPopup(o){J(o,"operation-not-supported-in-this-environment")}_openRedirect(o,a,l,m){var v=this;return(0,f.Z)(function*(){!function wu(c){var o,a,l,m,v,w,R,q,ee,fe;const ge=Tr();B("function"==typeof(null===(o=ge?.universalLinks)||void 0===o?void 0:o.subscribe),c,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),B(typeof(null===(a=ge?.BuildInfo)||void 0===a?void 0:a.packageName)<"u",c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),B("function"==typeof(null===(v=null===(m=null===(l=ge?.cordova)||void 0===l?void 0:l.plugins)||void 0===m?void 0:m.browsertab)||void 0===v?void 0:v.openUrl),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),B("function"==typeof(null===(q=null===(R=null===(w=ge?.cordova)||void 0===w?void 0:w.plugins)||void 0===R?void 0:R.browsertab)||void 0===q?void 0:q.isAvailable),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),B("function"==typeof(null===(fe=null===(ee=ge?.cordova)||void 0===ee?void 0:ee.InAppBrowser)||void 0===fe?void 0:fe.open),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const w=yield v._initialize(o);yield w.initialized(),w.resetRedirect(),function sn(){Ct.clear()}(),yield v._originValidation(o);const R=function yd(c,o,a=null){return{type:o,eventId:a,urlResponse:null,sessionId:dr(),postBody:null,tenantId:c.tenantId,error:oe(c,"no-auth-event")}}(o,l,m);yield function kn(c,o){return sa()._set(_i(c),o)}(o,R);const q=yield function bu(c,o,a){return Ar.apply(this,arguments)}(o,R,a),ee=yield function na(c){const{cordova:o}=Tr();return new Promise(a=>{o.plugins.browsertab.isAvailable(l=>{let m=null;l?o.plugins.browsertab.openUrl(c):m=o.InAppBrowser.open(c,function Wr(c=(0,P.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(c)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(c)}()?"_blank":"_system","location=yes"),a(m)})})}(q);return function Qs(c,o,a){return ra.apply(this,arguments)}(o,w,ee)})()}_isIframeWebStorageSupported(o,a){throw new Error("Method not implemented.")}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function vn(c){return Zs.apply(this,arguments)}(o)),this.originValidationPromises[a]}attachCallbackListeners(o,a){const{universalLinks:l,handleOpenURL:m,BuildInfo:v}=Tr(),w=setTimeout((0,f.Z)(function*(){yield Tu(o),a.onEvent(Su())}),500),R=function(){var fe=(0,f.Z)(function*(ge){clearTimeout(w);const wt=yield Tu(o);let tr=null;wt&&ge?.url&&(tr=function Hc(c,o){var a,l;const m=function Id(c){const o=ke(c),a=o.link?decodeURIComponent(o.link):void 0,l=ke(a).link,m=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return ke(m).link||m||l||a||c}(o);if(m.includes("/__/auth/callback")){const v=ke(m),w=v.firebaseError?function vd(c){try{return JSON.parse(c)}catch{return null}}(decodeURIComponent(v.firebaseError)):null,R=null===(l=null===(a=w?.code)||void 0===a?void 0:a.split("auth/"))||void 0===l?void 0:l[1],q=R?oe(R):null;return q?{type:c.type,eventId:c.eventId,tenantId:c.tenantId,error:q,urlResponse:null,sessionId:null,postBody:null}:{type:c.type,eventId:c.eventId,tenantId:c.tenantId,sessionId:c.sessionId,urlResponse:m,postBody:null}}return null}(wt,ge.url)),a.onEvent(tr||Su())});return function(wt){return fe.apply(this,arguments)}}();typeof l<"u"&&"function"==typeof l.subscribe&&l.subscribe(null,R);const q=m,ee=`${v.packageName.toLowerCase()}://`;Tr().handleOpenURL=function(){var fe=(0,f.Z)(function*(ge){if(ge.toLowerCase().startsWith(ee)&&R({url:ge}),"function"==typeof q)try{q(ge)}catch(wt){console.error(wt)}});return function(ge){return fe.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Pr,this._completeRedirectFn=Ho,this._overrideRedirectResult=lt}_initialize(o){var a=this;return(0,f.Z)(function*(){return yield a.selectUnderlyingResolver(),a.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,a,l,m){var v=this;return(0,f.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openPopup(o,a,l,m)})()}_openRedirect(o,a,l,m){var v=this;return(0,f.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openRedirect(o,a,l,m)})()}_isIframeWebStorageSupported(o,a){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,a)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Jc()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return tl(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,f.Z)(function*(){if(o.underlyingResolver)return;const a=yield function Td(){return ft.apply(this,arguments)}();o.underlyingResolver=a?o.cordovaResolver:o.browserResolver})()}}function ku(c){return c.unwrap()}function Du(c){return la(c)}function la(c){const{_tokenResponse:o}=c instanceof P.ZR?c.customData:c;if(!o)return null;if(!(c instanceof P.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return js.credentialFromResult(c);const a=o.providerId;if(!a||"password"===a)return null;let l;switch(a){case"google.com":l=Pa;break;case"facebook.com":l=Oa;break;case"github.com":l=_o;break;case"twitter.com":l=ac;break;default:const{oauthIdToken:m,oauthAccessToken:v,oauthTokenSecret:w,pendingToken:R,nonce:q}=o;return v||w||m||R?R?a.startsWith("saml.")?ri._create(a,R):On._fromParams({providerId:a,signInMethod:a,pendingToken:R,idToken:m,accessToken:v}):new Ri(a).credential({idToken:m,accessToken:v,rawNonce:q}):null}return c instanceof P.ZR?l.credentialFromError(c):l.credentialFromResult(c)}function dn(c,o){return o.catch(a=>{throw a instanceof P.ZR&&function Ru(c,o){var a;const l=null===(a=o.customData)||void 0===a?void 0:a._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new Ut(c,function Ya(c,o){var a;const l=(0,P.m9)(c),m=o;return B(o.customData.operationType,l,"argument-error"),B(null===(a=m.customData._serverResponse)||void 0===a?void 0:a.mfaPendingCredential,l,"argument-error"),ar._fromError(l,m)}(c,o));else if(l){const m=la(o),v=o;m&&(v.credential=m,v.tenantId=l.tenantId||void 0,v.email=l.email||void 0,v.phoneNumber=l.phoneNumber||void 0)}}(c,a),a}).then(a=>{const m=a.user;return{operationType:a.operationType,credential:Du(a),additionalUserInfo:Za(a),user:Me.getOrCreate(m)}})}function Mu(c,o){return Nu.apply(this,arguments)}function Nu(){return(Nu=(0,f.Z)(function*(c,o){const a=yield o;return{verificationId:a.verificationId,confirm:l=>dn(c,a.confirm(l))}})).apply(this,arguments)}class Ut{constructor(o,a){this.resolver=a,this.auth=function rs(c){return c.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return dn(ku(this.auth),this.resolver.resolveSignIn(o))}}class Me{constructor(o){this._delegate=o,this.multiFactor=function Xl(c){const o=(0,P.m9)(c);return ve.has(o)||ve.set(o,he._fromUser(o)),ve.get(o)}(o)}static getOrCreate(o){return Me.USER_MAP.has(o)||Me.USER_MAP.set(o,new Me(o)),Me.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var a=this;return(0,f.Z)(function*(){return dn(a.auth,Ga(a._delegate,o))})()}linkWithPhoneNumber(o,a){var l=this;return(0,f.Z)(function*(){return Mu(l.auth,function ur(c,o,a){return zo.apply(this,arguments)}(l._delegate,o,a))})()}linkWithPopup(o){var a=this;return(0,f.Z)(function*(){return dn(a.auth,function Cc(c,o,a){return Wo.apply(this,arguments)}(a._delegate,o,xr))})()}linkWithRedirect(o){var a=this;return(0,f.Z)(function*(){return yield Cu(ct(a.auth)),function kt(c,o,a){return function Ir(c,o,a){return ji.apply(this,arguments)}(c,o,a)}(a._delegate,o,xr)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var a=this;return(0,f.Z)(function*(){return dn(a.auth,To(a._delegate,o))})()}reauthenticateWithPhoneNumber(o,a){return Mu(this.auth,function Go(c,o,a){return Ko.apply(this,arguments)}(this._delegate,o,a))}reauthenticateWithPopup(o){return dn(this.auth,function xc(c,o,a){return cu.apply(this,arguments)}(this._delegate,o,xr))}reauthenticateWithRedirect(o){var a=this;return(0,f.Z)(function*(){return yield Cu(ct(a.auth)),function jt(c,o,a){return function dd(c,o,a){return cr.apply(this,arguments)}(c,o,a)}(a._delegate,o,xr)})()}sendEmailVerification(o){return function $l(c,o){return Fs.apply(this,arguments)}(this._delegate,o)}unlink(o){var a=this;return(0,f.Z)(function*(){return yield function jl(c,o){return yt.apply(this,arguments)}(a._delegate,o),a})()}updateEmail(o){return function yr(c,o){return Yt((0,P.m9)(c),o,null)}(this._delegate,o)}updatePassword(o){return function Gn(c,o){return Yt((0,P.m9)(c),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function sd(c,o){return su.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function Ha(c,o){return Oo.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,a){return function sr(c,o,a){return No.apply(this,arguments)}(this._delegate,o,a)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Me.USER_MAP=new WeakMap;const is=B;let Ou=(()=>{class c{constructor(a,l){if(this.app=a,l.isInitialized())return this._delegate=l.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:m}=a.options;is(m,"invalid-api-key",{appName:a.name}),is(m,"invalid-api-key",{appName:a.name});const v=typeof window<"u"?xr:void 0;this._delegate=l.initialize({options:{persistence:ha(m,a.name),popupRedirectResolver:v}}),this._delegate._updateErrorMap(te),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Me.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(a){this._delegate.languageCode=a}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(a){this._delegate.tenantId=a}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(a,l){!function Bn(c,o,a){const l=ct(c);B(l._canInitEmulator,l,"emulator-config-failed"),B(/^https?:\/\//.test(o),l,"invalid-emulator-scheme");const m=!!a?.disableWarnings,v=Yr(o),{host:w,port:R}=function Xr(c){const o=Yr(c),a=/(\/\/)?([^?#/]+)/.exec(c.substr(o.length));if(!a)return{host:"",port:null};const l=a[2].split("@").pop()||"",m=/^(\[[^\]]+\])(:|$)/.exec(l);if(m){const v=m[1];return{host:v,port:Es(l.substr(v.length+1))}}{const[v,w]=l.split(":");return{host:v,port:Es(w)}}}(o);l.config.emulator={url:`${v}//${w}${null===R?"":`:${R}`}/`},l.settings.appVerificationDisabledForTesting=!0,l.emulatorConfig=Object.freeze({host:w,port:R,protocol:v.replace(":",""),options:Object.freeze({disableWarnings:m})}),m||function ki(){function c(){const o=document.createElement("p"),a=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",c):c())}()}(this._delegate,a,l)}applyActionCode(a){return function lc(c,o){return Fi.apply(this,arguments)}(this._delegate,a)}checkActionCode(a){return Wa(this._delegate,a)}confirmPasswordReset(a,l){return function ja(c,o,a){return Ls.apply(this,arguments)}(this._delegate,a,l)}createUserWithEmailAndPassword(a,l){var m=this;return(0,f.Z)(function*(){return dn(m._delegate,function dc(c,o,a){return Ro.apply(this,arguments)}(m._delegate,a,l))})()}fetchProvidersForEmail(a){return this.fetchSignInMethodsForEmail(a)}fetchSignInMethodsForEmail(a){return function $a(c,o){return tt.apply(this,arguments)}(this._delegate,a)}isSignInWithEmailLink(a){return function fc(c,o){return"EMAIL_SIGNIN"===Di.parseLink(o)?.operation}(0,a)}getRedirectResult(){var a=this;return(0,f.Z)(function*(){is(vi(),a._delegate,"operation-not-supported-in-this-environment");const l=yield function qo(c,o){return hi.apply(this,arguments)}(a._delegate,xr);return l?dn(a._delegate,Promise.resolve(l)):{credential:null,user:null}})()}addFrameworkForLogging(a){!function Qc(c,o){ct(c)._logFramework(o)}(this._delegate,a)}onAuthStateChanged(a,l,m){const{next:v,error:w,complete:R}=da(a,l,m);return this._delegate.onAuthStateChanged(v,w,R)}onIdTokenChanged(a,l,m){const{next:v,error:w,complete:R}=da(a,l,m);return this._delegate.onIdTokenChanged(v,w,R)}sendSignInLinkToEmail(a,l){return function Mo(c,o,a){return yn.apply(this,arguments)}(this._delegate,a,l)}sendPasswordResetEmail(a,l){return function cc(c,o,a){return Co.apply(this,arguments)}(this._delegate,a,l||void 0)}setPersistence(a){var l=this;return(0,f.Z)(function*(){let m;switch(function Xs(c,o){ts(Object.values(ln).includes(o),c,"invalid-persistence-type"),(0,P.b$)()?ts(o!==ln.SESSION,c,"unsupported-persistence-type"):(0,P.UG)()?ts(o===ln.NONE,c,"unsupported-persistence-type"):aa()?ts(o===ln.NONE||o===ln.LOCAL&&(0,P.hl)(),c,"unsupported-persistence-type"):ts(o===ln.NONE||xu(),c,"unsupported-persistence-type")}(l._delegate,a),a){case ln.SESSION:m=Pr;break;case ln.LOCAL:m=(yield E(ui)._isAvailable())?ui:Lo;break;case ln.NONE:m=W;break;default:return J("argument-error",{appName:l._delegate.name})}return l._delegate.setPersistence(m)})()}signInAndRetrieveDataWithCredential(a){return this.signInWithCredential(a)}signInAnonymously(){return dn(this._delegate,function vo(c){return Ms.apply(this,arguments)}(this._delegate))}signInWithCredential(a){return dn(this._delegate,Os(this._delegate,a))}signInWithCustomToken(a){return dn(this._delegate,function Ao(c,o){return So.apply(this,arguments)}(this._delegate,a))}signInWithEmailAndPassword(a,l){return dn(this._delegate,function hc(c,o,a){return Os((0,P.m9)(c),Na.credential(o,a))}(this._delegate,a,l))}signInWithEmailLink(a,l){return dn(this._delegate,function pc(c,o,a){return Nr.apply(this,arguments)}(this._delegate,a,l))}signInWithPhoneNumber(a,l){return Mu(this._delegate,function id(c,o,a){return Bo.apply(this,arguments)}(this._delegate,a,l))}signInWithPopup(a){var l=this;return(0,f.Z)(function*(){return is(vi(),l._delegate,"operation-not-supported-in-this-environment"),dn(l._delegate,function ld(c,o,a){return uu.apply(this,arguments)}(l._delegate,a,xr))})()}signInWithRedirect(a){var l=this;return(0,f.Z)(function*(){return is(vi(),l._delegate,"operation-not-supported-in-this-environment"),yield Cu(l._delegate),function Cn(c,o,a){return function Dc(c,o,a){return fu.apply(this,arguments)}(c,o,a)}(l._delegate,a,xr)})()}updateCurrentUser(a){return this._delegate.updateCurrentUser(a)}verifyPasswordResetCode(a){return function si(c,o){return Do.apply(this,arguments)}(this._delegate,a)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return c.Persistence=ln,c})();function da(c,o,a){let l=c;"function"!=typeof c&&({next:l,error:o,complete:a}=c);const m=l;return{next:w=>m(w&&Me.getOrCreate(w)),error:o,complete:a}}function ha(c,o){const a=function ns(c,o){const a=hr();if(!a)return[];const l=ce(el,c,o);switch(a.getItem(l)){case ln.NONE:return[W];case ln.LOCAL:return[ui,Pr];case ln.SESSION:return[Pr];default:return[]}}(c,o);if(typeof self<"u"&&!a.includes(ui)&&a.push(ui),typeof window<"u")for(const l of[Lo,Pr])a.includes(l)||a.push(l);return a.includes(W)||a.push(W),a}class fa{constructor(){this.providerId="phone",this._delegate=new js(ku(j.Z.auth()))}static credential(o,a){return js.credential(o,a)}verifyPhoneNumber(o,a){return this._delegate.verifyPhoneNumber(o,a)}unwrap(){return this._delegate}}fa.PHONE_SIGN_IN_METHOD=js.PHONE_SIGN_IN_METHOD,fa.PROVIDER_ID=js.PROVIDER_ID;const Ad=B;class nl{constructor(o,a,l=j.Z.app()){var m;Ad(null===(m=l.options)||void 0===m?void 0:m.apiKey,"invalid-api-key",{appName:l.name}),this._delegate=new Ks(o,a,l.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Pu(c){c.INTERNAL.registerComponent(new ye.wA("auth-compat",o=>{const a=o.getProvider("app-compat").getImmediate(),l=o.getProvider("auth");return new Ou(a,l)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Na,FacebookAuthProvider:Oa,GithubAuthProvider:_o,GoogleAuthProvider:Pa,OAuthProvider:Ri,SAMLAuthProvider:Mi,PhoneAuthProvider:fa,PhoneMultiFactorGenerator:Kc,RecaptchaVerifier:nl,TwitterAuthProvider:ac,Auth:Ou,AuthCredential:Xn,Error:P.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),c.registerVersion("@firebase/auth-compat","0.4.2")}(j.Z)},8179:(Bt,Ne,C)=>{C.d(Ne,{IO:()=>f.IO,Yp:()=>f.Yp,ar:()=>f.ar,hJ:()=>f.hJ});var f=C(2810)}}]);